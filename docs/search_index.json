[["index.html", "Loss Data Analytics: Short Course Preface Why Loss Data Analytics? Resources How to Navigate this Tutorial A word from our Sponsor: Astin + Education = Astin Academy Contributors", " Loss Data Analytics: Short Course A short course authored by the Actuarial Community Preface Date: 24 June 2021 Why Loss Data Analytics? The intent is that this type of short course will eventually permeate throughout the actuarial curriculum. Given the dramatic changes in the way that actuaries treat data, analysis of loss data seems like a natural place to start. The idea behind the name loss data analytics is to integrate classical loss data models from applied probability with modern analytic tools. In particular, we recognize that big data (including social media and usage based insurance) are here to stay and that high speed computation is readily available. Resources This tutorial is based on the first five chapters of the open and freely available book Loss Data Analytics. Sample code is available for the book, although not needed for this tutorial. As described in how to navigate this tutorial below, you will not need to download any data for this course. However, if you want to have the data to follow up, we generally make it available through buttons such as: View the Property Fund Data as a .csv file. Then, do a Save Page as if you wish to download. Alternatively, go directly to the Github page to access the data. For advanced data applications in insurance, you may be interested in the series, Predictive Modeling Applications in Actuarial Science. How to Navigate this Tutorial This online tutorial is designed to guide you through the foundations of modeling loss data. The anticipated completion time is approximately six hours. The tutorial assumes that you are familiar with the foundations in the statistical software R, such as Datacamps Introduction to R. Role of Video Introductions. There are five chapters in this tutorial that summarize the foundations. Each chapter is subdivided into several sections. At the beginning of each section is a short video, typically 4-8 minutes, that summarizes the section key learning outcomes. Following the video, you can see more details about the underlying R code for the analysis presented in the video. Role of Exercises. Following each video introduction, there are one or two exercises that allow you to practice skills to make sure that you fully grasp the learning outcomes. The exercises are implemented using an online learning platform provided by Datacamp so that you need not install R. Feedback is programmed into the exercises so that you will learn a lot by making mistakes! You will be pacing yourself, so always feel free to reveal the answers by hitting the Solution tab. Remember, going through quickly is not equivalent to learning deeply. Use this tool to enhance your understanding of one of the foundations of data science. Video: Overview of Tutorial Navigation A word from our Sponsor: Astin + Education = Astin Academy In this video, you learn about: the role of the ASTIN section, the non-life section of the International Actuarial Association their recent interest in education their development of the recently formed Astin Academy. The mission of the ASTIN Academy is to provide high quality free educational materials in non-life insurance to actuarial students across the world. The Academy is committed to open course development under Creative Commons licence and seeks innovation in teaching methodologies and application of technology. Lets build the future of actuarial education together. Video: Overview of the Astin Academy Contributors The project goal is to have the actuarial community author our textbooks in a collaborative fashion. The following contributors have taken a leadership role in developing this short course for \\(Loss\\) \\(Data\\) \\(Analytics\\). Yvonne Chueh is a professor at Central Washington University. She received PhD from the University of Connecticut, bachelor degree in pure math from National Taiwan University. She has taught actuarial courses at UCONN and UW-Eau Claire. She is an associate (since 1994) and council member/chair (2013-2017/2017) of the Society of Actuaries (SOA) Education &amp; Research Section. Her research works were published by the American Academy of Actuaries, the Actuarial Foundation, SOA North American Actuarial Journal, Electrical Engineering Series of Springer, International Joint Conference on Neural Networks, IEEE Symposium Series on Computational Intelligence (SSCI), and International Journal of Computers, Communications &amp; Control. Miyuki Ebisaki is a Senior Research Officer of SOMPO Research Institute Inc. in Japan. Her research work is in the area of insurance, health care, social economy and new technologies. She has been working in domestic and foreign insurers in Japan and in the UK. She has various experiences both in non-life and life insurance; including product development, chief actuary, M&amp;A and risk management. In May 2020, she was elected as a member of the ASTIN board. Rob Erhardt is an Associate Professor of Statistics at Wake Forest University in Winston-Salem, NC. He holds a Ph.D. in Statistics and Operations Research from the University of North Carolina at Chapel Hill, an M.S. in Statistics from the University of Wisconsin-Madison, and a B.A. in Physics from SUNY Geneseo. He is also a credentialed actuary and Society of Actuaries Hickman Scholar. His research areas include environmental statistics, computational statistics, and actuarial science, with a particular interest in work at the intersection of insurance and climate risk. Originally from rural New York State, he is an avid runner and backpacker, and a poor jazz pianist. Edward W. (Jed) Frees is an emeritus professor, formerly the Hickman-Larson Chair of Actuarial Science at the University of Wisconsin-Madison and currently affiliated with Australian National University. He is a Fellow of both the Society of Actuaries and the American Statistical Association. He has published extensively (a four-time winner of the Halmstad Prize for best paper published in the actuarial literature) and has written three books. He also is a co-editor of the two-volume series Predictive Modeling Applications in Actuarial Science published by Cambridge University Press. Brian Hartman is an associate professor of statistics and actuarial program coordinator at Brigham Young University. His current research interests include Bayesian methods and their applications in actuarial science and risk. He has worked in various capacities with companies in property-casualty, health, and long-term care insurance. He holds a Bachelors degree in Actuarial Science from Brigham Young University and a PhD in Statistics from Texas A&amp;M University. He is also an associate of the Society of Actuaries. Before BYU, he was a post-doctoral fellow at the University of Waterloo (2010-11) and an assistant professor at the University of Connecticut (2011-15). Tim Higgins, Australian National University Fei Huang is a Senior Lecturer in the School of Risk and Actuarial Studies, University of New South Wales (UNSW) Sydney. Before joining UNSW, she worked at the Australian National University (ANU) as Senior Lecturer (2019-2020) and Lecturer (2015-2018). Feis main research interest lies in predictive modelling and data analytics for insurance applications. She is an active researcher and publishes papers frequently in top-tier actuarial journals. Fei is also a dedicated educator. Her educational excellence has been recognized by winning the ANU Vice Chancellors Award for Teaching Excellence in the Early Career Category (2018) and ANU College of Business and Economics Award for Teaching Excellence in the Early Career Category (2017). Himchan Jeong is currently an Assistant Professor at Simon Fraser University. He is a Fellow of the Society of Actuaries (SOA) and holds a Ph.D. from the University of Connecticut. He has been actively involved in teaching and conducting research in actuarial science for several years. In recognition for his academic achievements and excellence, he has been awarded the James C. Hickman Scholarship from SOA recently in 2018-2020. His current research interest is predictive modeling for ratemaking and reserving of property and casualty insurance. Paul H. Johnson, Jr. is a lecturer in the Risk and Insurance Department of the Wisconsin School of Business at the University of Wisconsin-Madison. He has an MS in Actuarial Science and a PhD in Business (Actuarial Science), both from UW-Madison. Paul teaches undergraduate courses in life contingencies, loss models, regression, and analytics. Prior to teaching at UW-Madison, Paul received various honors and awards for teaching excellence in the Department of Mathematics at the University of Illinois at Urbana-Champaign; most notably, the N. Tenney Peck Teaching Award in Mathematics. He also has published articles in the North American Actuarial Journal and the Risk Management and Insurance Review. Nii-Armah Okine is an assistant professor at the Mathematical Sciences Department at Appalachian State University. He holds a Ph.D. in Business (Actuarial Science) from the University of Wisconsin - Madison and obtained his masters degree in Actuarial science from Illinois State University. His research interest includes micro-level reserving, joint longitudinal-survival modeling, dependence modeling, micro-insurance, and machine learning. Rajesh (Raj) Sahasrabuddhe is a Partner and Philadelphia Office Leader with Oliver Wyman Actuarial Consulting. Raj is a Fellow of the Casualty Actuarial Society (CAS), an Associate of the Canadian Institute of Actuaries, and a Member of the American Academy of Actuaries. Raj has been an active volunteer with CAS Admissions committees throughout his career, including a term as Chairperson of the Syllabus Committee from 2010 to 2013. He currently serves on the MAS-II Examination Committee. He has authored or co-authored papers that have appeared on syllabi for both the CAS and Society of Actuaries. Peng Shi is an associate professor in the Risk and Insurance Department at the Wisconsin School of Business. He is also the Charles &amp; Laura Albright Professor in Business and Finance. Professor Shi is an Associate of the Casualty Actuarial Society (ACAS) and a Fellow of the Society of Actuaries (FSA). He received a Ph.D. in actuarial science from the University of Wisconsin-Madison. His research interests are problems at the intersection of insurance and statistics. He has won several research awards, including the Charles A. Hachemeister Prize, the Ronald Bornhuetter Loss Reserve Prize, and the American Risk and Insurance Association Prize. Nariankadu D. Shyamalkumar (Shyamal) is an associate professor in the Department of Statistics and Actuarial Science at The University of Iowa. He is an Associate of the Society of Actuaries, and has volunteered in various elected and non-elected roles within the SoA. Having a broad theoretical interest as well as interest in computing, he has published in prominent actuarial, computer science, probability theory, and statistical journals. Moreover, he has worked in the financial industry, and since then served as an independent consultant to the insurance industry. He has experience educating actuaries in both Mexico and the US, serving in the roles of directing an undergraduate program, and as a graduate adviser for both masters and doctoral students. Zhiyu (Frank) Quan is an Assistant Professor at the Department of Mathematics of the University of Illinois at Urbana-Champaign. He holds a Ph.D. in Actuarial Science from the University of Connecticut. Before joining Illinois, he worked for a cutting-edge Insurtech company as a R &amp; D data scientist developing data-driven solutions for major insurance companies. He has a broad spectrum of research interests in data science applications in insurance such as tree-based models, natural language processing, deep learning, and applies his actuarial expertise to build predictive models for claim research, rate making, etc. His research projects are driven by real-life data and are inspired from collaborations with Insurtech and insurance companies. Besides, he is a faculty advisor for the Illinois Risk Lab, which facilitates research activities that integrate academic training with practical problem-solving in real business settings. He recently has received the Arnold O. Beckman Research Award. Michelle Xia is an Associate Professor in in the Department of Statistics and Actuarial Science at Northern Illinois University. Michelle earned her Ph.D. in statistics from the University of British Columbia. Besides research, teaching and consulting at NIU, Michelle has over seven years of professional experience as an actuary, a predictive modeler and a statistician in the insurance and medical areas. Michelles research is motivated by real-life problems, with current interests including predictive analytics, misrepresentation modeling, dependence modeling, insurance ratemaking and loss reserving. "],["introduction-to-loss-data-analytics.html", "Chapter 1 Introduction to Loss Data Analytics 1.1 Relevance of Analytics to Insurance Activities 1.2 Insurance Company Operations 1.3 Case Study: Property Fund Introduction 1.4 Property Fund Claim Severity 1.5 Property Fund Rating Variables", " Chapter 1 Introduction to Loss Data Analytics Chapter description This course introduces readers to methods of analyzing insurance data. Section 1.1 begins with a discussion of why the use of data is important in the insurance industry. Section 1.2 gives a general overview of the purposes of analyzing insurance data which is reinforced in the Section 1.3 case study. Naturally, there is a huge gap between the broad goals summarized in the overview and a case study application; this gap is covered through the methods and techniques of data analysis covered in the rest of the text. Although not needed to go through the tutorials, some users may wish to download the overheads used in the videos. Download Chapter One overheads as a .pdf file. By watching the videos and working through the tutorial exercises, you will get an appreciation for the foundations of loss data analytics. For a deeper dive, see the corresponding chapter in the textbook, Chapter One of Loss Data Analytics. 1.1 Relevance of Analytics to Insurance Activities In this section, you learn how to: Summarize the importance of insurance to consumers and the economy Describe analytics Identify data generating events associated with the timeline of a typical insurance contract Video: Insurance and Analytics Overheads: Insurance and Analytics (Click Tab to View) A. Relevance of Insurance B. Analytics and Loss Data C. What is Analytics? D. Insurance Processes E. Relevance of Analytics Hide Hide Hide Hide Hide Show Quiz Solution 1.2 Insurance Company Operations In this section, you learn how to: Describe five major operational areas of insurance companies. Identify the role of data and analytics opportunities within the pricing area. Video: Insurance Company Operations Overheads: Insurance Company Operations (Click Tab to View) A. Insurance Company Operations I B. Insurance Company Operations II C. Operations  Initiating Insurance D. Big Data Hide Hide Hide Hide Show Quiz Solution 1.3 Case Study: Property Fund Introduction In this section, we use the Wisconsin Property Fund as a case study. You learn how to: Describe how data generating events can produce data of interest to insurance analysts. Produce relevant summary statistics for each variable. Describe how these summary statistics can be used to develop the cost of insurance. Video: Introducing the Wisconsin Property Fund Overheads: Introducing the Wisconsin Property Fund (Click Tab to View) A. Wisconsin Property Fund B. LGPIF Policyholder A C. LGPIF Policyholder B D. Property Fund E. Claims Frequency - R Code F. Claims Frequency (2010) Hide Hide Hide Hide Hide Hide 1.3.1 Exercise. Claim Frequency Assignment Text The Wisconsin Property Fund data has already been read into a data frame called Insample. These data consist of claim experience for fund members over the years 2006-2010, inclusive. It includes the frequency of claims Freq as well as the claim year Year. The video explored the distribution of the claims frequency for year 2010; in this assignment, we replicate this analysis and conduct a similar investigation for year 2009. Instructions. For each year: Use the function subset() to create a smaller data set based on a single year. Define the frequency as a global variable. Use the function length() to determine the number of observations in a vector. Use the function mean() to calculate the average. Use the function table() to tabulate the frequency distribution. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCxcbiAgICAgICAgICAgICAgICAgICAgICBuYS5zdHJpbmdzPWMoXCIuXCIpLCBzdHJpbmdzQXNGYWN0b3JzPUZBTFNFKSIsInNhbXBsZSI6IiMgIEFuYWx5c2lzIGZvciBZZWFyIDIwMTBcbkluc2FtcGxlMjAxMCA8LSBzdWJzZXQoSW5zYW1wbGUsIFllYXI9PTIwMTApXG5GcmVxMjAxMCA8LSBJbnNhbXBsZTIwMTAkRnJlcVxuTGVuZzIwMTA8LSBsZW5ndGgoRnJlcTIwMTApXG5NZWFuMjAxMDwtIG1lYW4oRnJlcTIwMTApXG5UYWIyMDEwPC0gdGFibGUoRnJlcTIwMTApXG5cbiMgIEFuYWx5c2lzIGZvciBZZWFyIDIwMDlcbkluc2FtcGxlMjAwOSA8LSA/P1xuRnJlcTIwMDkgPC0gPz9cbkxlbmcyMDA5PC0gbGVuZ3RoKD8/KVxuTWVhbjIwMDk8LW1lYW4oPz8pXG5UYWIyMDA5PC10YWJsZSg/PykiLCJzb2x1dGlvbiI6IiMgIEFuYWx5c2lzIGZvciBZZWFyIDIwMTBcbkluc2FtcGxlMjAxMCA8LSBzdWJzZXQoSW5zYW1wbGUsIFllYXI9PTIwMTApXG5GcmVxMjAxMCA8LSBJbnNhbXBsZTIwMTAkRnJlcVxuTGVuZzIwMTAgPC0gbGVuZ3RoKEZyZXEyMDEwKVxuTWVhbjIwMTA8LSBtZWFuKEZyZXEyMDEwKVxuVGFiMjAxMDwtdGFibGUoRnJlcTIwMTApXG5cbiMgIEFuYWx5c2lzIGZvciBZZWFyIDIwMDlcbkluc2FtcGxlMjAwOSA8LSBzdWJzZXQoSW5zYW1wbGUsIFllYXI9PTIwMDkpXG5GcmVxMjAwOSA8LSBJbnNhbXBsZTIwMDkkRnJlcVxuTGVuZzIwMDkgPC0gbGVuZ3RoKEZyZXEyMDA5KVxuTWVhbjIwMDk8LSBtZWFuKEZyZXEyMDA5KVxuVGFiMjAwOTwtdGFibGUoRnJlcTIwMDkpIiwic2N0IjoiI0Vycm9yIG1lc3NhZ2UgbGlzdFxuRXJyb3IxPC1cIlVzZSBgSW5zYW1wbGUyMDA5YCB0byBjcmVhdGUgYW4gb2JqZWN0IG5hbWVkIGBJbnNhbXBsZTIwMDlgZnJvbSB0aGUgeWVhciAyMDA5IGRhdGEuXCJcbkVycm9yMjwtXCJBc3NpZ24gdGhlIHN1YnNldCBvZiAyMDA5IGRhdGEgYnkgdXNpbmcgc3Vic2V0KEluc2FtcGxlLCBZZWFyPT0yMDA5KSwgQ2FwaXRhbGl6ZSBZLlwiXG5FcnJvcjM8LVwiVXNlIGBGcmVxMjAwOWAgdG8gY3JlYXRlIGFuIG9iamVjdCBuYW1lZCBgRnJlcTIwMDlgZnJvbSB0aGUgeWVhciAyMDA5IENsYWltIEZyZXF1ZW5jeSBkYXRhLlwiXG5FcnJvcjQ8LVwiQXNzaWduIHRoZSBjb2x1bW4gRnJlcXVlbmN5IG9mIDIwMDkgZGF0YSBieSB1c2luZyBJbnNhbXBsZTIwMDkkRnJlcSBpbiB3aGljaCAkIHJlZmVycyB0aGUgY29sdW1uIG5hbWVcIlxuRXJyb3I1PC1cIlVzZSBgbGVuZ3RoYCBvbiB0aGUgRnJlcTIwMDkgdG8gY291bnQgdGhlIG51bWJlciBvZiBlbnRyaWVzIGluIHRoZSBGcmVxdWVuY3kgY29sdW1uXCJcbkVycm9yNjwtXCJVc2UgYEZyZXEyMDA5YCB0byBsb2NhdGUgdGhlIGNvcnJlY3QgY29sdW1uIHdoaWNoIHN0b3JlcyB0aGUgRnJlcXVlbmN5IGRhdGFcIlxuRXJyb3I3PC1cIlVzZSBgbWVhbmAgb24gdGhlIEZyZXEyMDA5IHRvIGNvdW50IHRoZSBhdmVyYWdlIHZhbHVlIG9mIGVudHJpZXMgaW4gdGhlIEZyZXF1ZW5jeSBjb2x1bW5cIlxuRXJyb3I4PC1cIlVzZSBgRnJlcTIwMDlgIHRvIGxvY2F0ZSB0aGUgY29ycmVjdCBjb2x1bW4gd2hpY2ggc3RvcmVzIHRoZSBGcmVxdWVuY3kgZGF0YSBmcm9tIFllYXIgMjAwOVwiXG5FcnJvcjk8LVwiVXNlIGB0YWJsZWAgb24gdGhlIEZyZXEyMDA5IHRvIHRhYnVsYXRlIHRoZSBmcmVxdWVuY3kgZGF0YSBpbiBhIHRhYnVsYXIgZm9ybVwiXG5FcnJvcjEwPC1cIlVzZSBgRnJlcTIwMDlgIHRvIGxvY2F0ZSB0aGUgY29ycmVjdCBjb2x1bW4gd2hpY2ggc3RvcmVzIHRoZSBGcmVxdWVuY3kgZGF0YSBmcm9tIFllYXIgMjAwOVwiXG5FcnJvcjExPC1cIlVzZSBgSW5zYW1wbGUyMDA5YCB0byBjcmVhdGUgYW4gb2JqZWN0IG5hbWVkIGBJbnNhbXBsZTIwMDlgZnJvbSB0aGUgeWVhciAyMDA5IGRhdGEuXCJcbkVycm9yMTI8LVwiQXNzaWduIHRoZSBzdWJzZXQgb2YgMjAwOSBkYXRhIGJ5IHVzaW5nIHN1YnNldChJbnNhbXBsZSwgWWVhcj09MjAwOSksIENhcGl0YWxpemUgWS5cIlxuRXJyb3IxMzwtXCJVc2UgYEZyZXEyMDA5YCB0byBjcmVhdGUgYW4gb2JqZWN0IG5hbWVkIGBGcmVxMjAwOWBmcm9tIHRoZSB5ZWFyIDIwMDkgQ2xhaW0gRnJlcXVlbmN5IGRhdGEuXCJcbkVycm9yMTQ8LVwiQXNzaWduIHRoZSBjb2x1bW4gRnJlcXVlbmN5IG9mIDIwMDkgZGF0YSBieSB1c2luZyBJbnNhbXBsZTIwMDkkRnJlcSBpbiB3aGljaCAkIHJlZmVycyB0aGUgY29sdW1uIG5hbWVcIlxuRXJyb3IxNTwtXCJVc2UgYGxlbmd0aGAgb24gdGhlIEZyZXEyMDA5IHRvIGNvdW50IHRoZSBudW1iZXIgb2YgZW50cmllcyBpbiB0aGUgRnJlcXVlbmN5IGNvbHVtblwiXG5FcnJvcjE2PC1cIlVzZSBgRnJlcTIwMDlgIHRvIGxvY2F0ZSB0aGUgY29ycmVjdCBjb2x1bW4gd2hpY2ggc3RvcmVzIHRoZSBGcmVxdWVuY3kgZGF0YVwiXG5FcnJvcjE3PC1cIlVzZSBgTGVuZzIwMDlgIHRvIGNyZWF0ZSBhbiBvYmplY3QgbmFtZWQgYExlbmcyMDA5YGZyb20gdGhlIHllYXIgMjAwOSBDbGFpbSBGcmVxdWVuY3kgZGF0YS5cIlxuRXJyb3IxODwtXCJBc3NpZ24gdGhlIENsYWltIEZyZXF1ZW5jeSBvZiAyMDA5IGRhdGEgYnkgdXNpbmcgRnJlcTIwMDlcIlxuRXJyb3IxOTwtXCJVc2UgYG1lYW5gIG9uIHRoZSBGcmVxMjAwOSB0byBjb3VudCB0aGUgYXZlcmFnZSB2YWx1ZSBvZiBlbnRyaWVzIGluIHRoZSBGcmVxdWVuY3kgY29sdW1uXCJcbkVycm9yMjA8LVwiVXNlIGBGcmVxMjAwOWAgdG8gbG9jYXRlIHRoZSBjb3JyZWN0IGNvbHVtbiB3aGljaCBzdG9yZXMgdGhlIEZyZXF1ZW5jeSBkYXRhIGZyb20gWWVhciAyMDA5XCJcbkVycm9yMjE8LVwiVXNlIGBNZWFuMjAwOWAgdG8gY3JlYXRlIGFuIG9iamVjdCBuYW1lZCBgTWVhbjIwMDlgZnJvbSB0aGUgeWVhciAyMDA5IENsYWltIEZyZXF1ZW5jeSBkYXRhLlwiXG5FcnJvcjIyPC1cIkFzc2lnbiB0aGUgY2xhaW0gRnJlcXVlbmN5IG9mIDIwMDkgZGF0YSBieSB1c2luZyBGcmVxMjAwOVwiXG5FcnJvcjIzPC1cIlVzZSBgdGFibGVgIG9uIHRoZSAyMDA5IHRvIHRhYnVsYXRlIHRoZSBmcmVxdWVuY3kgZGF0YSBpbiBhIHRhYnVsYXIgZm9ybVwiXG5FcnJvcjI0PC1cIlVzZSBgRnJlcTIwMTBgIHRvIGxvY2F0ZSB0aGUgY29ycmVjdCBjb2x1bW4gd2hpY2ggc3RvcmVzIHRoZSBGcmVxdWVuY3kgZGF0YSBmcm9tIFllYXIgMjAwOVwiICBcbkVycm9yMjU8LVwiVXNlIGBUYWIyMDA5YCB0byBjcmVhdGUgYW4gb2JqZWN0IG5hbWVkIGBUYWIyMDA5YGZyb20gdGhlIHllYXIgMjAwOSBDbGFpbSBGcmVxdWVuY3kgZGF0YS5cIlxuRXJyb3IyNjwtXCJBc3NpZ24gdGhlIENsYWltIEZyZXF1ZW5jeSBvZiAyMDA5IGRhdGEgYnkgdXNpbmcgRnJlcTIwMDlcIlxuXG4jQ2hlY2sgT2JqZWN0IGRvZXMgZXhpc3RcbmV4KCkgJT4lIGNoZWNrX29iamVjdChcIkluc2FtcGxlMjAwOVwiLCB1bmRlZmluZWRfbXNnID0gRXJyb3IxKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1FcnJvcjIpXG5leCgpICU+JSBjaGVja19vYmplY3QoXCJGcmVxMjAwOVwiLCB1bmRlZmluZWRfbXNnPUVycm9yMykgJT4lIGNoZWNrX2VxdWFsKGluY29ycmVjdF9tc2c9RXJyb3I0KVxuXG4jQ2hlY2sgZnVuY3Rpb24gaXMgY2FsbGVkXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcImxlbmd0aFwiLCBub3RfY2FsbGVkX21zZz1FcnJvcjUpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1FcnJvcjYpXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcIm1lYW5cIiwgbm90X2NhbGxlZF9tc2c9RXJyb3I3KSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKGluY29ycmVjdF9tc2c9RXJyb3I4KVxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJ0YWJsZVwiLCBub3RfY2FsbGVkX21zZz1FcnJvcjkpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1FcnJvcjEwKVxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KFwiSW5zYW1wbGUyMDA5XCIsIHVuZGVmaW5lZF9tc2c9RXJyb3IxMSkgJT4lIGNoZWNrX2VxdWFsKGluY29ycmVjdF9tc2c9RXJyb3IxMilcbmV4KCkgJT4lIGNoZWNrX29iamVjdChcIkZyZXEyMDA5XCIsIHVuZGVmaW5lZF9tc2c9RXJyb3IxMykgJT4lIGNoZWNrX2VxdWFsKGluY29ycmVjdF9tc2c9RXJyb3IxNClcbmV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwibGVuZ3RoXCIsIG5vdF9jYWxsZWRfbXNnPUVycm9yMTUpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1FcnJvcjE2KVxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KFwiTGVuZzIwMDlcIiwgdW5kZWZpbmVkX21zZz1FcnJvcjE3KSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1FcnJvcjE4KVxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJtZWFuXCIsIG5vdF9jYWxsZWRfbXNnPUVycm9yMTkpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1FcnJvcjIwKVxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KFwiTWVhbjIwMDlcIiwgdW5kZWZpbmVkX21zZz1FcnJvcjIxKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1FcnJvcjIyKVxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJ0YWJsZVwiLCBub3RfY2FsbGVkX21zZz1FcnJvcjIzKSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKGluY29ycmVjdF9tc2c9RXJyb3IyNClcbmV4KCkgJT4lIGNoZWNrX29iamVjdChcIlRhYjIwMDlcIiwgdW5kZWZpbmVkX21zZz1FcnJvcjI1KSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1FcnJvcjI2KVxuXG5zdWNjZXNzX21zZyhcIkdldHRpbmcgc3RhcnRlZCBpcyBhbHdheXMgdGhlIGhhcmRlc3QgdGhpbmcgdG8gZG8uIEV4Y2VsbGVudCBzdGFydCFcIikiLCJoaW50IjoiVGFrZSBzb21lIHRpbWUgdG8gZXhwbG9yZSB0aGUgb25saW5lIDxjb2RlPlI8L2NvZGU+IGRvY3VtZW50YXRpb24uPC9wPlxuXG48cD5Ob3RlIHRoZSBkb3VibGUgZXF1YWwgc2lnbnMgPGNvZGU+PT08L2NvZGU+IG5lZWRlZCBmb3IgdGhlIHRoZSA8Y29kZT5zdWJzZXQoKTwvY29kZT4gZnVuY3Rpb24uIn0= 1.4 Property Fund Claim Severity Video: Claim Severity for the Wisconsin Property Fund Overheads: Claim Severity for the Wisconsin Property Fund (Click Tab to View) A. Severity Distribution (2010) B. Claims Severity - R Code C. Claim Outcomes and Coverage by Year D. Analysis by Year - R Code E. Claim Frequency and Severity, Deductibles, and Coverage F. Claim Frequency and Severity, Deductibles, and Coverage - R Code G. Cost of Insurance Hide Hide Hide Hide Hide Hide Hide 1.4.1 Exercise. Exploring Claim Severities Assignment Text The Wisconsin Property Fund data covering years 2006-2010 has already been read into a data frame called Insample. These data includes the average claim severity yAvg. The video explored the distribution of the claims severity for year 2010; in this assignment, we conduct a similar investigation for year 2009. Instructions Use the function subset() twice, once to create a smaller data set based on year 2009 experience and again to restrict consideration to fund members with positive claims. From this subset, define the average claim severity as a global variable. Use the function length() to determine the number of members with positive claims. Use the function summary() to calculate several summary statistics. Use the function hist() to produce histograms that visualize the claim severity distribution. Do this once on the original scale and again on the logarithmic scale. Use the mfrow switch in the function par() to set the graphical parameters so that the graphs can be viewed side-by-side to promote comparisons. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSkiLCJzYW1wbGUiOiJJbnNhbXBsZTIwMDkgPC0gc3Vic2V0KD8/KVxuSW5zYW1wbGVQb3MyMDA5IDwtIHN1YnNldChJbnNhbXBsZTIwMDksIHlBdmc+MClcbkF2Z0NsYWltPC0gSW5zYW1wbGVQb3MyMDA5JHlBdmdcblxuIyBUYWJsZVxuc3VtbWFyeSg/Pylcbj8/KEF2Z0NsYWltKVxuXG4jIEZpZ3VyZXNcbnBhcihtZnJvdz1jKDEsID8/KSlcbmhpc3QoQXZnQ2xhaW0sIG1haW49XCJcIiwgeGxhYj1cIkF2ZXJhZ2UgQ2xhaW1zXCIpXG5oaXN0KD8/LCBtYWluPVwiXCIsIHhsYWI9XCJMb2dhcml0aG1pYyBBdmVyYWdlIENsYWltc1wiKSIsInNvbHV0aW9uIjoiSW5zYW1wbGUyMDA5PC0gc3Vic2V0KEluc2FtcGxlLCBZZWFyPT0yMDA5KVxuSW5zYW1wbGVQb3MyMDA5PC0gc3Vic2V0KEluc2FtcGxlMjAwOSwgeUF2Zz4wKVxuQXZnQ2xhaW0gPC0gSW5zYW1wbGVQb3MyMDA5JHlBdmdcblxuIyBUYWJsZVxuc3VtbWFyeShBdmdDbGFpbSlcbmxlbmd0aChBdmdDbGFpbSlcblxuIyBGaWd1cmVzXG5wYXIobWZyb3c9YygxLCAyKSlcbmhpc3QoQXZnQ2xhaW0sIG1haW49XCJcIiwgeGxhYj1cIkF2ZXJhZ2UgQ2xhaW1zXCIpXG5oaXN0KGxvZyhBdmdDbGFpbSksIG1haW49XCJcIiwgeGxhYj1cIkxvZ2FyaXRobWljIEF2ZXJhZ2UgQ2xhaW1zXCIpIiwic2N0IjoiI0NoZWNrIGRhdGEgc2V0IG9iamVjdFxuZXJyb3IxPC1cIlVzZSBgSW5zYW1wbGUyMDA5YCB0byBjcmVhdGUgYW4gb2JqZWN0IG5hbWVkIGBJbnNhbXBsZTIwMDlgZnJvbSB0aGUgeWVhciAyMDA5IGRhdGEuXCJcbmVycm9yMjwtXCJBc3NpZ24gdGhlIHN1YnNldCBvZiAyMDA5IGRhdGEgYnkgdXNpbmcgZnVuY3Rpb24gc3Vic2V0KEluc2FtcGxlLCBZZWFyPT0yMDA5KSwgQ2FwaXRhbGl6ZSBZLlwiXG5lcnJvcjM8LVwiVXNlIGBJbnNhbXBsZVBvczIwMDlgIHRvIGNyZWF0ZSBhbiBvYmplY3QgbmFtZWQgYEluc2FtcGxlUG9zMjAwOWBmcm9tIHRoZSB5ZWFyIDIwMDkgQ2xhaW0gZGF0YS5cIlxuZXJyb3I0PC1cIkFzc2lnbiB0aGUgcG9zaXRpdmUgY2xhaW0gYW1vdW50cyBvZiAyMDA5IGRhdGEgYnkgdXNpbmcgZnVuY3Rpb24gc3Vic2V0KEluc2FtcGxlMjAwOSwgeUF2Zz4wKSBpbiB3aGljaCAncG9zJyByZWZlcnMgdGhlIHBvc2l0aXZlIGNsYWltIGFtb3VudHNcIlxuZXJyb3I1PC1cIlVzZSBgQXZnQ2xhaW1gIHRvIGNyZWF0ZSBhbiBvYmplY3QgbmFtZWQgYEF2Z0NsYWltYGZyb20gdGhlIHllYXIgMjAwOSBDbGFpbSBkYXRhICdJbnNhbXBsZVBvczIwMDkkeUF2ZycuXCJcbmVycm9yNjwtXCJBc3NpZ24gdGhlIGNvbHVtbiB5QXZnIG9mIDIwMDkgZGF0YSBieSB1c2luZyBJbnNhbXBsZTIwMDkkeUF2ZyBpbiB3aGljaCAkIHBvaW50cyBvdXQgdGhlIGNvbHVtbiBuYW1lXCJcbmVycm9yNzwtXCJVc2UgYGxlbmd0aGAgb24gdGhlIEF2Z0NsYWltIHRvIGNvdW50IHRoZSBudW1iZXIgb2YgZW50cmllcyBpbiB0aGUgQXZnQ2xhaW0gY29sdW1uXCJcbmVycm9yODwtXCJVc2UgYEF2Z0NsYWltYCB0byBsb2NhdGUgdGhlIGNvcnJlY3QgY29sdW1uIHdoaWNoIHN0b3JlcyB0aGUgQXZlcmFnZSBDbGFpbSBBbW91bnQgZGF0YVwiXG5lcnJvcjk8LVwiVXNlIGBzdW1tYXJ5YCBvbiB0aGUgQXZnQ2xhaW0gdG8gZ2V0IHRoZSBzdW1tYXJ5IHN0YXRpc3RpY3Mgb2YgdGhlIGRhdGEgaW4gdGhlIEZyZXF1ZW5jeSBjb2x1bW5cIlxuZXJyb3IxMDwtXCJVc2UgYEF2Z0NsYWltYCB0byBsb2NhdGUgdGhlIGNvcnJlY3QgY29sdW1uIHdoaWNoIHN0b3JlcyB0aGUgQXZlcmFnZSBDbGFpbSBBbW91bnQgZGF0YSBmcm9tIFllYXIgMjAwOVwiXG5lcnJvcjExPC1cIiBEaWQgeW91IGNvcnJlY3RseSBzcGVjaWZ5IHRoZSBhcmd1bWVudCAnQXZnQ2xhaW0nP1wiXG5lcnJvcjEyPC1cIkRpZCB5b3UgY29ycmVjdGx5IHNwZWNpZnkgdGhlIGFyZ3VtZW50ICdsb2coQXZnQ2xhaW0pJz9cIlxuZXJyb3IxMzwtXCJVc2UgZnVuY3Rpb24gYGhpc3RgIG9uIHRoZSBBdmdDbGFpbSB0byBwbG90IHRoZSBoaXN0b2dyYW0gb2YgdGhlIGF2ZXJhZ2UgY2xhaW1zXCJcbmVycm9yMTQ8LVwiVXNlIGBBdmdDbGFpbWAgdG8gbG9jYXRlIHRoZSBjb3JyZWN0IGRhdGEgZm9yIGhpc3RvZ3JhbSBwbG90dGluZy4gTWFrZSBzdXJlIHRoZSB4LWF4aXMgbGFiZWwgaXMgc3BlY2lmaWVkIGFzIEF2ZXJhZ2UgQ2xhaW1zIGJ5IHVzaW5nIHhsYWIgPSAnQXZlcmFnZSBDbGFpbXMnIFwiXG5lcnJvcjE1PC1cIlVzZSBmdW5jdGlvbiBgaGlzdGAgb24gdGhlIGxvZyhBdmdDbGFpbSkgdG8gcGxvdCB0aGUgaGlzdG9ncmFtIG9mIHRoZSBsb2cgb2YgYXZlcmFnZSBjbGFpbXNcIiAgXG5lcnJvcjE2PC1cIlVzZSBgbG9nKEF2Z0NsYWltKWAgdG8gbG9nLXRyYW5zZm9ybSB0aGUgY29ycmVjdCBkYXRhIGZvciBoaXN0b2dyYW0gcGxvdHRpbmcuIE1ha2Ugc3VyZSB0aGUgeC1heGlzIGxhYmVsIGlzIHNwZWNpZmllZCBhcyBMb2dhcml0aG1pYyBBdmVyYWdlIENsYWltcyBieSB1c2luZyB4bGFiID0gJ0xvZ2FyaXRobWljIEF2ZXJhZ2UgQ2xhaW1zJyBcIlxuXG5leCgpICU+JSBjaGVja19vYmplY3QoXCJJbnNhbXBsZTIwMDlcIiwgdW5kZWZpbmVkX21zZz1lcnJvcjEpICU+JSBjaGVja19lcXVhbChpbmNvcnJlY3RfbXNnPWVycm9yMilcblxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KFwiSW5zYW1wbGVQb3MyMDA5XCIsIHVuZGVmaW5lZF9tc2c9ZXJyb3IzKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1lcnJvcjQpXG5cbmV4KCkgJT4lIGNoZWNrX29iamVjdChcIkF2Z0NsYWltXCIsIHVuZGVmaW5lZF9tc2c9ZXJyb3I1KSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1lcnJvcjYpXG5cbiNDaGVjayBUYWJsZVxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJsZW5ndGhcIiwgbm90X2NhbGxlZF9tc2c9ZXJyb3I3KSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKGluY29ycmVjdF9tc2c9ZXJyb3I4KVxuXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcInN1bW1hcnlcIiwgbm90X2NhbGxlZF9tc2c9ZXJyb3I5KSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKGluY29ycmVjdF9tc2c9KVxuXG4jQ2hlY2sgRmlndXJlc1xuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJoaXN0XCIsIGluZGV4ID0gMSkgJT4lIGNoZWNrX3Jlc3VsdCgpICU+JSBjaGVja19lcXVhbChpbmNvcnJlY3RfbXNnPWVycm9yMTEpXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcImhpc3RcIiwgaW5kZXggPSAyKSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKGluY29ycmVjdF9tc2c9ZXJyb3IxMilcblxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJoaXN0XCIsIGluZGV4ID0gMSwgbm90X2NhbGxlZF9tc2c9ZXJyb3IxMykgJT4lIGNoZWNrX3Jlc3VsdCgpICU+JSBjaGVja19lcXVhbChpbmNvcnJlY3RfbXNnPWVycm9yMTQpXG5cbmV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwiaGlzdFwiLCBpbmRleCA9IDIsIG5vdF9jYWxsZWRfbXNnPWVycm9yMTUpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1lcnJvcjE2KVxuXG5zdWNjZXNzX21zZyhcIkV4Y2VsbGVudCEgVGhpcyBleGVyY2lzZSBmZWF0dXJlcyBkYXRhIG1hbmlwdWxhdGlvbiAodGhyb3VnaCBzdWJzZXR0aW5nKSwgY2FsY3VsYXRlcyBzdW1tYXJ5IHN0YXRpc3RpY3MsIGFuZCBwb3J0cmF5cyBkYXRhIGdyYXBoaWNhbGx5LiBZb3UgaGF2ZSBkb25lIGl0IGFsbCFcIikiLCJoaW50IjoiVGhlIDxjb2RlPlI8L2NvZGU+IGZ1bmN0aW9uIDxhIGhyZWY9XCJodHRwczovL3d3dy5yZG9jdW1lbnRhdGlvbi5vcmcvcGFja2FnZXMvYmFzZS92ZXJzaW9ucy8zLjYuMi90b3BpY3MvbG9nXCI+bG9nKCk8L2E+IGRlZmF1bHRzIHRvIG5hdHVyYWwgbG9nYXJpdGhtcy4gSXQgY2FuIGFsc28gYmUgdXNlZCB0byBwcm9kdWNlIGNvbW1vbiAoYmFzZSAxMCkgYXMgd2VsbCBhcyBvdGhlciBiYXNlcy4ifQ== 1.4.2 Exercise. Skewness of the Claim Severity Distribution Assignment Text Many distributions used in insurance analytics are skewed. In this assignment, we demonstrate how to detect the skewness and show that skewness is a feature of an entire data set, not the result of a handful of outlying observations. Specifically, we consider the average claim for year 2010 of the Wisconsin Property Fund data that has been made available in the (global) variable AvgClaim; this variable is only for fund members with positive claims. The video remarked on the skewness of this variable and used a logarithmic transformation to facilitate the analysis. In this assignment, we show how an alternative strategy, omitting unusually large observations, does not address the skewed nature of the distribution. Instructions Use the functions mean() and median() to compute both the mean and median of AvgClaim. You will see that the mean is much larger than the median, a classic diagnostic approach for establishing the right skewness of a distribution. Use the function order() to order the data in terms of decreasing size. Use the function head() to examine the 10 largest observations. Create 6 histograms, graphically presenting them in panels that have 2 rows and 3 columns. In the first histogram, omit the 9 largest observations. In the second, omit the 6 largest. Continuing this pattern, omit 5 in the third histogram, omit 3 in the fourth, omit 1 in the fifth, and do not admit any in the sixth. A careful inspection of this panel of histograms reveals that the distribution remains skewed, despite repeatedly removing large outlying observations. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSlcbkluc2FtcGxlMjAxMDwtIHN1YnNldChJbnNhbXBsZSwgWWVhcj09MjAxMClcbkluc2FtcGxlUG9zMjAxMDwtIHN1YnNldChJbnNhbXBsZTIwMTAsIHlBdmc+MClcbkF2Z0NsYWltIDwtIEluc2FtcGxlUG9zMjAxMCR5QXZnIiwic2FtcGxlIjoibWVhbig/Pylcbj8/KEF2Z0NsYWltKVxuXG5PcmRlci5BdmdDbGFpbSA8LSBBdmdDbGFpbVs/PyhBdmdDbGFpbSwgZGVjcmVhc2luZyA9IFRSVUUpXVxuaGVhZChPcmRlci5BdmdDbGFpbSwgbiA9ID8/KVxuXG4jIEZpZ3VyZXNcbnBhcihtZnJvdz1jKDIsMykpXG5oaXN0KE9yZGVyLkF2Z0NsYWltWy1jKDE6OSldLCBtYWluPVwiXCIsIHhsYWI9XCJDbGFpbXMgLSBEcm9wIDlcIilcbmhpc3QoT3JkZXIuQXZnQ2xhaW1bPz9dLCBtYWluPVwiXCIsIHhsYWI9XCJDbGFpbXMgLSBEcm9wIDZcIilcbj8/KE9yZGVyLkF2Z0NsYWltWy1jKDE6NSldLCBtYWluPVwiXCIsIHhsYWI9XCJDbGFpbXMgLSBEcm9wIDVcIilcbmhpc3QoT3JkZXIuQXZnQ2xhaW1bLWMoMTozKV0sIG1haW49XCJcIiwgeGxhYj1cIkNsYWltcyAtIERyb3AgM1wiKVxuaGlzdChPcmRlci5BdmdDbGFpbVstMV0sIG1haW49XCJcIiwgeGxhYj1cIkNsYWltcyAtIERyb3AgMVwiKVxuaGlzdChPcmRlci5BdmdDbGFpbSwgbWFpbj1cIlwiLCB4bGFiPVwiQ2xhaW1zIC0gQWxsXCIpIiwic29sdXRpb24iOiJtZWFuKEF2Z0NsYWltKVxubWVkaWFuKEF2Z0NsYWltKVxuXG5PcmRlci5BdmdDbGFpbSA8LSBBdmdDbGFpbVtvcmRlcihBdmdDbGFpbSwgZGVjcmVhc2luZyA9IFRSVUUpXVxuaGVhZChPcmRlci5BdmdDbGFpbSwgbiA9IDEwKVxuXG4jIEZpZ3VyZXNcbnBhcihtZnJvdz1jKDIsMykpXG5oaXN0KE9yZGVyLkF2Z0NsYWltWy1jKDE6OSldLCBtYWluPVwiXCIsIHhsYWI9XCJDbGFpbXMgLSBEcm9wIDlcIilcbmhpc3QoT3JkZXIuQXZnQ2xhaW1bLWMoMTo2KV0sIG1haW49XCJcIiwgeGxhYj1cIkNsYWltcyAtIERyb3AgNlwiKVxuaGlzdChPcmRlci5BdmdDbGFpbVstYygxOjUpXSwgbWFpbj1cIlwiLCB4bGFiPVwiQ2xhaW1zIC0gRHJvcCA1XCIpXG5oaXN0KE9yZGVyLkF2Z0NsYWltWy1jKDE6MyldLCBtYWluPVwiXCIsIHhsYWI9XCJDbGFpbXMgLSBEcm9wIDNcIilcbmhpc3QoT3JkZXIuQXZnQ2xhaW1bLTFdLCBtYWluPVwiXCIsIHhsYWI9XCJDbGFpbXMgLSBEcm9wIDFcIilcbmhpc3QoT3JkZXIuQXZnQ2xhaW0sIG1haW49XCJcIiwgeGxhYj1cIkNsYWltcyAtIEFsbFwiKSIsInNjdCI6Im1lYW5tc2cgPC0gXCJEaWQgeW91IGNvcnJlY3RseSBzcGVjaWZ5IHRoZSBhcmd1bWVudCBgQXZnQ2xhaW1gP1wiXG5tZWRpYW5tc2cgPC0gXCJEaWQgeW91IGNvcnJlY3RseSBzcGVjaWZ5IHRoZSBmdW5jdGlvbiBgbWVkaWFuYD9cIlxub3JkZXJtc2cgPC0gXCJEaWQgeW91IGNvcnJlY3RseSBzcGVjaWZ5IHRoZSBmdW5jdGlvbiBgb3JkZXJgP1wiXG5oZWFkbXNnIDwtIFwiUmVjYWxsIHRoYXQgd2Ugd2lzaCB0byBleGFtaW5lIHRoZSAxMCBsYXJnZXN0IG9ic2VydmF0aW9ucy5cIlxuRHJvcDJtc2cgPC0gXCJEaWQgeW91IGNvcnJlY3RseSBzcGVjaWZ5IHRoZSBzZWNvbmQgaGlzdG9ncmFtP1wiXG5Ecm9wM21zZyA8LSBcIkRpZCB5b3UgY29ycmVjdGx5IHNwZWNpZnkgdGhlIHRoaXJkIGhpc3RvZ3JhbT9cIlxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJtZWFuXCIsIG5vdF9jYWxsZWRfbXNnID1tZWFubXNnKSAlPiUgY2hlY2tfcmVzdWx0KGVycm9yX21zZz1tZWFubXNnKSAlPiUgY2hlY2tfZXF1YWwoKVxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJtZWRpYW5cIiwgbm90X2NhbGxlZF9tc2cgPW1lZGlhbm1zZykgJT4lIGNoZWNrX3Jlc3VsdChlcnJvcl9tc2c9bWVkaWFubXNnKSAlPiUgY2hlY2tfZXF1YWwoKVxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KFwiT3JkZXIuQXZnQ2xhaW1cIiwgdW5kZWZpbmVkX21zZyA9IFwiTWFrZSBzdXJlIHRvIG5vdCByZW1vdmUgYE9yZGVyLkF2Z0NsYWltYCFcIikgJT4lIGNoZWNrX2VxdWFsKGluY29ycmVjdF9tc2c9b3JkZXJtc2cpXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcImhlYWRcIikgJT4lIGNoZWNrX3Jlc3VsdCgpICU+JSBjaGVja19lcXVhbChpbmNvcnJlY3RfbXNnPWhlYWRtc2cpXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcImhpc3RcIiwgaW5kZXggPSAxKSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKClcbmV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwiaGlzdFwiLCBpbmRleCA9IDIpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1Ecm9wMm1zZylcbmV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwiaGlzdFwiLCBpbmRleCA9IDMpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoaW5jb3JyZWN0X21zZz1Ecm9wM21zZylcbmV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwiaGlzdFwiLCBpbmRleCA9IDQpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoKVxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJoaXN0XCIsIGluZGV4ID0gNSkgJT4lIGNoZWNrX3Jlc3VsdCgpICU+JSBjaGVja19lcXVhbCgpXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcImhpc3RcIiwgaW5kZXggPSA2KSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKClcbnN1Y2Nlc3NfbXNnKFwiRXhjZWxsZW50ISBSZW1vdmluZyBsYXJnZSB1bnVzdWFsIG9ic2VydmF0aW9ucyBoYXMgaXRzIHBsYWNlIGluIHN0YXRpc3RpY3MuIEhvd2V2ZXIsIGluIGluc3VyYW5jZSBhbmFseXRpY3MsIGxhcmdlIG9ic2VydmF0aW9ucyBhcmUgbm90IHVudXN1YWwgZm9yIGRpc3RyaWJ1dGlvbnMgdGhhdCBhcmUgc2tld2VkLiBSZW1vdmluZyBsYXJnZSBvYnNlcnZhdGlvbnMgaXMgbm90IGEgdGVjaG5pcXVlIHRoYXQgY2hhbmdlcyB0aGUgc2tld2VkIG5hdHVyZSBvZiB0aGVzZSBkaXN0cmlidXRpb25zLlwiKSIsImhpbnQiOiJUaGUgc3ludGF4IDxjb2RlPnhbb3JkZXIoeCldPC9jb2RlPiBwcm9kdWNlcyBhbiAoaW5jcmVhc2luZykgb3JkZXJlZCB2ZXJzaW9uIG9mIGEgdmVjdG9yIDxjb2RlPng8L2NvZGU+LiJ9 1.4.3 Exercise. Claim Severity by Year Assignment Text Much of insurance analytics is about making predictions of future behavior. To understand distributions in future years, we look at trends in distributions from the current and preceding years. Some simple trends that are helpful not only for understanding but also communicating results to others involve looking at the mean, or average, behavior. In this assignment, we examine 2006-2010 of the Wisconsin Property Fund that has been previously loaded into the data frame Insample. As in the video, by Year we calculate mean values of claims frequency (Freq), average claims severity (yAvg) and coverage (BCcov), as well as the number of fund members. Instructions Load the library needed to use the function ddply(). (The documentation provides that name of the library needed to run this function.) With this function, produce a data frame with the requisite summary statistics. To document results, provide intuitive names of these summary statistics using the names() function. Before displaying the data frame, tidy up the results a bit by rounding the mean values of claim frequency to three digits using the round() function. Also, present the mean coverage in thousands (of dollars), rounding to zero digits. After tidying up, display the results. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCxcbiAgICAgICAgICAgICAgICAgICAgICBuYS5zdHJpbmdzPWMoXCIuXCIpLCBzdHJpbmdzQXNGYWN0b3JzPUZBTFNFKSIsInNhbXBsZSI6ImxpYnJhcnkoPz8pXG5UYWJsZTFJbiA8LSBkZHBseShJbnNhbXBsZSwgYyhcIlllYXJcIiksIHN1bW1hcml6ZSwgIEF2Z0ZyZXEgICAgPSBtZWFuKEZyZXEpLCBBdmdTZXYgPSA/Pyh5QXZnKSwgIEF2Z0NvdiAgID0gPz8oQkNjb3YpLCBOdW1Qb2wgPSA/PyhGcmVxKSApXG5uYW1lcyhUYWJsZTFJbikgPC0gYyhcIlllYXJcIiwgPz8sICBcIkF2ZXJhZ2UgU2V2ZXJpdHlcIiwgXCJBdmcgQ292ZXJhZ2UgKDAwMHMpXCIsID8/KVxuVGFibGUxSW5bLDJdIDwtIHJvdW5kKFRhYmxlMUluWywyXSwgZGlnaXRzID0gPz8pXG5UYWJsZTFJblssNF0gPC0gcm91bmQoVGFibGUxSW5bLDRdLz8/LCBkaWdpdHMgPSA/PylcblRhYmxlMUluIiwic29sdXRpb24iOiJsaWJyYXJ5KHBseXIpXG5UYWJsZTFJbiA8LSBkZHBseShJbnNhbXBsZSwgYyhcIlllYXJcIiksIHN1bW1hcml6ZSwgQXZnRnJlcSAgICA9IG1lYW4oRnJlcSksIEF2Z1NldiA9IG1lYW4oeUF2ZyksICBBdmdDb3YgICA9IG1lYW4oQkNjb3YpLCBOdW1Qb2wgPSBsZW5ndGgoRnJlcSkgKVxubmFtZXMoVGFibGUxSW4pIDwtIGMoXCJZZWFyXCIsIFwiQXZlcmFnZSBGcmVxdWVuY3lcIiwgXCJBdmVyYWdlIFNldmVyaXR5XCIsIFwiQXZnIENvdmVyYWdlICgwMDBzKVwiLCBcIk51bWJlciBvZiBQb2xpY3lob2xkZXJzXCIpXG5UYWJsZTFJblssMl0gPC0gcm91bmQoVGFibGUxSW5bLDJdLCBkaWdpdHMgPSAzKVxuVGFibGUxSW5bLDRdIDwtIHJvdW5kKFRhYmxlMUluWyw0XS8xMDAwLCBkaWdpdHMgPSAwKVxuVGFibGUxSW4iLCJzY3QiOiJsaWJtc2cgPC0gXCJEaWQgeW91IGNhbGwgdGhlIGxpYnJhcnkgYHBseXJgP1wiXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcImxpYnJhcnlcIikgJT4lIGNoZWNrX3Jlc3VsdCguLGVycm9yX21zZyA9bGlibXNnKSAlPiUgY2hlY2tfZXF1YWwoKVxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KFwiVGFibGUxSW5cIiwgdW5kZWZpbmVkX21zZyA9IFwiTWFrZSBzdXJlIHRvIG5vdCByZW1vdmUgYFRhYmxlMUluYCFcIikgJT4lIGNoZWNrX2VxdWFsKClcbnN1Y2Nlc3NfbXNnKFwiRXhjZWxsZW50ISBQcmVzZW50aW5nIHRoZSByaWdodCBzdW1tYXJ5IHN0YXRpc3RpY3MgaW4gYSBjbGVhbiB3YXkgaXMgaW1wb3J0YW50IGZvciBjb21tdW5pY2F0aW9uIG9mIHJlc3VsdHMuIEl0IGlzIGFsc28gdmVyeSB1c2VmdWwgYXMgeW91IGFyZSB0cnlpbmcgdG8gbWFrZSBzZW5zZSBvZiBhIGNvbXBsZXggZGF0YSBzZXQuXCIpIiwiaGludCI6IlRvIGNvbXB1dGUgc3RhbmRhcmQgZGV2aWF0aW9ucywgeW91IGNhbiB1c2UgdGhlIGZ1bmN0aW9uIDxhIGhyZWY9XCJodHRwczovL3d3dy5yZG9jdW1lbnRhdGlvbi5vcmcvcGFja2FnZXMvc3RhdHMvdmVyc2lvbnMvMy42LjIvdG9waWNzL3NkXCI+c2QoKTwvYT4uIn0= 1.5 Property Fund Rating Variables Video: Rating Variables for the Wisconsin Property Fund Overheads: Rating Variables for the Wisconsin Property Fund (Click Tab to View) A. Description of Rating Variables B. Claims by Entity Type, Fire Class, and No Claim Credit C. Claim Frequency and Severity, Deductibles, and Coverage - R Code D. Claims by Entity Type and Alarm Credit Category E. Initiating Insurance Hide Hide Hide Hide Hide 1.5.1 Exercise. Claim by Entity Type, Fire Class, and No Claim Credit Assignment Text Analytics of insurance data has much in common with analytics in other areas but insurance also has its own peculiarities. One of example of this is how one only examines summary statistics for positive claims. (Mathematically, the claim severity distribution is defined conditional on the occurrence of a claim). As a consequence, we often need to write specialized routines for insurance applications. Your supervisor finds useful the analysis of claims outcomes by entity type, fire class, and no claim code (already completed in the video). To make this analysis more impactful, the supervisor wants you to modify the code to include a basic measure of uncertainty, the standard deviation. Instructions Modify the function created for this specific analysis, ByVarSumm(), to include the standard deviation statistic. Note that, like the mean, we only calculate the standard deviation on the sub-sample of positive claims. Include this standard deviation statistic as part of your table output. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCxcbiAgICAgICAgICAgICAgICAgICAgICBuYS5zdHJpbmdzPWMoXCIuXCIpLCBzdHJpbmdzQXNGYWN0b3JzPUZBTFNFKSIsInNhbXBsZSI6IkJ5VmFyU3VtbSA8LSBmdW5jdGlvbihkYXRhc3ViKXtcbiAgQTEgPC0gbGVuZ3RoKGRhdGFzdWIkRnJlcSlcbiAgQTIgPC0gbWVhbihkYXRhc3ViJEZyZXEpXG4gIGRhdGFzdWIxIDwtICBzdWJzZXQoZGF0YXN1YiwgeUF2Zz4wKVxuICBBMyA8LSBtZWFuKGRhdGFzdWIxJHlBdmcpXG4gIEE0IDwtID8/IFxuICByZXR1cm4oIGMoQTEsQTIsQTMsID8/KSApXG4gIH1cblxudDEgPC0gQnlWYXJTdW1tKHN1YnNldChJbnNhbXBsZSwgVHlwZVZpbGxhZ2UgPT0gMSkpXG50MiA8LSBCeVZhclN1bW0oc3Vic2V0KEluc2FtcGxlLCBUeXBlQ2l0eSA9PSAxKSlcbnQzIDwtIEJ5VmFyU3VtbShzdWJzZXQoSW5zYW1wbGUsIFR5cGVDb3VudHkgPT0gMSkpXG50NCA8LSBCeVZhclN1bW0oc3Vic2V0KEluc2FtcGxlLCBUeXBlTWlzYyA9PSAxKSlcbnQ1IDwtIEJ5VmFyU3VtbShzdWJzZXQoSW5zYW1wbGUsIFR5cGVTY2hvb2wgPT0gMSkpXG50NiA8LSBCeVZhclN1bW0oc3Vic2V0KEluc2FtcGxlLCBUeXBlVG93biA9PSAxKSlcbnQ3IDwtIEJ5VmFyU3VtbShzdWJzZXQoSW5zYW1wbGUsIEZpcmU1ID09IDApKVxudDggPC0gQnlWYXJTdW1tKHN1YnNldChJbnNhbXBsZSwgRmlyZTUgPT0gMSkpXG50OSA8LSBCeVZhclN1bW0oc3Vic2V0KEluc2FtcGxlLCBJbnNhbXBsZSROb0NsYWltQ3JlZGl0ID09IDApKVxudDEwIDwtIEJ5VmFyU3VtbShzdWJzZXQoSW5zYW1wbGUsIEluc2FtcGxlJE5vQ2xhaW1DcmVkaXQgPT0gMSkpXG50MTEgPC0gQnlWYXJTdW1tKEluc2FtcGxlKVxuXG5UYWJsZWEgPC0gcmJpbmQodDEsdDIsdDMsdDQsdDUsdDYsdDcsdDgsdDksdDEwLHQxMSlcblRhYmxlNCA8LSByb3VuZChUYWJsZWEsIGRpZ2l0cyA9IDMpXG5jb2xuYW1lcyhUYWJsZTQpIDwtIGMoXCJOdW1iZXIgb2YgUG9saWNpZXNcIiwgXCJDbGFpbSBGcmVxdWVuY3lcIiwgXCJBdmVyYWdlIFNldmVyaXR5XCIsID8/KVxucm93bmFtZXMoVGFibGU0KSA8LSBjKFwiVmlsbGFnZVwiLFwiQ2l0eVwiLFwiQ291bnR5XCIsXCJNaXNjXCIsXCJTY2hvb2xcIiwgXCJUb3duXCIsXCJGaXJlNS0tTm9cIixcIkZpcmU1LS1ZZXNcIixcIk5vQ2xhaW1DcmVkaXQtLU5vXCIsIFwiTm9DbGFpbUNyZWRpdC0tWWVzXCIsXCJUb3RhbFwiKVxuVGFibGU0Iiwic29sdXRpb24iOiJCeVZhclN1bW0gPC0gZnVuY3Rpb24oZGF0YXN1Yil7XG4gIEExIDwtIGxlbmd0aChkYXRhc3ViJEZyZXEpXG4gIEEyIDwtIG1lYW4oZGF0YXN1YiRGcmVxKVxuICBkYXRhc3ViMSA8LSAgc3Vic2V0KGRhdGFzdWIsIHlBdmc+MClcbiAgQTMgPC0gbWVhbihkYXRhc3ViMSR5QXZnKVxuICBBNCA8LSBzZChkYXRhc3ViMSR5QXZnKSAgXG4gIHJldHVybiggYyhBMSxBMixBMyxBNCkgKVxuICB9XG5cbnQxIDwtIEJ5VmFyU3VtbShzdWJzZXQoSW5zYW1wbGUsIFR5cGVWaWxsYWdlID09IDEpKVxudDIgPC0gQnlWYXJTdW1tKHN1YnNldChJbnNhbXBsZSwgVHlwZUNpdHkgPT0gMSkpXG50MyA8LSBCeVZhclN1bW0oc3Vic2V0KEluc2FtcGxlLCBUeXBlQ291bnR5ID09IDEpKVxudDQgPC0gQnlWYXJTdW1tKHN1YnNldChJbnNhbXBsZSwgVHlwZU1pc2MgPT0gMSkpXG50NSA8LSBCeVZhclN1bW0oc3Vic2V0KEluc2FtcGxlLCBUeXBlU2Nob29sID09IDEpKVxudDYgPC0gQnlWYXJTdW1tKHN1YnNldChJbnNhbXBsZSwgVHlwZVRvd24gPT0gMSkpXG50NyA8LSBCeVZhclN1bW0oc3Vic2V0KEluc2FtcGxlLCBGaXJlNSA9PSAwKSlcbnQ4IDwtIEJ5VmFyU3VtbShzdWJzZXQoSW5zYW1wbGUsIEZpcmU1ID09IDEpKVxudDkgPC0gQnlWYXJTdW1tKHN1YnNldChJbnNhbXBsZSwgSW5zYW1wbGUkTm9DbGFpbUNyZWRpdCA9PSAwKSlcbnQxMCA8LSBCeVZhclN1bW0oc3Vic2V0KEluc2FtcGxlLCBJbnNhbXBsZSROb0NsYWltQ3JlZGl0ID09IDEpKVxudDExIDwtIEJ5VmFyU3VtbShJbnNhbXBsZSlcblxuVGFibGVhIDwtIHJiaW5kKHQxLHQyLHQzLHQ0LHQ1LHQ2LHQ3LHQ4LHQ5LHQxMCx0MTEpXG5UYWJsZTQgPC0gcm91bmQoVGFibGVhLCBkaWdpdHMgPSAzKVxuY29sbmFtZXMoVGFibGU0KSA8LSBjKFwiTnVtYmVyIG9mIFBvbGljaWVzXCIsIFwiQ2xhaW0gRnJlcXVlbmN5XCIsIFwiQXZlcmFnZSBTZXZlcml0eVwiLCBcIlN0ZCBEZXYgU2V2ZXJpdHlcIilcbnJvd25hbWVzKFRhYmxlNCkgPC0gYyhcIlZpbGxhZ2VcIixcIkNpdHlcIixcIkNvdW50eVwiLFwiTWlzY1wiLFwiU2Nob29sXCIsIFwiVG93blwiLFwiRmlyZTUtLU5vXCIsXCJGaXJlNS0tWWVzXCIsXCJOb0NsYWltQ3JlZGl0LS1Ob1wiLCBcIk5vQ2xhaW1DcmVkaXQtLVllc1wiLFwiVG90YWxcIilcblRhYmxlNCIsInNjdCI6ImV4KCkgJT4lIGNoZWNrX29iamVjdChcIlRhYmxlNFwiLCB1bmRlZmluZWRfbXNnID0gXCJNYWtlIHN1cmUgdG8gbm90IHJlbW92ZSBgVGFibGU0YCFcIikgJT4lIGNoZWNrX2VxdWFsKClcbmV4KCkgJT4lIGNoZWNrX2Z1bl9kZWYoXCJCeVZhclN1bW1cIikgJT4lIHtcbiAgY2hlY2tfYXJndW1lbnRzKC4pXG4gIGNoZWNrX2JvZHkoLikgJT4lICBjaGVja19mdW5jdGlvbiguLCBcInNkXCIsIG5vdF9jYWxsZWRfbXNnID0gXCJDaGVjayB5b3VyIHNwZWNpZmljYXRpb24gb2YgdGhlIHNkKCkgZnVuY3Rpb24uXCIpXG59XG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcIkJ5VmFyU3VtbVwiKSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKClcblxuc3VjY2Vzc19tc2coXCJFeGNlbGxlbnQhIE1vZGlmeWluZyBzb21lb25lIGVsc2UncyBjb2RlIGNhbiBiZSBtb3JlIGRpZmZpY3VsdCB0aGFuIHdyaXRpbmcgeW91ciBvd24uIEl0IGlzIGEgbmVjZXNzYXJ5IHNraWxsIHdoZW4gd29ya2luZyBmb3IgbGFyZ2Ugb3JnYW5pemF0aW9ucy4gSXQgYWxzbyBtYWtlcyB5b3UgYXBwcmVjaWF0ZSB0aGUgdmFsdWUgb2YgZG9jdW1lbnRpbmcgeW91ciBvd24gY29kZSBmb3IgZnV0dXJlIHVzZXJzLlwiKSJ9 Show Quiz Solution "],["frequency-modeling.html", "Chapter 2 Frequency Modeling 2.1 Basic Frequency Distributions 2.2 The (a,b,0) Class 2.3 Mixture Distributions", " Chapter 2 Frequency Modeling Draft - Chapter Not Yet Complete Chapter description A primary focus for insurers is estimating the magnitude of aggregate claims it must bear under its insurance contracts. Aggregate claims are affected by both the frequency and the severity of the insured event. Decomposing aggregate claims into these two components, each of which warrant significant attention, is essential for analysis and pricing. This chapter discusses frequency distributions, summary measures, and parameter estimation techniques. Although not needed to go through the tutorials, some users may wish to download the overheads used in the videos. Download Chapter Two overheads as a .pdf file. By watching the videos and working through the tutorial exercises, you will get an appreciation for frequency modeling. For a deeper dive, see the corresponding chapter in the textbook, Chapter Two of Loss Data Analytics. 2.1 Basic Frequency Distributions In this section, you learn how to: Determine quantities that summarize a distribution such as the distribution and survival function, as well as moments such as the mean and variance Define and compute the moment and probability generating functions Describe and understand relationships among three important frequency distributions, the binomial, Poisson, and negative binomial distributions Video: Basic Frequency Distributions 2.1.1 Exercise. Representing the Number of Cyber Events with a Binomial Distribution Assignment Text Cyber risk for a firm is based on its liability for a data breach involving sensitive customer information, such as Social Security numbers, credit card numbers, account numbers, drivers license numbers and health records. A company models its cyber risk using the following assumptions: In any calendar quarter, there can be at most one cyber event. In any calendar quarter, the probability of a cyber event is 0.1. The numbers of cyber events in different calendar quarters are mutually independent. Based on these assumptions, you represent the total number of cyber events as a binomial distribution. Instructions. Identify the binomial distribution parameters for the number of cyber events in a 12 quarter (3 years) period. Calculate the probability that there are \\(k\\) cyber events for \\(k = 0, 1, \\ldots, 12\\) using the function dbinom(). Create a data frame to present your results. All values within a specific column should be rounded to the same number of decimal places. Display the data frame. Graph the probability mass function of the number of cyber events using the function barplot(). Include a descriptive title and axis labels for the graph. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJzaXplID0gPz9cbkN5YmVyLnByb2IgPSA/P1xuXG5vdXRjb21lcyA8LSAwOnNpemVcbnBtZiA8LSBkYmlub20oeD1vdXRjb21lcywgc2l6ZT1zaXplLCBwcm9iPUN5YmVyLnByb2IpICBcbnBtZlxuXG5wbWYxIDwtIHJvdW5kKHBtZiwgZGlnaXRzID0gNilcbm91dGNvbWVkYXRhZiA8LSByYmluZChvdXRjb21lcywgPz8pXG5vdXRjb21lZGF0YWYgXG5cbmJhcnBsb3QocG1mLCBuYW1lcy5hcmc9Pz8sIGNvbD1cImxpZ2h0Z3JlZW5cIiwgeWxhYiA9ID8/LCB4bGFiID0gPz8pIiwic29sdXRpb24iOiJzaXplID0gMTJcbkN5YmVyLnByb2IgPSAwLjAxXG5cbm91dGNvbWVzIDwtIDA6c2l6ZVxucG1mIDwtIGRiaW5vbSh4PW91dGNvbWVzLCBzaXplPXNpemUsIHByb2I9Q3liZXIucHJvYikgIFxucG1mXG5cbnBtZjEgPC0gcm91bmQocG1mLCBkaWdpdHMgPSA2KVxub3V0Y29tZWRhdGFmIDwtIHJiaW5kKG91dGNvbWVzLCBwbWYxKVxub3V0Y29tZWRhdGFmIFxuXG5iYXJwbG90KHBtZiwgbmFtZXMuYXJnPW91dGNvbWVzLCBjb2w9XCJsaWdodGdyZWVuXCIsIHlsYWIgPSBcIlByb2JhYmlsaXR5XCIsIHhsYWIgPSBcIkN5YmVyIEV2ZW50c1wiKSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiRXhjZWxsZW50IGpvYiEgTW9zdCBjb25zdW1lcnMgaGF2ZSBzb21lIGZhbWlsaWFyaXR5IHdpdGggdGhlIGJpbm9taWFsIGRpc3RyaWJ1dGlvbnMsIHNvIGl0IGlzIGltcG9ydGFudCBpbiBhY3R1YXJpYWwgYXBwbGljYXRpb25zIHRvIGJlIGFibGUgdG8gY29udmV5IG1lc3NhZ2VzIGFib3V0IGNvdW50cyBpbiB0aGUgY29udGV4dHMgb2YgYmlub21pYWxzLlwiKSIsImhpbnQiOiJSZXZpZXcgdGhlIGltcG9ydGFudCBjb3VudCBkaXN0cmlidXRpb25zIGluIDxhIGhyZWY9XCJodHRwczovL29wZW5hY3R0ZXh0cy5naXRodWIuaW8vTG9zcy1EYXRhLUFuYWx5dGljcy9DLUZyZXF1ZW5jeS1Nb2RlbGluZy5odG1sI1M6aW1wb3J0YW50LWZyZXF1ZW5jeS1kaXN0cmlidXRpb25zXCI+TG9zcyBEYXRhIEFuYWx5dGljcyBGcmVxdWVuY3kgTW9kZWxpbmc8L2E+IGNoYXB0ZXIuIn0= 2.1.2 Exercise. Representing the Number of Cyber Events with a Poisson Distribution Assignment Text Another company is also concerned with cyber risk. Compared to the company in the prior exercise, this company is larger and does not wish to assume at most one cyber event in a quarter. Moreover, it believes that the distribution of cyber events is a function of its technical support staff size that has increased over time. Thus, it wishes to model the number of cyber events as a Poisson distribution with expected number of events as: \\[ {\\small \\begin{array}{l|cccccc} \\hline \\text{Quarter} &amp; 1 &amp; 2 &amp; 3&amp; 4&amp; 5&amp; 6 \\\\\\hline \\text{Expected Number}&amp; 0.1 &amp; 0.1 &amp; 0.1 &amp; 0.1 &amp; 0.2 &amp; 0.2 \\\\ \\hline \\text{Quarter} &amp; 7 &amp; 8 &amp; 9&amp; 10&amp; 11&amp; 12 \\\\ \\hline \\text{Expected Number}&amp; 0.2 &amp; 0.2 &amp; 0.3 &amp; 0.3 &amp; 0.4 &amp; 0.5 \\\\ \\hline \\end{array} } \\] Assuming that the numbers of cyber events in different calendar quarters are mutually independent, the total number of cyber events over the three year period (12 quarters) has a Poisson distribution with expected number \\(\\lambda = 2.7\\). (Recall that the sum of independent Poisson random variables has a Poisson distribution.) Instructions Graph the probability mass function (pmf) of the number of cyber events using the function barplot(). Calculate the pmf and the cumulative probability distribution function for \\(k = 0, 1, \\ldots, 12\\) cyber events using the functions dpois(), ppois(). Create a data frame to present your results and display the data frame. From your data frame, identify the 95th percentile. Confirm your result using the qpois() function. How are the probabilities changing over time? Plot the probability of zero cyber events versus quarter number \\(k = 0, 1, \\ldots, 12\\). eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJsYW1iZGF2ZWMgPC0gYyhyZXAoMC4xLDQpLCByZXAoMC4yLDQpLCAwLjMsIDAuMywgMC40LCAwLjUpXG5DeWJlci5sYW1iZGEgPC0gc3VtKD8/KVxuXG5vdXRjb21lcyA8LSAwOjEyXG5DeWJlci5wbWYgPC0gZHBvaXMoeD0/PywgbGFtYmRhPUN5YmVyLmxhbWJkYSlcbmJhcnBsb3QoQ3liZXIucG1mLCBuYW1lcy5hcmc9b3V0Y29tZXMsIGNvbD1cImxpZ2h0Z3JlZW5cIiwgeWxhYiA9IFwiUHJvYmFiaWxpdHlcIiwgeGxhYiA9IFwiQ3liZXIgRXZlbnRzXCIpXG5cbkN5YmVyLmRmIDwtIHBwb2lzKG91dGNvbWVzLCA/Pylcbm91dGNvbWVkYXRhZiA8LSByYmluZChvdXRjb21lcywgQ3liZXIucG1mLCBDeWJlci5kZilcbm91dGNvbWVkYXRhZiBcblxucXBvaXMoPz8sIGxhbWJkYT1DeWJlci5sYW1iZGEpXG5cblByb2J6ZXJvIDwtIGRwb2lzKHg9MCwgbGFtYmRhPWxhbWJkYXZlYylcbnBsb3QoPz8sUHJvYnplcm8sIHR5cGUgPSBcImxcIiwgeGxhYiA9IFwicXVhcnRlclwiLCB5bGFiID0gXCJQcm9iIG9mIFplcm9cIikiLCJzb2x1dGlvbiI6ImxhbWJkYXZlYyA8LSBjKHJlcCgwLjEsNCksIHJlcCgwLjIsNCksIDAuMywgMC4zLCAwLjQsIDAuNSlcbkN5YmVyLmxhbWJkYSA8LSBzdW0obGFtYmRhdmVjKVxuXG5vdXRjb21lcyA8LSAwOjEyXG5DeWJlci5wbWYgPC0gZHBvaXMoeD1vdXRjb21lcywgbGFtYmRhPUN5YmVyLmxhbWJkYSlcbmJhcnBsb3QoQ3liZXIucG1mLCBuYW1lcy5hcmc9b3V0Y29tZXMsIGNvbD1cImxpZ2h0Z3JlZW5cIiwgeWxhYiA9IFwiUHJvYmFiaWxpdHlcIiwgeGxhYiA9IFwiQ3liZXIgRXZlbnRzXCIpXG5cbkN5YmVyLmRmIDwtIHBwb2lzKG91dGNvbWVzLCBsYW1iZGE9Q3liZXIubGFtYmRhKVxub3V0Y29tZWRhdGFmIDwtIHJiaW5kKG91dGNvbWVzLCBDeWJlci5wbWYsIEN5YmVyLmRmKVxub3V0Y29tZWRhdGFmIFxuXG5xcG9pcygwLjk1LCBsYW1iZGE9Q3liZXIubGFtYmRhKVxuXG5Qcm9iemVybyA8LSBkcG9pcyh4PTAsIGxhbWJkYT1sYW1iZGF2ZWMpXG5wbG90KDE6MTIsUHJvYnplcm8sIHR5cGUgPSBcImxcIiwgeGxhYiA9IFwicXVhcnRlclwiLCB5bGFiID0gXCJQcm9iIG9mIFplcm9cIikiLCJzY3QiOiJzdWNjZXNzX21zZyhcIkV4Y2VsbGVudCBqb2IhIFRoZSBQb2lzc29uIGlzIHRoZSBiYXNpYyBjb3VudCBkaXN0cmlidXRpb24gaW4gYWN0dWFyaWFsIGFwcGxpY2F0aW9ucy4gQ29uc3VtZXJzIG9mdGVuIGhhdmUgZmFtaWxpYXJpdHkgd2l0aCB0aGUgZXhwZWN0ZWQgbnVtYmVyIG9mIGV2ZW50cyBhcyB3ZWxsIGFzIHRoZSBwcm9iYWJpbGlsdHkgb2YgemVybyBldmVudHMuIEluIHRoZSBsYXN0IHBhcnQsIHlvdSBsZWFybmVkIGhvdyB0byBwb3J0cmF5IGluY3JlYXNpbmcgbWVhbnMgaW4gdGVybXMgb2YgZGVjcmVhc2luZyBmcmVxdWVuY3kgb2YgemVybyBldmVudHMsIGNvbm5lY3RpbmcgdGhlc2UgaW1wb3J0YW50IHN1bW1hcnkgbWVhc3VyZXMuXCIpIiwiaGludCI6IllvdSB3aWxsIGZpbmQgbW9yZSBkaXNjdXNzaW9uIG9mIHBlcmNlbnRpbGVzIGluIFNlY3Rpb24gNC4xIG9mIDxhIGhyZWY9XCJodHRwczovL29wZW5hY3R0ZXh0cy5naXRodWIuaW8vTG9zcy1EYXRhLUFuYWx5dGljcy9DLU1vZGVsU2VsZWN0aW9uLmh0bWwjUzpNUzpOb25QYXJJbmZcIj5Mb3NzIERhdGEgQW5hbHl0aWNzPC9hPi4ifQ== 2.1.3 Exercise. Comparing Basic Count Distributions Assignment Text Your supervisor would like to have a better understanding of relationships among three important count distributions, the binomial, Poisson, and negative binomial. You could develop a mathematical appendix, demonstrating how: A binomial distribution with parameters \\(m \\to \\infty\\) and \\(mq \\to \\lambda\\) converges to a Poisson distribution. A negative binomial distribution with mean parameter \\(r \\beta = \\lambda\\) and dispersion parameter \\(r\\) converges to a Poisson distribution as \\(r \\to \\infty\\). Instead, you decide to demonstrate these relationships graphically. Instructions Plot the probability mass function (pmf) of the binomial distribution with \\(m=12\\) and \\(q=0.1\\) over \\(k = 0, 1, \\ldots, 12\\) potential outcomes. Superimpose on this plot a Poisson pmf with the same mean using the lines() function. Repeat this step with the same Poisson distribution but, for the binomial distribution, multiply \\(m\\) by 5 and divide \\(q\\) by 5. (You should see how the binomial becomes a better approximation to the Poisson.) Determine the pmf of the negative binomial distribution with mean parameter \\(r \\beta\\) and dispersion parameter \\(r=1\\) using the function dnbinom(). Use the same mean as for the binomial distribution. Demonstrate the convergence of the negative binomial to the Poisson by creating side-by-side graphical comparisons. That is, using the par(mfrow = ) syntax, compare: A plot of this negative binomial distribution pmf, superimposed with baseline Poisson distribution (with the same mean). A plot of the negative binomial distribution pmf with the same mean and dispersion parameter \\(r=100\\), superimposed with baseline Poisson distribution. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJvdXRjb21lcyA8LSAwOjEyXG5cbkJpbm9tMS5wbWYgIDwtIGRiaW5vbSh4PW91dGNvbWVzLCBzaXplPTEyLCA/PykgIFxuUG9pc3Nvbi5wbWYgPC0gZHBvaXMoeD1vdXRjb21lcywgbGFtYmRhPTEuMilcbnBsb3Qob3V0Y29tZXMsID8/KVxubGluZXMob3V0Y29tZXMsID8/KVxuXG5CaW5vbTIucG1mIDwtIGRiaW5vbSh4PW91dGNvbWVzLCBzaXplPT8/LCBwcm9iPT8/KSBcbnBsb3Qob3V0Y29tZXMsIEJpbm9tMi5wbWYpXG5saW5lcyhvdXRjb21lcywgUG9pc3Nvbi5wbWYpXG5cbiggTmVnQmlub20xLnBtZiA8LSBkbmJpbm9tKG91dGNvbWVzLCBtdT0/PyBzaXplPT8/KSApXG5cbnBhcihtZnJvdyA9IGMoMSwyKSlcbnBsb3Qob3V0Y29tZXMsIE5lZ0Jpbm9tMS5wbWYpXG5saW5lcyhvdXRjb21lcywgUG9pc3Nvbi5wbWYpXG5OZWdCaW5vbTIucG1mIDwtIGRuYmlub20ob3V0Y29tZXMsIG11PT8/LCBzaXplPT8/KSAgIFxucGxvdChvdXRjb21lcywgTmVnQmlub20yLnBtZilcbmxpbmVzKG91dGNvbWVzLCBQb2lzc29uLnBtZikiLCJzb2x1dGlvbiI6Im91dGNvbWVzIDwtIDA6MTJcblxuQmlub20xLnBtZiAgPC0gZGJpbm9tKHg9b3V0Y29tZXMsIHNpemU9MTIsIHByb2I9MC4xKSAgXG5Qb2lzc29uLnBtZiA8LSBkcG9pcyh4PW91dGNvbWVzLCBsYW1iZGE9MS4yKVxucGxvdChvdXRjb21lcywgQmlub20xLnBtZilcbmxpbmVzKG91dGNvbWVzLCBQb2lzc29uLnBtZilcblxuQmlub20yLnBtZiA8LSBkYmlub20oeD1vdXRjb21lcywgc2l6ZT0xMio1LCBwcm9iPTAuMS81KSBcbnBsb3Qob3V0Y29tZXMsIEJpbm9tMi5wbWYpXG5saW5lcyhvdXRjb21lcywgUG9pc3Nvbi5wbWYpXG5cbiggTmVnQmlub20xLnBtZiA8LSBkbmJpbm9tKG91dGNvbWVzLCBtdT0xLjIsIHNpemU9MSkgKVxuXG5wYXIobWZyb3cgPSBjKDEsMikpXG5wbG90KG91dGNvbWVzLCBOZWdCaW5vbTEucG1mKVxubGluZXMob3V0Y29tZXMsIFBvaXNzb24ucG1mKVxuTmVnQmlub20yLnBtZiA8LSBkbmJpbm9tKG91dGNvbWVzLCBtdT0xLjIsIHNpemU9MTAwKSAgIFxucGxvdChvdXRjb21lcywgTmVnQmlub20yLnBtZilcbmxpbmVzKG91dGNvbWVzLCBQb2lzc29uLnBtZikiLCJzY3QiOiJzdWNjZXNzX21zZyhcIkV4Y2VsbGVudCBqb2IhIEFzIHlvdSBzdHVkeSBhY3R1YXJpYWwgZGF0YSBhcHBsaWNhdGlvbnMsIGRvIG5vdCBzaHkgYXdheSBmcm9tIHRoZSBtYXRoZW1hdGljcyEgT2Z0ZW4sIHRoZSBkaXNjaXBsaW5lIHVzZXMgdGhlIHJpZ29yIG9mIG1hdGhlbWF0aWNzIHRvIGNyeXN0YWxsaXplIGltcG9ydGFudCBpZGVhcy4gT25lIG9mIHlvdXIgam9icyBpcyB0byBiZSBhYmxlIHRvIGNvbW11bmljYXRlIHRoZXNlIGlkZWFzIHRvIGEgYnJvYWRlciBwdWJsaWMuIFlvdSB3aWxsIGZpbmQgdGhhdCBncmFwaGljYWwgcHJlc2VudGF0aW9ucyBhcmUgaGVscGZ1bCBpbiB0aGlzIHJlZ2FyZC5cIikiLCJoaW50IjoiVG8gcmV2aWV3IHRoZSBuZWdhdGl2ZSBiaW5vbWlhbCBkaXN0cmlidXRpb24sIHNlZSA8YSBocmVmPVwiaHR0cHM6Ly9ld2ZyZWVzLmdpdGh1Yi5pby9Mb3NzLURhdGEtQW5hbHl0aWNzL0MtU3VtbWFyeURpc3RyaWJ1dGlvbnMuaHRtbCNTOkRpc2NyZXRlRGlzdHJpYnV0aW9uc1wiPkRpc2NyZXRlIERpc3RyaWJ1dGlvbnM8L2E+In0= 2.2 The (a,b,0) Class 2.2.1 Exercise. Determining Probabilities Recursively Assignment Text The \\((a,b,0)\\) class can be expressed through the recursion \\[ \\Pr(N=k) = p_k = p_{k-1} \\left( a+ \\frac{b}{k}\\right) , \\quad k\\ge 1 . \\] where \\(N\\) is a count random variable. From Section 2.3 of the text, we know that: if \\(a=0\\) and \\(b=\\lambda\\), then the recursion yields a Poisson distribution with parameter \\(\\lambda\\) if \\(a=-q/(1-q)\\) and \\(b=(m+1)q/(1+q)\\), then the recursion yields a binomial distribution with parameters \\(m\\) and \\(q\\) if \\(a=\\beta/(1+\\beta)\\) and \\(b=(r-1)\\beta/(1+\\beta)\\), then the recursion yields a negative distribution with parameters \\(r\\) and \\(\\beta\\). The \\((a,b,0)\\) class is a foundation for other, more complex, distributions, so let us check that we understand the recursions. Instructions For \\(k=0, \\ldots, 20\\), using \\(\\lambda = 1.24\\) obtain \\(p_k\\) values using dpois(). With the starting value \\(p_0 = \\exp(\\lambda)\\), use the recursive \\((a,b,0)\\) formula to obtain these probability values. Check your code by summing over the absolute value of the differences between the dpois and the \\((a,b,0)\\) generated values. For \\(k=0, \\ldots, 20\\), obtain \\(p_k\\) values using the negative binomial distribution using the function dnbinom(). Use the same mean as for the Poisson distribution but let the variance be 1.1 times the mean. Hint. See the Loss Data Analytics Summary of Distributions for the parameterization used in this short course. It differs from that used by the R package. Use the recursive \\((a,b,0)\\) formula to obtain these probability values. Check your code by summing over the absolute value of the differences between the dnbinom and the \\((a,b,0)\\) generated values. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6IiMgTm9uZSBOZWVkZWQgZm9yIHRoaXMgRXhlcmNpc2UiLCJzYW1wbGUiOiJrdmVjIDwtIGMoMDo/PykgXG5Qb2lzc29uLnBfayA8LSBkcG9pcyh4PWt2ZWMsIGxhbWJkYT0/PykgXG5hID0gPz8gXG5iID0gPz9cbmEuYi4wLnZlYyA8LSAgZXhwKC0xLjI0KSAtPiBwLm5ld1xuZm9yIChrIGluIDI6MjEpe1xuICBwLm5ldyA8LSBwLm5ldyAqKGErYi8oay0xKSlcbiAgYS5iLjAudmVjIDwtIGFwcGVuZChhLmIuMC52ZWMscC5uZXcpXG4gIH1cbnN1bShhYnMoUG9pc3Nvbi5wX2sgLSA/PykpXG5cbk5lZ0Jpbm9tLnBfayA8LSBkbmJpbm9tKGt2ZWMsIHByb2I9MS8xLjEsIHNpemUgPSAxMi40KVxuYSA9ID8/IFxuYiA9ID8/XG5hLmIuMC52ZWMgPC0gIDEuMSoqKC0xMi40KSAtPiBwLm5ld1xuZm9yIChrIGluID8/KXtcbiAgcC5uZXcgPC0gcC5uZXcgKihhK2IvKGstMSkpXG4gIGEuYi4wLnZlYyA8LSBhcHBlbmQoYS5iLjAudmVjLHAubmV3KVxuICB9XG5zdW0oYWJzKE5lZ0Jpbm9tLnBfayAtID8/KSkiLCJzb2x1dGlvbiI6Imt2ZWMgPC0gYygwOjIwKSBcblBvaXNzb24ucF9rIDwtIGRwb2lzKHg9a3ZlYywgbGFtYmRhPTEuMjQpIFxuYSA9IDA7IFxuYiA9IDEuMjRcbmEuYi4wLnZlYyA8LSAgZXhwKC0xLjI0KSAtPiBwLm5ld1xuZm9yIChrIGluIDI6MjEpe1xuICBwLm5ldyA8LSBwLm5ldyAqKGErYi8oay0xKSlcbiAgYS5iLjAudmVjIDwtIGFwcGVuZChhLmIuMC52ZWMscC5uZXcpXG4gIH1cbnN1bShhYnMoUG9pc3Nvbi5wX2sgLSBhLmIuMC52ZWMpKVxuXG5OZWdCaW5vbS5wX2sgPC0gZG5iaW5vbShrdmVjLCBwcm9iPTEvMS4xLCBzaXplID0gMTIuNClcbmEgPSAuMS8xLjE7IFxuYiA9IDExLjQqKDAuMSkvMS4xXG5hLmIuMC52ZWMgPC0gIDEuMSoqKC0xMi40KSAtPiBwLm5ld1xuZm9yIChrIGluIDI6MjEpe1xuICBwLm5ldyA8LSBwLm5ldyAqKGErYi8oay0xKSlcbiAgYS5iLjAudmVjIDwtIGFwcGVuZChhLmIuMC52ZWMscC5uZXcpXG4gIH1cbnN1bShhYnMoTmVnQmlub20ucF9rIC0gYS5iLjAudmVjKSkiLCJzY3QiOiJzdWNjZXNzX21zZyhcIkV4Y2VsbGVudCBqb2IhIEJlaW5nIGFibGUgdG8gZG8gY2FsY3VsYXRpb25zIHJlY3Vyc2l2ZWx5LCBzdWNoIGFzIHVzaW5nIGZvciBsb29wcywgaXMgYW4gaW1wb3J0YW50IGZvciBhY3R1YXJpYWwgbW9kZWxzLlwiKSIsImhpbnQiOiJUaGVyZSBhcmUgc2V2ZXJhbCB3YXlzIHRvIGRvIHJlY3Vyc2lvbnMgaW4gPGNvZGU+UjwvY29kZT4sIHlvdSBtaWdodCBzdGFydCB3aXRoIGEgc2ltcGxlIDxhIGhyZWY9XCJodHRwczovL3d3dy5yZG9jdW1lbnRhdGlvbi5vcmcvcGFja2FnZXMvYmFzZS92ZXJzaW9ucy8zLjYuMi90b3BpY3MvQ29udHJvbFwiPmZvcigpPC9hPiBleHByZXNzaW9uLiJ9 2.2.2 Exercise. Reverse Engineering and Recursive R Functions Assignment Text You want to generate probabilities from the \\((a,b,0)\\) class so that later on you will be able to modify your code to produce alternative distributions (the subject of Section 2.5), a bit of so-called reverse engineering. In the first part of this problem, from a known distribution (e.g., the binomial), you will compute the ratio \\[ \\frac{k ~p_k}{p_{k-1}} = a k + b , \\quad k\\ge 1 , \\] to determine values of \\(a\\) and \\(b\\). The second part of this problem utilizes recursive R functions. This is a function defined in terms of the same function but at a prior iteration. The classic example is the factorial function \\(f(n) = n!\\) so \\(f(n) = n f(n-1)\\). For example, you can define the function recursive.factorial &lt;- function(n) { if (n == 0) return (1) else return (n * recursive.factorial(n-1)) } to determine that recursive.factorial(5) = 120. In this problem, we use a recursive R function to generate \\((a,b,0)\\) probabilities. Instructions For \\(k=0, \\ldots, 4\\), using \\(\\lambda = 1.24\\) obtain \\(p_k\\) values from the dpois() function. Compute the ratio to identify values of \\(a\\) and \\(b\\). Hint: In R, use of negative indexing is permitted. For example, pop[-c(3, 7)] removes the third and seventh elements of pop. For \\(k=0, \\ldots, 4\\), using \\(q =0.1\\) and \\(m=10\\) obtain \\(p_k\\) values from the dbinom() function. Compute the ratio to identify values of \\(a\\) and \\(b\\). To check your work, develop the recursive \\((a,b,0)\\) function to determine \\(p_4 = \\Pr(N=4)\\) based on the binomial distribution in the prior part. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6IiMgTm9uZSBOZWVkZWQgZm9yIHRoaXMgRXhlcmNpc2UiLCJzYW1wbGUiOiJrdmVjIDwtIGMoMDo0KSAgXG5Qb2lzc29uLnBfayA8LSBkcG9pcyh4PWt2ZWMsIGxhbWJkYT0xLjI0KSBcbmt2ZWNbPz9dICogUG9pc3Nvbi5wX2tbPz8vUG9pc3Nvbi5wX2tbLWxlbmd0aChrdmVjKV1cblxuQmlub20ucF9rIDwtIGRiaW5vbSh4PWt2ZWMsIHByb2IgPSAwLjEsIHNpemUgPSAxMCkgXG5vdXR2ZWMgPC0ga3ZlY1s/PyAqIEJpbm9tLnBfa1s/P10vQmlub20ucF9rWy1sZW5ndGgoa3ZlYyldXG4oIGEgPSA/PyAtID8/IClcbiggYiA9ID8/IC0gYSApXG5cbiMgUmVjdXJzaXZlIGZ1bmN0aW9uIHRvIGZpbmQgZmFjdG9yaWFsXG5yZWN1cnNpdmUuYS5iLjAgPC0gZnVuY3Rpb24oaykge1xuICBpZiAoayA9PSAwKSAgcmV0dXJuICggQmlub20ucF9rWzFdIClcbiAgZWxzZSAgICAgICAgIHJldHVybiAoIChhK2IvaykgKiByZWN1cnNpdmUuYS5iLjAoay0xKSApXG4gIH1cbnJlY3Vyc2l2ZS5hLmIuMCg/PylcbkJpbm9tLnBfa1s/P10iLCJzb2x1dGlvbiI6Imt2ZWMgPC0gYygwOjQpICBcblBvaXNzb24ucF9rIDwtIGRwb2lzKHg9a3ZlYywgbGFtYmRhPTEuMjQpIFxua3ZlY1stMV0gKiBQb2lzc29uLnBfa1stMV0vUG9pc3Nvbi5wX2tbLWxlbmd0aChrdmVjKV1cblxuQmlub20ucF9rIDwtIGRiaW5vbSh4PWt2ZWMsIHByb2IgPSAwLjEsIHNpemUgPSAxMCkgXG5vdXR2ZWMgPC0ga3ZlY1stMV0gKiBCaW5vbS5wX2tbLTFdL0Jpbm9tLnBfa1stbGVuZ3RoKGt2ZWMpXVxuKCBhID0gb3V0dmVjWzJdIC0gb3V0dmVjWzFdIClcbiggYiA9IG91dHZlY1sxXSAtIGEgKVxuXG4jIFJlY3Vyc2l2ZSBmdW5jdGlvbiB0byBmaW5kIGZhY3RvcmlhbFxucmVjdXJzaXZlLmEuYi4wIDwtIGZ1bmN0aW9uKGspIHtcbiAgaWYgKGsgPT0gMCkgIHJldHVybiAoIEJpbm9tLnBfa1sxXSApXG4gIGVsc2UgICAgICAgICByZXR1cm4gKCAoYStiL2spICogcmVjdXJzaXZlLmEuYi4wKGstMSkgKVxuICB9XG5yZWN1cnNpdmUuYS5iLjAoNClcbkJpbm9tLnBfa1s1XSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiU3VwZXJiISBXb3JraW5nIGZvcndhcmRzIGFuZCBiYWNrd2FyZHMgaXMgaW1wb3J0YW50IGluIGNvbXBsZXggdGFza3MuIFRoZSBpZGVhIG9mICdyZXZlcnNlIGVuZ2luZWVyaW5nJyBpcyBjb21tb24gaW4gY29tcGxleCBidXNpbmVzcyBzZXR0aW5ncy4gXCIpIiwiaGludCI6IllvdSBtaWdodCB3aXNoIHRvIGxlYXJuIG1vcmUgYWJvdXQgPGEgaHJlZj1cImh0dHBzOi8vd3d3LmRhdGFtZW50b3IuaW8vci1wcm9ncmFtbWluZy9yZWN1cnNpb24vXCI+UiByZWN1cnNpdmUgZnVuY3Rpb25zPC9hPiJ9 2.3 Mixture Distributions 2.3.1 Exercise. Mixtures of Workers Compensation Claims Assignment Text You are analyzing a set of workers compensation claims (claims that pay in the event of injury at a work-place) and focus on the frequency portion. Suppose that it is known that if claims arise from a low-risk class, such as accountants and actuaries working within four walls, that the number of claims follows a Poisson distribution with parameter \\(\\lambda=4\\). However, if claims arise from a high-risk class, such as roofers and lumberjacks, then the number follows a negative binomial distribution with parameters \\(r=4\\) and \\(\\beta=3\\). For a particular firm, you do not know whether it is low or high risk but you do know that probability of being low-risk is \\(\\alpha=0.6\\). In this exercise, we will compare the shape of the mixture distribution to the low and high risk distributions. Instructions Determine the probability mass functions for the low and risk populations for \\(k=0, \\ldots, 20\\) possible claim outcoms. Compute the corresponding probability mass function for the mixture distribution Plot the mixture distribution with superimposed lines for the low and high risk populations. Use different colors and plotting symbols for the three distributions to help viewers distinguish among them. Determine distribution functions for the low, high, and mixture distributions. Plot the mixture distribution function with superimposed lines for the low and high risk populations. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJhbHBoYSA8LSAwLjY7IGxhbWJkYSA8LSA/PyAgXG5yIDwtIDQ7ICAgICAgIGJldGEgPC0gPz8gXG5rdmVjIDwtIDA6MjBcblxubG93cmlzayA8LSBkcG9pcyhrdmVjLCBsYW1iZGE9bGFtYmRhKVxuaGlnaHJpc2sgPC0gZG5iaW5vbShrdmVjLCBwcm9iPT8/ICwgc2l6ZSA9ID8/IClcbnBvcHJpc2sgPC0gPz8gXG5cbnBsb3Qoa3ZlYywgcG9wcmlzaywgeWxpbSA9IGMoMCwgLjIpLCB4bGFiID0gXCJOdW1iZXIgb2YgQ2xhaW1zXCIsIHlsYWIgPSBcIlByb2JhYmlsaXR5XCIsIHR5cGUgPSBcImJcIiwgcGNoID0gMTkpXG5saW5lcyhrdmVjLCBsb3dyaXNrLCBjb2wgPSBcImJsdWVcIiwgdHlwZSA9IFwiYlwiKVxubGluZXMoa3ZlYywgaGlnaHJpc2ssIGNvbCA9IFwicmVkXCIsIHR5cGUgPSBcImJcIiwgcGNoID0gMjMpXG5cbmxvd3Jpc2sucCA8LSBwcG9pcyhrdmVjLCBsYW1iZGE9bGFtYmRhKVxuaGlnaHJpc2sucCA8LSBwbmJpbm9tKGt2ZWMsIHByb2I9Pz8gLCBzaXplID0gPz8gKVxucG9wcmlzay5wIDwtID8/IFxuXG5wbG90KGt2ZWMsIHBvcHJpc2sucCwgeWxpbSA9IGMoMCwgMSksIHhsYWIgPSBcIk51bWJlciBvZiBDbGFpbXNcIiwgeWxhYiA9IFwiRGlzdHJpYnV0aW9uIEZ1bmN0aW9uXCIsIHR5cGUgPSBcImJcIiwgcGNoID0gMTkpXG5saW5lcyhrdmVjLCBsb3dyaXNrLnAsIGNvbCA9IFwiYmx1ZVwiLCB0eXBlID0gXCJiXCIpXG5saW5lcyhrdmVjLCBoaWdocmlzay5wLCBjb2wgPSBcInJlZFwiLCB0eXBlID0gXCJiXCIsIHBjaCA9IDIzKSIsInNvbHV0aW9uIjoiYWxwaGEgPC0gMC42OyBsYW1iZGEgPC0gNDsgXG5yIDwtIDQ7ICAgICAgIGJldGEgPC0gM1xua3ZlYyA8LSAwOjIwXG5cbmxvd3Jpc2sgPC0gZHBvaXMoa3ZlYywgbGFtYmRhPWxhbWJkYSlcbmhpZ2hyaXNrIDwtIGRuYmlub20oa3ZlYywgcHJvYj0xLygxK2JldGEpLCBzaXplID0gcilcbnBvcHJpc2sgPC0gYWxwaGEqbG93cmlzayArICgxLWFscGhhKSpoaWdocmlza1xuXG5wbG90KGt2ZWMsIHBvcHJpc2ssIHlsaW0gPSBjKDAsIC4yKSwgeGxhYiA9IFwiTnVtYmVyIG9mIENsYWltc1wiLCB5bGFiID0gXCJQcm9iYWJpbGl0eVwiLCB0eXBlID0gXCJiXCIsIHBjaCA9IDE5KVxubGluZXMoa3ZlYywgbG93cmlzaywgY29sID0gXCJibHVlXCIsIHR5cGUgPSBcImJcIilcbmxpbmVzKGt2ZWMsIGhpZ2hyaXNrLCBjb2wgPSBcInJlZFwiLCB0eXBlID0gXCJiXCIsIHBjaCA9IDIzKVxuXG5sb3dyaXNrLnAgPC0gcHBvaXMoa3ZlYywgbGFtYmRhPWxhbWJkYSlcbmhpZ2hyaXNrLnAgPC0gcG5iaW5vbShrdmVjLCBwcm9iPTEvKDErYmV0YSksIHNpemUgPSByKVxucG9wcmlzay5wIDwtIGFscGhhKmxvd3Jpc2sucCArICgxLWFscGhhKSpoaWdocmlzay5wXG5cbnBsb3Qoa3ZlYywgcG9wcmlzay5wLCB5bGltID0gYygwLCAxKSwgeGxhYiA9IFwiTnVtYmVyIG9mIENsYWltc1wiLCB5bGFiID0gXCJEaXN0cmlidXRpb24gRnVuY3Rpb25cIiwgdHlwZSA9IFwiYlwiLCBwY2ggPSAxOSlcbmxpbmVzKGt2ZWMsIGxvd3Jpc2sucCwgY29sID0gXCJibHVlXCIsIHR5cGUgPSBcImJcIilcbmxpbmVzKGt2ZWMsIGhpZ2hyaXNrLnAsIGNvbCA9IFwicmVkXCIsIHR5cGUgPSBcImJcIiwgcGNoID0gMjMpIiwic2N0Ijoic3VjY2Vzc19tc2coXCJTdXBlcmIhIERldGVybWluaW5nIG1peHR1cmUgZGlzdHJpYnV0aW9ucyBhcmUgdXN1YWxseSBkaWZmaWN1bHQgdG8gZG8gYnkgaGFuZCBidXQgYXJlIHN0cmFpZ2h0Zm9yd2FyZCB3aXRoIGNvbXB1dGF0aW9uYWwgdG9vbHMgc3VjaCBhcyAnUicuIEluc3VyYW5jZSBhbmFseXN0cyBjb250aW51YWxseSBmcmV0IGFib3V0IHVub2JzZXJ2ZWQgY2hhcmFjdGVyaXN0aWNzIChzdWNoIGFzIGxvdyB2ZXJzdXMgaGlnaCByaXNrKSBhbmQgbWl4dHVyZSBkaXN0cmlidXRpb25zIGlzIGEgdG9vbCBvZnRlbiB1c2VkIHRvIGhlbHAgcXVhbnRpZnkgdGhlc2UgdW5vYnNlcnZlZCBwaWVjZXMgb2YgaW5mb3JtYXRpb24uIFwiKSIsImhpbnQiOiJTZWUgdGhlIDxhIGhyZWY9XCJodHRwczovL29wZW5hY3R0ZXh0cy5naXRodWIuaW8vTG9zcy1EYXRhLUFuYWx5dGljcy9DLVN1bW1hcnlEaXN0cmlidXRpb25zLmh0bWwjZGlzY3JldGUtZGlzdHJpYnV0aW9uc1wiPmFwcGVuZGl4IG9mIHRoZSBMb3NzIERhdGEgQW5hbHl0aWNzPC9hPiBcbiAgIGZvciBjb2RlIG9uIHVzaW5nIHBhcmFtZXRlcnMgaW4gUi4ifQ== 2.3.2 Exercise. Finite Number of Mixture Distributions Assignment Text The following describes a classic actuarial exam problem. We use this problem to motivate an introduction of more complex techniques for calculating mixture distributions; unlike classic exam problems designed for hand calculations, these techniques can readily be extended to a large number of unobserved sub-populations. In a certain town the number of common colds an individual will get in a year follows a Poisson distribution that depends on the individuals age and smoking status: \\[ {\\small \\begin{array}{l|cc} \\hline &amp; \\text{Proportion of population} &amp; \\text{Mean number of colds} \\\\ \\hline \\text{Children} &amp; 0.3 &amp; 3 \\\\ \\text{Adult Non-Smokers} &amp; 0.6 &amp; 1 \\\\ \\text{Adult Smokers} &amp; 0.1 &amp; 4 \\\\\\hline \\end{array} } \\] In this exercise, we will use R to calculate the probabilities that a randomly drawn person has a cold in a year. Instructions Create a vector of proportions \\(\\alpha\\) and a vector of Poisson parameters \\(\\lambda\\). Use the function dpois() to obtain a vector of Poisson probability mass function (pmf) with different means for \\(k=3\\) colds. Then, use the matrix operation %*% to obtain the mixture pmf as the inner product of the two vectors containing the Poisson pmfs and population percentages. In the same way, use the ppois() function to compute the probability of at most 3 colds within a year. Now, consider \\(k=0, \\ldots, 8\\) colds during a year. For each value of \\(k\\), determine the probability of \\(k\\) colds within a year. Provide a barplot() of the distribution of number of colds during a year over the range \\(k=0, \\ldots, 8\\). eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJhbHBoYSA8LSBjKDAuMywgMC42LCAwLjEpXG5sYW1iZGEudmVjPC0gPz9cblxuIyBQcm9iYWJpbGl0eSBvZiBoYXZpbmcgMyBjb21tb24gY29sZHMgaW4gYSB5ZWFyXG5ieXJpc2sgPC0gZHBvaXMoPz8sIGxhbWJkYT1sYW1iZGEudmVjKVxuYnlyaXNrICAlKiUgYWxwaGFcblxuIyBQcm9iYWJpbGl0eSBvZiBhdCBtb3N0IDMgY29tbW9uIGNvbGRzIGluIGEgeWVhclxucHBvaXMocT0zLCBsYW1iZGE9bGFtYmRhLnZlYykgJSolID8/XG5cbmt2ZWMgPSAwOjhcbnByb2JzID0gcmVwKDAsbGVuZ3RoKGt2ZWMpKVxuZm9yIChpbmRleCBpbiBrdmVjKSB7cHJvYnNbaW5kZXgrMV0gPSA/PyhpbmRleCwgbGFtYmRhPWxhbWJkYS52ZWMpICUqJSBhbHBoYX1cblxuYmFycGxvdChwcm9icywgeGxhYiA9IFwiTnVtYmVyIG9mIENsYWltc1wiLCBuYW1lcy5hcmcgPSBrdmVjKSIsInNvbHV0aW9uIjoiYWxwaGEgPC0gYygwLjMsIDAuNiwgMC4xKVxubGFtYmRhLnZlYzwtIGMoMywgMSwgNClcbmJ5cmlzayA8LSBkcG9pcygzLCBsYW1iZGE9bGFtYmRhLnZlYylcbiMgUHJvYmFiaWxpdHkgb2YgaGF2aW5nIDMgY29tbW9uIGNvbGRzIGluIGEgeWVhclxuYnlyaXNrICAlKiUgYWxwaGFcblxuIyBQcm9iYWJpbGl0eSBvZiBhdCBtb3N0IDMgY29tbW9uIGNvbGRzIGluIGEgeWVhclxucHBvaXMocT0zLCBsYW1iZGE9bGFtYmRhLnZlYykgJSolIGFscGhhXG5cbmt2ZWMgPSAwOjhcbnByb2JzID0gcmVwKDAsbGVuZ3RoKGt2ZWMpKVxuZm9yIChpbmRleCBpbiBrdmVjKSB7cHJvYnNbaW5kZXgrMV0gPSAgZHBvaXMoaW5kZXgsIGxhbWJkYT1sYW1iZGEudmVjKSAlKiUgYWxwaGF9XG5cbmJhcnBsb3QocHJvYnMsIHhsYWIgPSBcIk51bWJlciBvZiBDbGFpbXNcIiwgbmFtZXMuYXJnID0ga3ZlYykiLCJzY3QiOiJzdWNjZXNzX21zZyhcIlN1cGVyYiEgVGhpcyBleGVyY2lzZSBleHBsaWNpdGx5IGluY2x1ZGVzIG9ubHkgdGhyZWUgc3ViLXBvcGx1YXRpb25zIGJ1dCBob3BlZnVsbHkgaXQgaXMgYXBwYXJlbnQgaG93IGl0IGNvdWxkIGJlIGV4dGVuZGVkIHRvIGEgbGFyZ2UgbnVtYmVyIG9mIHN1Yi1wb3BsdWF0aW9ucy4gSW4gdGhlIG5leHQgZXhlcmNpc2UsIHdlIGNvbnNpZGVyIGFuIGluZmluaXRlIG51bWJlciFcIikiLCJoaW50IjoiVGFrZSBzb21lIHRpbWUgdG8gZXhwbG9yZSB0aGUgb25saW5lIDxjb2RlPlI8L2NvZGU+IGRvY3VtZW50YXRpb24uIn0= 2.3.3 Exercise. Gamma Mixture of Poissons Assignment Text For a population, suppose that each risk has a Poisson number of claims with a parameter \\(\\lambda\\) that is specific to that risk (an infinite number of risk classes). We can think of the risk parameter as following a distribution and so is itself random, denoted as a capital \\(\\Lambda\\). A mathematically convenient assumption is to assume that the risk parameter follows a gamma distribution. That is, as we have learned from the text, a gamma mixture of Poissons turns out to have a negative binomial distribution. More precisely, if \\(N|\\Lambda \\sim\\) Poisson\\((\\Lambda)\\) and \\(\\Lambda \\sim\\) gamma\\((\\alpha, \\theta)\\), then \\(N \\sim \\text{Negative Binomial}\\) \\((r = \\alpha, \\beta = \\theta)\\). For example, one can determine the probability mass function of \\(N\\) as \\[ \\Pr(N=k) = \\int^{\\infty}_0 e^{-\\lambda} \\frac{\\lambda^k}{k!} ~ g(\\lambda;\\alpha, \\beta = \\theta )~ d \\lambda, \\] where \\(g(\\cdot;\\alpha, \\beta = \\theta )\\) is a gamma density. The proof of this result is in the text; here, we check it using R, in the special case of \\(k=3\\), \\(\\alpha =3\\), and \\(\\theta = 4\\). Instructions Establish the parameter values for \\(\\alpha =3\\) and \\(\\theta = 4\\). Express the conditional Poisson mass function as a function of the parameter \\(\\lambda\\) (not the number of outcomes \\(k\\)) (called lambda.arg for the lambda argument in the following sample code). Express the product of the conditional Poisson mass function and the gamma density as a function of \\(\\lambda\\). integrate() this product over values of \\(\\lambda\\). Check the result by using the negative binomial probability mass function. Repeat this process using distribution functions in lieu of probability mass functions. Specifically, express the product of the conditional Poisson distribution function and the gamma density as a function of \\(\\lambda\\). Integrate this and check the result using the negative binomial distribution function. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJhbHBoYSA9ID8/OyAgICAgdGhldGEgPSA/P1xuXG5wZGZQb2lzc29uIDwtIGZ1bmN0aW9uKGxhbWJkYS5hcmcpe2Rwb2lzKDMsIGxhbWJkYT1sYW1iZGEuYXJnKX1cbnBkZmdhbVBvaSA8LSBmdW5jdGlvbihsYW1iZGEuYXJnKXtkZ2FtbWEobGFtYmRhLmFyZywgc2hhcGUgPSBhbHBoYSwgc2NhbGUgPSB0aGV0YSkqcGRmUG9pc3NvbihsYW1iZGEuYXJnKX1cbmludGVncmF0ZShwZGZnYW1Qb2ksIGxvd2VyID0gMCwgdXBwZXIgPSBJbmYpJHZhbHVlIFxuXG5kbmJpbm9tKDMsIHByb2I9MS8oMSt0aGV0YSksIHNpemUgPSBhbHBoYSlcblxucGRmZ2FtUG9pLnAgPC0gZnVuY3Rpb24obGFtYmRhLmFyZyl7ZGdhbW1hKD8/LCBzaGFwZSA9IGFscGhhLCBzY2FsZSA9IHRoZXRhKSpwcG9pcygzLCBsYW1iZGE9Pz8pfVxuaW50ZWdyYXRlKHBkZmdhbVBvaS5wLCBsb3dlciA9IDAsIHVwcGVyID0gPz8pJHZhbHVlIFxuXG5wbmJpbm9tKD8/LCBwcm9iPT8/LCBzaXplID0gPz8pIiwic29sdXRpb24iOiJhbHBoYSA9IDNcbnRoZXRhID0gNFxuXG5wZGZQb2lzc29uIDwtIGZ1bmN0aW9uKGxhbWJkYS5hcmcpe2Rwb2lzKDMsIGxhbWJkYT1sYW1iZGEuYXJnKX1cbnBkZmdhbVBvaSA8LSBmdW5jdGlvbihsYW1iZGEuYXJnKXtkZ2FtbWEobGFtYmRhLmFyZywgc2hhcGUgPSBhbHBoYSwgc2NhbGUgPSB0aGV0YSkqcGRmUG9pc3NvbihsYW1iZGEuYXJnKX1cbmludGVncmF0ZShwZGZnYW1Qb2ksIGxvd2VyID0gMCwgdXBwZXIgPSBJbmYpJHZhbHVlIFxuXG5kbmJpbm9tKDMsIHByb2I9MS8oMSt0aGV0YSksIHNpemUgPSBhbHBoYSlcblxucGRmZ2FtUG9pLnAgPC0gZnVuY3Rpb24obGFtYmRhLmFyZyl7ZGdhbW1hKGxhbWJkYS5hcmcsIHNoYXBlID0gYWxwaGEsIHNjYWxlID0gdGhldGEpKnBwb2lzKDMsIGxhbWJkYT1sYW1iZGEuYXJnKX1cbmludGVncmF0ZShwZGZnYW1Qb2kucCwgbG93ZXIgPSAwLCB1cHBlciA9IEluZikkdmFsdWUgXG5cbnBuYmlub20oMywgcHJvYj0xLygxK3RoZXRhKSwgc2l6ZSA9IGFscGhhKSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiRXhjZWxsZW50ISBBbiBpbXBvcnRhbnQgc3RyZW5ndGggb2YgdGhpcyBjb21wdXRhdGlvbmFsIGFwcHJvYWNoIChhcyB3ZSB3aWxsIHNlZSBtb3JlIGluIHRoZSBCYXllc2lhbiBzZWN0aW9uKSBpcyB0aGF0IHdlIG5vIGxvbmdlciBhcmUgbGltaXRlZCB0byBzaW1wbHkgZ2FtbWEgbWl4aW5nIGRpc3RyaWJ1dGlvbnMuIEdhbW1hcyBhcmUgdGVycmlmaWMgZm9yIGdldHRpbmcgY2xvc2VkIGZvcm0gbmVnYXRpdmUgYmlub21pYWwgZGlzdHJpYnV0aW9ucyBidXQsIGlmIHdlIG9ubHkgd2FudCBudW1lcmljYWwgcmVzdWx0cywgd2UgaGF2ZSBtYW55IG1vcmUgY2hvaWNlcy5cIikiLCJoaW50IjoiRm9yIHRoZSBsYXN0IHBhcnQgb2YgdGhpcyBwcm9ibGVtLCBpdCBpcyBlYXN5IHRvIGdldCBjb25mdXNlZCBhYm91dCB3aGljaCBpcyBhIGRmIGFuZCB3aGljaCBpcyBhIHBtZiAob3IgcGRmKS4gUmVtZW1iZXIsIHdlIGFyZSBpbnRlZ3JhdGluZyBvdmVyIGRpZmZlcmVudCB2YWx1ZXMgb2YgbGFtYmRhIGFuZCB0aGlzIGRpc3RyaWJ1dGlvbiBpcyBkZXRlcm1pbmVkIGJ5IHRoZSBnYW1tYSBwcm9jZXNzLiBTbywgdGhlIGdhbW1hIHN0YXlzIGFzIGEgcGRmLiJ9 "],["modeling-loss-severity.html", "Chapter 3 Modeling Loss Severity 3.1 Basic Distributional Quantites 3.2 Continuous Distributions 3.3 Methods of Creating New Distributions 3.4 Coverage Modifications 3.5 Maximum Likelihood Estimation", " Chapter 3 Modeling Loss Severity Draft - Chapter Not Yet Complete Chapter description. The traditional loss distribution approach to modeling aggregate losses starts by separately fitting a frequency distribution to the number of losses and a severity distribution to the size of losses. The estimated aggregate loss distribution combines the loss frequency distribution and the loss severity distribution by convolution. Discrete distributions often referred to as counting or frequency distributions were used in Chapter 2 to describe the number of events such as number of accidents to the driver or number of claims to the insurer. Lifetimes, asset values, losses and claim sizes are usually modeled as continuous random variables and as such are modeled using continuous distributions, often referred to as loss or severity distributions. A mixture distribution is a weighted combination of simpler distributions that is used to model phenomenon investigated in a heterogeneous population, such as modeling more than one type of claims in liability insurance (small frequent claims and large relatively rare claims). In this chapter we explore the use of continuous as well as mixture distributions to model the random size of loss. Although not needed to go through the tutorials, some users may wish to download the overheads used in the videos. Download Chapter Three overheads as a .pdf file. By watching the videos and working through the tutorial exercises, you will get an appreciation for distributions used to model the severity of losses. For a deeper dive, see the corresponding chapter in the textbook, Chapter Three of Loss Data Analytics. 3.1 Basic Distributional Quantites In this section, you learn how to work with some basic distributional quantities: moments, percentiles, and generating functions. 3.1.1 Exercise. Moments Can Be Misleading Assignment Text Anscombes quartet is comprised of four datasets with interesting properties related to their moments. You can access the data via data(anscombe). The four data sets are in the variables y1, y2, y3 and y4. There are also associated x values that create interesting properties for regression models fit to the data. Well ignore the x values in this section but will use them to develop the plots below. Instructions Extract the values y1, y2, y3 and y4 from the anscombe data frame. You will want to extract these as vectors not as single-column data frames. Use summary to understand the basic distributional properties of y1, y2, y3 and y4. Use mean to calculate the first raw moment of y1, y2, y3 and y4. Assign the values to y_means. Use var to calculate the second raw moment of y1, y2, y3 and y4. You should note that the the var function uses \\(n-1\\) in the denominator to return an estimate of the population variance from the sample. Do you notice anything interesting about the results? Use sd to calculate the standard deviation of y1, y2, y3 and y4. As with the var function,sd` also uses \\(n-1\\) in the denominator. There is no base-R function to calculate the coefficient of skewness. There are several approaches to calculate skewness if you explore the help for the type argument of the skewness function from the e1071 package. We will note use this package, but instead we will we calculate the equivalent of type = 3 skewness using var in the denominator. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImRhdGEoXCJhbnNjb21iZVwiKVxuaW5zdGFsbC5wYWNrYWdlcygnbW9tZW50cycpXG5saWJyYXJ5KG1vbWVudHMpIiwic2FtcGxlIjoiI1N1bW1hcnkgb2YgRGF0YVxuc3VtbWFyeShhbnNjb21iZSR5MSkgI0V4YW1wbGUgZm9yIHRoZSBmaXJzdCBkYXRhIHNldCBpbiAgQW5zY29tYmUncyBxdWFydGV0XG5zdW1tYXJ5KGFuc2NvbWJlJD8/KVxuc3VtbWFyeShhbnNjb21iZSQ/PylcbnN1bW1hcnkoYW5zY29tYmUkPz8pXG5cbiNWZWN0b3Igb2YgbWVhbnNcbmMobWVhbihhbnNjb21iZSR5MSksIG1lYW4oPz8pLCBtZWFuKD8/KSwgbWVhbig/PykpXG5cbiNWZWN0b3Igb2YgdmFyaWFuY2VzXG5jKHZhcihhbnNjb21iZSR5MSksIHZhcig/PyksIHZhcig/PyksIHZhcig/PykpXG5cbiNTa2V3YmVzcyBpZiB5MVxueTFfc2tldyA8LSBtZWFuKCg/PyAtIG1lYW4oPz8pKV4/PykgLyBzZCg/PykgXiA/PyIsInNvbHV0aW9uIjoiI1N1bW1hcnkgb2YgRGF0YVxuc3VtbWFyeShhbnNjb21iZSR5MSkgI0V4YW1wbGUgZm9yIHRoZSBmaXJzdCBkYXRhIHNldCBpbiAgQW5zY29tYmUncyBxdWFydGV0XG5zdW1tYXJ5KGFuc2NvbWJlJHkyKVxuc3VtbWFyeShhbnNjb21iZSR5MylcbnN1bW1hcnkoYW5zY29tYmUkeTQpXG5cbiNWZWN0b3Igb2YgbWVhbnNcbmMobWVhbihhbnNjb21iZSR5MSksIG1lYW4oYW5zY29tYmUkeTIpLCBtZWFuKGFuc2NvbWJlJHkzKSxcbiAgbWVhbihhbnNjb21iZSR5NCkpXG5cbiNWZWN0b3Igb2YgdmFyaWFuY2VzXG5jKHZhcihhbnNjb21iZSR5MSksIHZhcihhbnNjb21iZSR5MiksIHZhcihhbnNjb21iZSR5MyksXG4gIHZhcihhbnNjb21iZSR5NCkpXG55MV9za2V3IDwtIG1lYW4oKGFuc2NvbWJlJHkxIC0gbWVhbihhbnNjb21iZSR5MSkpXjMpIC8gc2QoYW5zY29tYmUkeTEpIF4gMyIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiV2VsbCBkb25lIVwiKSIsImhpbnQiOiJUYWtlIHNvbWUgdGltZSB0byBleHBsb3JlIHRoZSBvbmxpbmUgPGNvZGU+UjwvY29kZT4gZG9jdW1lbnRhdGlvbi4ifQ== 3.1.2 Exercise. Determining Boxplots and Quantiles Assignment Text The boxplot function produces box-and-whisker plots of grouped values. The function returns certain statistic and produces a plot as a side effect. Explore the boxplot to understand the values returned. In particular review the the information returned by the stats object. The Wisconsin Property Fund data has already been read into a data frame called Insample. These data consist of claim experience for fund members over the years 2006-2010, inclusive. It includes claim values y as well as the claim year Year. For this exercise we will work with the natural logarithm of the claim values which are in the lny variable. We have filtered the data to exclude zero claims and saved the resulting data frame as Insample_nz. Instructions We provide the code to generate the boxplot. Note that the R creates the boxplot as a side effect while returning information about the data. (R does not print the information to the console by deafult. Youll have to assign the return of the boxplot function to an object to access.) What is the class of the of the object returned by the boxplot function. Access the stats object returned. Use the quantile function and replicate the hinge values for 2008 box. We will ignore the values returned for the whiskers as they are not a function of the quantiles of the distribution. We selected the 2008 year because it has an odd number of observations. Use the quantile function on a vector with an even number such as 1:100 and access the 25th percentile. Are you surprised by the result? Review the details for the type argument to the quantile to understand the various approached to determining quantiles. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycyA9IEZBTFNFKVxuSW5zYW1wbGVfbnogPC0gSW5zYW1wbGVbSW5zYW1wbGUkeSA+IDAsXSIsInNhbXBsZSI6Im15X2JveHBsb3QgPC0gYm94cGxvdChmb3JtdWxhID0gPz8sIGRhdGEgPSBJbnNhbXBsZV9ueilcbmNsYXNzKD8/KVxubXlfYm94cGxvdCQ/P1xubXlfYm94cGxvdCRzdGF0c1ssX10gIzIwMDhcblxubG55XzIwMDggPC0gSW5zYW1wbGVfbnokbG55W0luc2FtcGxlX256JFllYXIgPT0gMjAwOF1cblxucXVhbnRpbGUobG55XzIwMDgsID8/KSAjIGxvd2VyIGhpbmdlXG4/PyhsbnlfMjAwOCkgIyBtZWRpYW4gdGhyb3VnaCBhIGRlZGljYXRlZCBmdW5jdGlvblxucXVhbnRpbGUobG55XzIwMDgsID8/KSAjIG1lZGlhblxucXVhbnRpbGUobG55XzIwMDgsID8/KSAjIHVwcGVyIGhpbmdlIiwic29sdXRpb24iOiJteV9ib3hwbG90IDwtIGJveHBsb3QoZm9ybXVsYSA9IGxueSB+IFllYXIsIGRhdGEgPSBJbnNhbXBsZV9ueilcbmNsYXNzKG15X2JveHBsb3QpXG5teV9ib3hwbG90JHN0YXRzXG5teV9ib3hwbG90JHN0YXRzWywzXSAjMjAxMFxubG55XzIwMDggPC0gSW5zYW1wbGVfbnokbG55W0luc2FtcGxlX256JFllYXIgPT0gMjAwOF1cblxucXVhbnRpbGUobG55XzIwMDgsIDEvNCkgIyBsb3dlciBoaW5nZVxubWVkaWFuKGxueV8yMDA4KSAjIG1lZGlhblxucXVhbnRpbGUobG55XzIwMDgsIDMvNCkgIyB1cHBlciBoaW5nZSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiV2VsbCBkb25lIVwiKSIsImhpbnQiOiJUYWtlIHNvbWUgdGltZSB0byBleHBsb3JlIHRoZSBvbmxpbmUgPGNvZGU+UjwvY29kZT4gZG9jdW1lbnRhdGlvbi4ifQ== 3.1.3 Exercise. Gamma Moment Generating Function Assignment Text In Example 3.1.4 of the text, we presented the following moment generating function for a gamma distribution, \\[ M_X(t) = (1 - \\theta t)^{-\\alpha} . \\] We will work with this distribution in these exercises. The parameters that we will use in our exercise are \\(\\alpha=2\\) (the shape parameter) and \\(\\theta = 10\\) (the scale parameter). Keep in mind that the mean for this distribution is \\(\\alpha\\theta=20\\) and the variance is \\(\\alpha\\theta^2 = 200\\). We will revisit these results at the end of the excercise. There are several R functions that you will find useful: The parse function converts a character vector to an expression. Then, you can use the eval to evaluate the expression. You can use the D to compute derivatives. Instructions Use the parse function to create an expression and for the moment generating function. Specify the expression using alpha, theta and t. Name the object mgf. Note the class of mgf. Evaluate mgf at t = 0 when alpha = 2 and theta = 10. (Note that you do not need to specify the values of alpha and theta and t in the eval call. That is because we did not specify the envir argument to eval and the default is parent.frame(). Environments are a more advanced R topic that you can learn about here. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJtZ2YgPC0gcGFyc2UodGV4dCA9IFwiPz9cIilcblxuY2xhc3MoeCA9ID8/KVxuXG50IDwtID8/XG5hbHBoYSA8LSA/P1xudGhldGEgPC0gPz9cblxuZXZhbChleHByID0gPz8pIiwic29sdXRpb24iOiJtZ2YgPC0gcGFyc2UodGV4dCA9IFwiKDEtIHRoZXRhICogdCkgXiAtYWxwaGFcIilcblxuY2xhc3MoeCA9IG1nZilcblxuYWxwaGEgPC0gMlxudGhldGEgPC0gMTBcbnQgPC0gMFxuXG5ldmFsKGV4cHIgPSBtZ2YpIiwic2N0Ijoic3VjY2Vzc19tc2coXCJXZWxsIGRvbmUhXCIpIiwiaGludCI6IlRha2Ugc29tZSB0aW1lIHRvIGV4cGxvcmUgdGhlIG9ubGluZSA8Y29kZT5SPC9jb2RlPiBkb2N1bWVudGF0aW9uLiBJbiBwYXJ0aWN1bGFyLCB0YWtlIHRpbWUgdG8gdW5kZXJzdGFuZCB0aGUgcmVxdWlyZWQgY2xhc3Mgb2YgZWFjaCBhcmd1bWVudC4ifQ== 3.1.4 Exercise. Visualizing Moment Generating Functions Assignment Text We plot mgf to help visualize the function. The left-hand panel shows the function with the argument \\(t\\) is between -0.2 and 0.2. For \\(\\theta = 10\\) and \\(\\alpha &gt; 0\\), note that mgf goes to +inf when \\(t = \\frac{1}{\\theta} = 0.1\\). The right-hand panel shows the function between -0.01 and 0.01. This provides a better view of the curvature at zero. Instruction Use the D function to return an expression for the first and second derivatives with respect to \\(t\\). Assign the results of dMxtdt and d2Mxtdt2, respectively. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJkTXh0ZHQgPC0gRChleHByID0gcGFyc2UodGV4dCA9IFwiPz9cIiksIG5hbWUgPSAnPz8nKVxuXG5kMk14dGR0MiA8LSBEKFxuICBEKGV4cHIgPSBwYXJzZSh0ZXh0ID0gXCI/P1wiKSwgbmFtZSA9ICdfJyksXG4gIFwidFwiKSIsInNvbHV0aW9uIjoiTXh0ZHQgPC0gRChleHByID0gcGFyc2UodGV4dCA9IFwiKDEtIHRoZXRhICogdCkgXiAtYWxwaGFcIiksIG5hbWUgPSAndCcpXG5cbk14dGR0XG5cbk0yeHRkdCA8LSBEKFxuICBEKGV4cHIgPSBwYXJzZSh0ZXh0ID0gXCIoMS0gdGhldGEgKiB0KSBeIC1hbHBoYVwiKSwgbmFtZSA9ICd0JyksXG4gIG5hbWUgPSAndCcpXG5cbk0yeHRkdCIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiV2VsbCBkb25lIVwiKSIsImhpbnQiOiJUYWtlIHNvbWUgdGltZSB0byBleHBsb3JlIHRoZSBvbmxpbmUgPGNvZGU+UjwvY29kZT4gZG9jdW1lbnRhdGlvbi4gSW4gcGFydGljdWxhciwgdGFrZSB0aW1lIHRvIHVuZGVyc3RhbmQgdGhlIHJlcXVpcmVkIGNsYXNzIG9mIGVhY2ggYXJndW1lbnQuIn0= 3.1.5 Exercise. Determining Moments using Moment Generating Functions Assignment Text Recall that you can determine the \\(n^{th}\\) moment of of \\(X\\) as the \\(n^{th}\\) derivative of the moment generating function evaluated at \\(t = 0\\). Instructions Calculate the mean (first moment) of the gamma distribution. Calculate the second raw moment of the gamma distribution. Calculate the variance (second central moment) of the gamma distribution eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIjIG1lYW4gXG5FWCA8LSBldmFsKD8/KVxuXG4jIHNlY29uZCByYXcgbW9tZW50XG5FWDIgPC0gZXZhbCg/PylcblxuIyB2YXJpYW5jZVxuXG4/PyAtID8/IF4gMiIsInNvbHV0aW9uIjoiIyBtZWFuIFxuRVggPC0gZXZhbChNeHRkdClcblxuIyBzZWNvbmQgcmF3IG1vbWVudFxuRVgyIDwtIGV2YWwoTTJ4dGR0KVxuXG4jIHZhcmlhbmNlXG5FWDIgLSBFWCBeIDIiLCJzY3QiOiJzdWNjZXNzX21zZyhcIldlbGwgZG9uZSFcIikiLCJoaW50IjoiVGFrZSBzb21lIHRpbWUgdG8gZXhwbG9yZSB0aGUgb25saW5lIDxjb2RlPlI8L2NvZGU+IGRvY3VtZW50YXRpb24uIEluIHBhcnRpY3VsYXIsIHRha2UgdGltZSB0byB1bmRlcnN0YW5kIHRoZSByZXF1aXJlZCBjbGFzcyBvZiBlYWNoIGFyZ3VtZW50LiJ9 3.2 Continuous Distributions In this section, you learn how to define and apply four fundamental severity distributions: gamma, Pareto, Weibull, and generalized beta distribution of the second kind. R provides a family of functions associated with statistical distributions. The naming convention is to precede the distribution name with d for the density function, p for the cumulative distribution function, q for quantiles (percentiles), and r for random number generation. (We will set aside the r functions for Chapter 6 on Simulation and focus on d, p, and q functions.) The stats packages which is provided with base-R includes the distributions listed here. Many other distributions are available in other R packages. For the exercises in the section, we will focus on the gamma distribution from Section 3.2.1 to help you develop an intuition as to how the distribution responds to changes in its shape and scale parameter. From Figure 3.1, you should recognize that the support for the gamma distribution is positive real numbers. Youll also note that the distribution allows for varying levels of right-skewness. 3.2.1 Exercise. Assignment Text We will be working with the Wisconsin Property Fund data. We have read the data and created a vector of the log of non-zero claim values. The name of that vector is wisc_prop. :::: {.blackbox } Instructions Use the hist function to plot a histogram of wisc_prop. Review the help for hist and note that the histogram is drawn as a side-effect. We can access the information generated with the histogram by assigning the result to an object. For this exercise, you should assign that information to hist_data. Note the class of hist_data. Use the str function to review the elements of the list returned by the histogram function. :::: {.blackbox } eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Indpc2NfcHJvcCA8LSByZWFkLmNzdihcImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9PcGVuQWN0VGV4dERldi9MREFDb3Vyc2UxL21haW4vRGF0YS9JbnNhbXBsZS5jc3ZcIiwgaGVhZGVyPVQsIG5hLnN0cmluZ3M9YyhcIi5cIiksIHN0cmluZ3NBc0ZhY3RvcnMgPSBGQUxTRSlcbndpc2NfcHJvcCA8LSBsb2cod2lzY19wcm9wJHlbd2lzY19wcm9wJHkgPiAwXSkiLCJzYW1wbGUiOiJoaXN0X2RhdGEgPC0gaGlzdCh4ID0gXCI/P1wiKVxuXG5jbGFzcyh4ID0gPz8pXG5cbnN0cihvYmplY3QgPSA/PykiLCJzb2x1dGlvbiI6Imhpc3RfZGF0YSA8LSBoaXN0KHdpc2NfcHJvcClcbmNsYXNzKGhpc3RfZGF0YSlcbnN0cihoaXN0X2RhdGEpIiwic2N0Ijoic3VjY2Vzc19tc2coXCJXZWxsIGRvbmUhXCIpIiwiaGludCI6IlRha2Ugc29tZSB0aW1lIHRvIGV4cGxvcmUgdGhlIG9ubGluZSA8Y29kZT5SPC9jb2RlPiBkb2N1bWVudGF0aW9uLiBJbiBwYXJ0aWN1bGFyLCB0YWtlIHRpbWUgdG8gdW5kZXJzdGFuZCB0aGUgcmVxdWlyZWQgY2xhc3Mgb2YgZWFjaCBhcmd1bWVudC4ifQ== 3.2.2 Assignment Text From the histogram, we will develop an intuition as to whether a gamma distribution is likely to fit this data reasonably well. Consider whether the data is uni-modal and whether it is right-skewed. It appears to be which would support the modeling of log-claim sizes using the gamma distribution. Youll note that the \\(y\\)-axis of the histogram displays counts. In contrast, the dgamma function returns density values. So we cant add a gamma distribution to the histogram and compare to the data. Instead we first need to plot the density values of the data. To plot probability densities, we will use set the probability argument to hist to TRUE. You should note the following from the documentation of hist: The relationship between the that the probability and freq arguments to hist. There is a density argument to hist. As first, you may think this refers to the (probability) density function, but that argument specifies a plotting feature. You can use the curve function to plot the gamma distribution over the histogram data. To do this, you need to set the add argument to TRUE. In later sections, well review approaches to parameter estimation. In this section, we will vary the shape and scale parameters to understand the flexibility of the gamma distribution. The data will serve as a reference for this exercise. You may recall from the exercises from Section 3.1.3 that the mean of the gamma function is the product of the shape and scale parameters and the variance is the product of the shape and square of the scale parameters. You can use this information to develop parameter estimates using the method of moments. Instructions Again plot the histogram. This time specify the probability argument so as to plot probability densities. Calculate shape and scale parameters using the method of moments Calculate the density values for \\(x\\) values displayed within the limits of the plot. Add 3 to the shape parameter and note how the distribution changes. Subtract 0.05 from the scale parameter and note how the distribution changes. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Indpc2NfcHJvcCA8LSByZWFkLmNzdihcImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9PcGVuQWN0VGV4dERldi9MREFDb3Vyc2UxL21haW4vRGF0YS9JbnNhbXBsZS5jc3ZcIiwgaGVhZGVyPVQsIG5hLnN0cmluZ3M9YyhcIi5cIiksIHN0cmluZ3NBc0ZhY3RvcnMgPSBGQUxTRSlcbndpc2NfcHJvcCA8LSBsb2cod2lzY19wcm9wJHlbd2lzY19wcm9wJHkgPiAwXSkiLCJzYW1wbGUiOiJoaXN0X2RhdGEgPC0gaGlzdCh4ID0gPz8sIHByb2JhYmlsaXR5ID0gPz8pXG5nYW1tYV9zY2FsZSA8LSB2YXIoPz8pIC8gbWVhbig/PylcbmdhbW1hX3NoYXBlIDwtIG1lYW4oPz8pIC8gZ2FtbWFfc2NhbGVcbmN1cnZlKGRnYW1tYSh4LCBzaGFwZSA9ID8/LCBzY2FsZSA9ID8/KSwgYWRkID0gVFJVRSwgY29sID0gJ3JlZCcgKVxuZ2FtbWFfc2NhbGVcbmdhbW1hX3NoYXBlXG5jdXJ2ZShkZ2FtbWEoeCwgc2hhcGUgPSA/PyArID8/LCBzY2FsZSA9ID8/KSwgYWRkID0gVFJVRSwgY29sID0gJ2JsdWUnKVxuY3VydmUoZGdhbW1hKHgsIHNoYXBlID0gPz8sIHNjYWxlID0gPz8gLSAgPz8pLCBhZGQgPSBUUlVFLCBjb2wgPSAnZ3JlZW4nKSIsInNvbHV0aW9uIjoiaGlzdF9kYXRhIDwtIGhpc3QoeCA9IHdpc2NfcHJvcCwgcHJvYmFiaWxpdHkgPSBUUlVFKVxuZ2FtbWFfc2NhbGUgPC0gdmFyKHdpc2NfcHJvcCkgLyBtZWFuKHdpc2NfcHJvcClcbmdhbW1hX3NoYXBlIDwtIG1lYW4od2lzY19wcm9wKSAvIGdhbW1hX3NjYWxlXG5jdXJ2ZShkZ2FtbWEoeCwgc2hhcGUgPSBnYW1tYV9zaGFwZSwgc2NhbGUgPSBnYW1tYV9zY2FsZSksIGFkZCA9IFRSVUUsIGNvbCA9ICdyZWQnIClcbmdhbW1hX3NjYWxlXG5nYW1tYV9zaGFwZVxuY3VydmUoZGdhbW1hKHgsIHNoYXBlID0gZ2FtbWFfc2hhcGUgKyAzLCBzY2FsZSA9IGdhbW1hX3NjYWxlICsgIDApLCBhZGQgPSBUUlVFLCBjb2wgPSAnYmx1ZScpXG5jdXJ2ZShkZ2FtbWEoeCwgc2hhcGUgPSBnYW1tYV9zaGFwZSArIDAsIHNjYWxlID0gZ2FtbWFfc2NhbGUgLSAgMC4wNSksIGFkZCA9IFRSVUUsIGNvbCA9ICdncmVlbicpIiwic2N0Ijoic3VjY2Vzc19tc2coXCJXZWxsIGRvbmUhXCIpIn0= 3.3 Methods of Creating New Distributions In this section, you learn how to: Understand connections among the distributions Give insights into when a distribution is preferred when compared to alternatives Provide foundations for creating new distributions Video: Creating Distributions I Video: Creating Distributions II 3.4 Coverage Modifications In this section we evaluate the impacts of coverage modifications: deductibles, policy limit, coinsurance, and reinsurance on insurers costs. Video: Policy Deductibles Video: Policy Limits Assignment Text The support of the lognormal distribution is positive real numbers and the distribution is right-skewed. Given these properties, claim values for many coverages follow a lognormal distribution. R provides many several functions related to the lognormal. Particularly useful for calculations related to the effect of coverage modifications, the plnorm function returns the distribution function for a lognormal. Specifically, the limited expected value function is useful for calculating limited claim values, that is, claims amounts subject to policy limits. The limited expected value of \\(X\\) at limit, \\(L\\), is calculated as follows: \\[ LEV[x;L] = \\int_0^L x f_X(x) dx ~+ L * [1 - F_X(L)] . \\] The first term on the right-hand side is the contribution to the expected value for claims that are less than \\(L\\) and the second term is the expected value of all claims greater than or equal to \\(L\\). For the exercises in this section, we provide the mlnorm and levlnorm function to calculate unlimited mean and limited expected values, respectively with arguments meanlog and sdlog corresponding to the same arguments in the plnorm function. The levlnorm function requires an additional limit argument. We also provide the vector claims which are observed claims values from lognormal distribution with meanlog = 12 and sdlog = 1.5. The values of meanlog and sdlog are saved in the mu and sigma objects. Instructions Calculate the expected value of the lognormal function and compare to the mean of claims. Calculate the expected value of the claims retained by the insured using the levlnorm function and the compare to the mean of claims. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQ1KVxubXUgPC0gMTJcbnNpZ21hIDwtIDEuNVxuY2xhaW1zIDwtIHJsbm9ybShuID0gMTAwMDAwLCBtZWFubG9nID0gbXUsIHNkbG9nID0gc2lnbWEpXG5tbG5vcm0gPC0gZnVuY3Rpb24obWVhbmxvZywgc2Rsb2cpIGV4cChtZWFubG9nICsgc2Rsb2cgXiAyIC8yKVxuXG5sZXZsbm9ybSA8LSBmdW5jdGlvbihsaW1pdCwgbWVhbmxvZywgc2Rsb2cpe1xuICB0MSA8LSBtbG5vcm0obWVhbmxvZyA9IG1lYW5sb2csIHNkbG9nID0gc2Rsb2cpICogXG4gICAgcG5vcm0ocSA9IChsb2cobGltaXQpIC0gbWVhbmxvZyAtIHNkbG9nIF4gMikgLyBzZGxvZylcbiAgdDIgPC0gbGltaXQgKiAoIDEtIHBub3JtKChsb2cobGltaXQpIC0gbWVhbmxvZykgLyBzZGxvZykpXG4gIHJldHVybih0MSArIHQyKVxuICB9Iiwic2FtcGxlIjoiIyBVbmxpbWl0ZWRcbiNleHBlY3RlZCB2YWx1ZSBvZiB0aGUgbG9nbm9ybWFsIGZ1bmN0aW9uXG5tbG5vcm0obWVhbmxvZyA9ID8/LCBzZGxvZyA9ID8/KVxuIyBtZWFuIG9mIGNsYWltc1xubWVhbig/PykiLCJzb2x1dGlvbiI6IiMgVW5saW1pdGVkXG4jZXhwZWN0ZWQgdmFsdWUgb2YgdGhlIGxvZ25vcm1hbCBmdW5jdGlvblxubWxub3JtKG1lYW5sb2cgPSBtdSwgc2Rsb2cgPSBzaWdtYSlcbiMgbWVhbiBvZiBjbGFpbXNcbm1lYW4oY2xhaW1zKSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiV2VsbCBkb25lIVwiKSIsImhpbnQiOiJOb3RlIHRoYXQgd2UgaGF2ZSBjcmVhdGVkIHRoZSA8Y29kZT5SPC9jb2RlPiBvYmplY3RzIDxjb2RlPm11PC9jb2RlPiBhbmQgPGNvZGU+c2lnbWE8L2NvZGU+LCBjb25zaWRlciBob3cgdG8gdXNlIHRoZW0gaW4geW91ciBhbnN3ZXIuXG5Tb21lIGNvZGVycyBmaW5kIGl0IGVhc2llciB0byBjb2RlIHRob3VzYW5kcyBhbmQgbWlsbGlvbnMgdXNpbmcgc2NpZW50aWZpYyBub3RhdGlvbi4gRm9yIGV4YW1wbGUsIGl0IG1heSBiZSBlYXNpZXIgdG8gdHlwZSA1ZTYgdGhhbiB0byBjb3VudCB0aGUgbnVtYmVyIG9mIHplcm9zIG9uIGluIDUwMDAwMDAgb24geW91ciBzY3JlZW4uIn0= Assignment Text Now, assume that an insurer provides coverage for the first $5 million of claims. Instructions Calculate the expected value of the claims insured with a $5 million policy limit using the levlnorm function and the compare to the amounts insured from claims. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIjIyMgQ2xhaW0gYW1vdW50cyBpbnN1cmVkIHVuZGVyIGEgJDUgbWlsbGlvbiBsaW1pdCAgICBcblxuIyBGcm9tIHRoZSBsaW1pdGVkIGV4cGVjdGVkIHZhbHVlIGZ1bmN0aW9uXG5sZXZsbm9ybShsaW1pdCA9ID8/LCBtZWFubG9nID0gPz8sIHNkbG9nID0gPz8pXG5cbiMgRnJvbSB0aGUgY2xhaW1zIGRhdGFcbm1lYW4ocG1pbig/PywgPz8pKSIsInNvbHV0aW9uIjoiIyMjIENsYWltIGFtb3VudHMgaW5zdXJlZCB1bmRlciBhICQ1IG1pbGxpb24gbGltaXQgICAgXG5cbiMgRnJvbSB0aGUgbGltaXRlZCBleHBlY3RlZCB2YWx1ZSBmdW5jdGlvblxubGV2bG5vcm0obGltaXQgPSA1ZTYsIG1lYW5sb2cgPSAxMiwgc2Rsb2cgPSAxLjUpXG5cblxuIyBGcm9tIHRoZSBjbGFpbXMgZGF0YVxubWVhbihwbWluKDVlNiwgY2xhaW1zKSkiLCJzY3QiOiJzdWNjZXNzX21zZyhcIldlbGwgZG9uZSFcIikifQ== Assignment Text When an insurer provides coverage with a deductible, only a portion of claims result in reimbursement. The claims that do produce reimbursement have a greater average value than the average value for all claims. For this exercise, assume that an insurer provides coverage for the first $5 million of claims in excess of a $1 million deductible. Note that this coverage is sometimes states as $4 million excess of $1 million (or shorthand notation such as $4mln xs $1 mln). Instructions Determine the number of claims resulting in reimbursement. Compare to the expected value of the number of claims requiring reimbursement calculated using the plnorm function. Calculate the amounts insured. Do this in two steps. First, subset claims to only inlcue amounts in excess of $1 million. Second, calculate the average value of those claims. Calculate the expected value of the claims insured subject to a $1 million deductible and a $5 million policy limit using the levlnorm and plnorm function and the compare to the amounts you calculated in the prior step. Note that these are the ground-up values meaning that they include the amounts within the deductible. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIjIyMgQ2xhaW0gY291bnRzIGFtb3VudHMgaW5zdXJlZCB1bmRlciBhICQxIG1pbGxpb24gZGVkdWN0aWJsZSBhcHBsaWVkIHRvIHRoZSBmaXJzdCAkNSBtaWxsaW9uIG9mIGNsYWltc1xuIyBOdW1iZXIgb2YgY2xhaW1zIGluIHRoZSBkYXRhXG5zdW0oY2xhaW1zID4gPz8pIFxuIyBFeHBlY3RlZFxuKDEgLSBwbG5vcm0ocSA9ID8/LCBtZWFubG9nID0gPz8sIHNkbG9nID0gPz8pKSAqIGxlbmd0aCg/PylcblxuIyBBdmVyYWdlIFZhbHVlIGZyb20gY2xhaW1zXG5pbnN1cmVkIDwtIGNsYWltc1tjbGFpbXMgPiA/P11cbm1lYW4ocG1pbig/PywgPz8pKVxuXG4jRXhwZWN0ZWRcbj8/ICsgKGxldmxub3JtKGxpbWl0ID0gPz8sIG1lYW5sb2cgPSA/Pywgc2Rsb2cgPSA/PykgLSBcbiAgbGV2bG5vcm0obGltaXQgPSA/PywgbWVhbmxvZyA9ID8/LCBzZGxvZyA9ID8/KSkgLyBcbiAgKDEgLSBwbG5vcm0ocSA9ID8/LCBtZWFubG9nID0gPz8sIHNkbG9nID0gPz8pKSIsInNvbHV0aW9uIjoiIyMjIENsYWltIGNvdW50cyBhbW91bnRzIGluc3VyZWQgdW5kZXIgYSAkMSBtaWxsaW9uIGRlZHVjdGlibGUgYXBwbGllZCB0byB0aGUgZmlyc3QgJDUgbWlsbGlvbiBvZiBjbGFpbXNcbiMgTnVtYmVyIG9mIGNsYWltcyBpbiB0aGUgZGF0YVxuc3VtKGNsYWltcyA+IDFlNikgXG4jIEV4cGVjdGVkXG4oMSAtIHBsbm9ybShxID0gMWU2LCBtZWFubG9nID0gbXUsIHNkbG9nID0gc2lnbWEpKSAqIGxlbmd0aChjbGFpbXMpXG5cbiMgQXZlcmFnZSBWYWx1ZSBmcm9tIGNsYWltc1xuaW5zdXJlZCA8LSBjbGFpbXNbY2xhaW1zID4gMWU2XVxubWVhbihwbWluKDVlNiwgaW5zdXJlZCkpXG5cbiNFeHBlY3RlZFxuMWU2ICsgKGxldmxub3JtKGxpbWl0ID0gNWU2LCBtZWFubG9nID0gbXUsIHNkbG9nID0gc2lnbWEpIC0gXG4gIGxldmxub3JtKGxpbWl0ID0gMWU2LCBtZWFubG9nID0gbXUsIHNkbG9nID0gc2lnbWEpKSAvIFxuICAoMSAtIHBsbm9ybShxID0gMWU2LCBtZWFubG9nID0gbXUsIHNkbG9nID0gc2lnbWEpKSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiV2VsbCBkb25lIVwiKSJ9 Assignment Text For this exercise, assume that an insurer provides coverage for the first $5 million of claims in excess of a $1 million deductible. Note that this coverage is sometimes states as $4 million excess of $1 million (or shorthand notation such as $4mln xs $1 mln). (This is the same as the prior exercise.) However, now you should assume that there is a 20% coinsurance provision. The number of claims will not differ from the prior exercise, so will focus on the average value. Instructions Calculate the expected insured value of the claims subject to a $1 million deductible and 20% coinsurance and a $5 million policy limit using the levlnorm and plnorm function and the compare to the amounts insured from claims. In contrast to the prior excercise, calculate the insured value of the claim rather than the ground-up value. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIjIyMgQ2xhaW0gYW1vdW50cyBpbnN1cmVkIHVuZGVyIGEgJDEgbWlsbGlvbiBkZWR1Y3RpYmxlIHdpdGggYSAkNSBtaWxsaW9uIHBvbGljeSBsaW1pdFxuIyMjIHdpdGggMjAlIGNvaW5zdXJhbmNlXG5cbiNBdmVyYWdlIFZhbHVlXG5pbnN1cmVkIDwtIGNsYWltc1tjbGFpbXMgPiA/P11cbm1lYW4ocG1pbig/PywgPz8pIC0gPz8pICogKDEgLSA/PylcblxuI0F2ZXJhZ2UgVmFsdWVcbihsZXZsbm9ybShsaW1pdCA9ID8/LCBtZWFubG9nID0gPz8sIHNkbG9nID0gPz8pIC0gXG4gIGxldmxub3JtKGxpbWl0ID0gPz8sIG1lYW5sb2cgPSA/Pywgc2Rsb2cgPSA/PykpIC8gXG4gICgxIC0gcGxub3JtKHEgPSA/PywgbWVhbmxvZyA9ID8/LCBzZGxvZyA9ID8/KSkgKiBcbiAgICAoMSAtID8/KSIsInNvbHV0aW9uIjoiIyMjIENsYWltIGFtb3VudHMgaW5zdXJlZCB1bmRlciBhICQxIG1pbGxpb24gZGVkdWN0aWJsZSB3aXRoIGEgJDUgbWlsbGlvbiBwb2xpY3kgbGltaXQgICBcbiMjIyB3aXRoIDIwJSBjb2luc3VyYW5jZVxuXG4jQXZlcmFnZSBWYWx1ZVxuaW5zdXJlZCA8LSBjbGFpbXNbY2xhaW1zID4gMWU2XVxubWVhbihwbWluKDVlNiwgaW5zdXJlZCkgLSAxZTYpICogKDEgLSAwLjIpXG5cbiNBdmVyYWdlIFZhbHVlXG5cbihsZXZsbm9ybShsaW1pdCA9IDVlNiwgbWVhbmxvZyA9IG11LCBzZGxvZyA9IHNpZ21hKSAtIFxuICBsZXZsbm9ybShsaW1pdCA9IDFlNiwgbWVhbmxvZyA9IG11LCBzZGxvZyA9IHNpZ21hKSkgLyBcbiAgKDEgLSBwbG5vcm0ocSA9IDFlNiwgbWVhbmxvZyA9IG11LCBzZGxvZyA9IHNpZ21hKSkgKiAoMSAtIDAuMikiLCJzY3QiOiJzdWNjZXNzX21zZyhcIldlbGwgZG9uZSFcIikifQ== Video: Policy Coinsurance and Reinsurance 3.5 Maximum Likelihood Estimation In this section, you learn how to: Define a likelihood for a sample of observations from a continuous distribution Define the maximum likelihood estimator for a random sample of observations from a continuous distribution Estimate parametric distributions based on grouped, censored, and truncated data "],["model-selection-and-estimation.html", "Chapter 4 Model Selection and Estimation 4.1 Nonparametric Inference 4.2 Tools for Model Selection 4.3 Model Selection: Likelihood Ratio Tests and Goodness of Fit 4.4 Estimation using Modified Data: Nonparametric Approach 4.5 Estimation using Modified Data: Parametric Approach 4.6 Bayesian Inference", " Chapter 4 Model Selection and Estimation Draft - Chapter Not Yet Complete Chapter description. Chapters 2 and 3 have described how to fit parametric models to frequency and severity data, respectively. This chapter begins with the selection of models. To compare alternative parametric models, it is helpful to summarize data without reference to a specific parametric distribution. Section 4.1 describes nonparametric estimation, how we can use it for model comparisons and how it can be used to provide starting values for parametric procedures. The process of model selection is then summarized in Sections 4.2 and 4.3. Although our focus is on data from continuous distributions, the same process can be used for discrete versions or data that come from a hybrid combination of discrete and continuous distributions. Model selection and estimation are fundamental aspects of statistical modeling. To provide a flavor as to how they can be adapted to alternative sampling schemes, Sections 4.4 and 4.5 describes estimation for grouped, censored and truncated data. To see how they can be adapted to alternative models, the chapter closes with Section 4.6 on Bayesian inference, an alternative procedure where the (typically unknown) parameters are treated as random variables. Although not needed to go through the tutorials, some users may wish to download the overheads used in the videos. Download Chapter Four overheads as a .pdf file. By watching the videos and working through the tutorial exercises, you will get an appreciation for model selection and estimation. For a deeper dive, see the corresponding chapter in the textbook, Chapter Four of Loss Data Analytics. 4.1 Nonparametric Inference In this section, you learn how to: Estimate moments, quantiles, and distributions without reference to a parametric distribution Video: Nonparametric Estimation Tools Overheads: Nonparametric Estimation Tools (Click Tab to View) A. Nonparametric Estimation B. Moment Estimators C. Empirical Cumulative Distribution Function D. Empirical Example E. Empirical Cumulative Distribution Function of a Toy Example F. Smoothed Empirical Percentiles I G. Smoothed Empirical Percentiles II H. Density Estimators I. Uniform Kernel Density Estimator J. Kernel Density Estimator K. Kernel Density Estimator of a Distribution Function L. Grouped Data I M. Grouped Data II Hide Hide Hide Hide Hide Hide Hide Hide Hide Hide Hide Hide Hide 4.1.1 Exercise. Empirical Distribution Function and Quartiles, Percentiles and Quantiles Assignment Text In this tutorial, you will find empirical distribution and quantiles for the loss. The Wisconsin Property Fund data has already been read into a data frame called Insample. These data consist of claim experience for fund members over the years 2006-2010, inclusive. It includes the claim year Year and claim loss y. Instructions Use the function ecdf() to create the empirical distribution for loss amount y and plot it. Use the function quantile() to produce sample quantiles corresponding to the given percentiles for each year. Which year has the largest 90th percentiles? eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly91cmxkZWZlbnNlLmNvbS92My9fX2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9PcGVuQWN0VGV4dERldi9MREFDb3Vyc2UxL21haW4vRGF0YS9JbnNhbXBsZS5jc3ZfXzshIURaM2ZqZyFyYXdoUzFhVklCU2M2V1NyeEZVcXhSN0ZTQnV5YlAxcWszb1RPNjFYYjlXT00zOU5TTWdZem5pRU5PMzljZlpZY2ckIFwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSkiLCJzYW1wbGUiOiIjIENyZWF0ZSBlbXBpcmljYWwgZGlzdHJpYnV0aW9uXG5lbXBpcmljYWwgPC0gPz9cbiMgUGxvdCBlbXBpcmljYWwgZGlzdHJpYnV0aW9uXG5wbG90KD8/KVxuXG5saWJyYXJ5KGRwbHlyKVxuIyBHcm91cCBkYXRhIGJ5IHllYXIgYW5kIHN1bW1hcmlzZSBkYXRhIHVzaW5nIHF1YW50aWxlXG5JbnNhbXBsZSAlPiUgXG4gIGdyb3VwX2J5KD8/KSAlPiUgXG4gIHN1bW1hcmlzZSg/PykiLCJzb2x1dGlvbiI6IiMgQ3JlYXRlIGVtcGlyaWNhbCBkaXN0cmlidXRpb25cbmVtcGlyaWNhbCA8LSBlY2RmKEluc2FtcGxlJHkpXG4jIFBsb3QgZW1waXJpY2FsIGRpc3RyaWJ1dGlvblxucGxvdChlbXBpcmljYWwsIG1haW49XCJcIiwgeGxhYj1cImxvc3NcIixcbiAgICAgdmVydGljYWxzPVRSVUUsIGNvbC5wb2ludHM9XCJibHVlXCIsXG4gICAgIGNvbC5ob3I9XCJyZWRcIiwgY29sLnZlcnQ9XCJiaXNxdWVcIilcblxubGlicmFyeShkcGx5cilcbiMgR3JvdXAgZGF0YSBieSB5ZWFyIGFuZCBzdW1tYXJpc2UgZGF0YSB1c2luZyBxdWFudGlsZVxuSW5zYW1wbGUgJT4lIFxuICBncm91cF9ieShZZWFyKSAlPiUgXG4gIHN1bW1hcmlzZShxdWFudGlsZV9lYWNoX3llYXI9cXVhbnRpbGUoeSwgcHJvYnM9YygwLjkpLCB0eXBlPTYpKSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiRXhjZWxsZW50IHN0YXJ0ISBZZWFyIDIwMDcgaGFzIHRoZSBsYXJnZXN0IDkwdGggcGVyY2VudGlsZXMuXCIpIiwiaGludCI6Imdyb3VwX2J5KCkgdGFrZXMgYW4gZXhpc3RpbmcgZGF0YSBhbmQgY29udmVydHMgaXQgaW50byBhIGdyb3VwZWQgZGF0YSB3aGVyZSBvcGVyYXRpb25zIGFyZSBwZXJmb3JtZWQgYnkgZ3JvdXAuXG5zdW1tYXJpc2UoKSBvdXRwdXRzIGEgc2luZ2xlIHJvdyBzdW1tYXJpc2luZyBhbGwgb2JzZXJ2YXRpb25zIGluIHRoZSBpbnB1dC4gSXQgd2lsbCBjb250YWluIG9uZSBjb2x1bW4gZm9yIGVhY2ggZ3JvdXBpbmcgdmFyaWFibGUgYW5kIG9uZSBjb2x1bW4gZm9yIGVhY2ggb2YgdGhlIHN1bW1hcnkgc3RhdGlzdGljcyB0aGF0IHlvdSBoYXZlIHNwZWNpZmllZC5cbldoaWNoIDxjb2RlPnR5cGU8L2NvZGU+IHNob3VsZCB3ZSB1c2UgZm9yIHF1YW50aWxlKCk/In0= 4.1.2 Exercise. Density Estimators Assignment Text Nonparametric density estimators, such as the kernel estimator, are regularly used in practice. In this tutorial, We will use the Wisconsin Property Fund data, which already has been read into a data frame called Insample, to plot a histogram and overlay density curves with various density estimators. Instructions. Please plot a histogram of logarithmic loss amount y. Use the function density() to compute kernel density estimates. Overlay density curves on top of the histogram: using (blue) thick curve to represent a Gaussian kernel density where the bandwidth was selected automatically using an ad hoc rule based on the sample size and volatility of these data, using (green) thick curve to represent a Gaussian kernel density with a bandwidth equal to 1, using (red) thick curve to represent a Triangular kernel density with a bandwidth of 0.1. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly91cmxkZWZlbnNlLmNvbS92My9fX2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9PcGVuQWN0VGV4dERldi9MREFDb3Vyc2UxL21haW4vRGF0YS9JbnNhbXBsZS5jc3ZfXzshIURaM2ZqZyFyYXdoUzFhVklCU2M2V1NyeEZVcXhSN0ZTQnV5YlAxcWszb1RPNjFYYjlXT00zOU5TTWdZem5pRU5PMzljZlpZY2ckIFwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSkiLCJzYW1wbGUiOiIjIFBsb3QgaGlzdG9ncmFtXG5oaXN0KD8/LCBmcmVxPUZBTFNFKVxuIyBHYXVzc2lhbiBrZXJuZWwgZGVuc2l0eSAtIGJsdWUgY3VydmVcbmxpbmVzKGRlbnNpdHkoPz8sIGNvbD1cImJsdWVcIiwgbHdkPTIpXG4jIEdhdXNzaWFuIGtlcm5lbCBkZW5zaXR5IHdpdGggYSBiYW5kd2lkdGggZXF1YWwgdG8gMSAtIGdyZWVuIGN1cnZlXG5saW5lcyhkZW5zaXR5KD8/LCBidz0/PyksIGNvbD1cImdyZWVuXCIsIGx3ZD0yKVxuIyBUcmlhbmd1bGFyIGtlcm5lbCBkZW5zaXR5IHdpdGggYSBiYW5kd2lkdGggZXF1YWwgdG8gMC4xIC0gcmVkIGN1cnZlXG5saW5lcyhkZW5zaXR5KD8/LCBrZXJuZWw9Pz8sIGJ3PT8/KSwgY29sPVwicmVkXCIsIGx3ZD0yKSIsInNvbHV0aW9uIjoiIyBQbG90IGhpc3RvZ3JhbVxuaGlzdChsb2coSW5zYW1wbGUkeSksIGZyZXE9RkFMU0UpXG4jIEdhdXNzaWFuIGtlcm5lbCBkZW5zaXR5IC0gYmx1ZSBjdXJ2ZVxubGluZXMoZGVuc2l0eShsb2coSW5zYW1wbGUkeSkpLCBjb2w9XCJibHVlXCIsIGx3ZD0yKVxuIyBHYXVzc2lhbiBrZXJuZWwgZGVuc2l0eSBhIGJhbmR3aWR0aCBlcXVhbCB0byAxIC0gZ3JlZW4gY3VydmVcbmxpbmVzKGRlbnNpdHkobG9nKEluc2FtcGxlJHkpLCBidz0xKSwgY29sPVwiZ3JlZW5cIiwgbHdkPTIpXG4jIFRyaWFuZ3VsYXIga2VybmVsIGRlbnNpdHkgYSBiYW5kd2lkdGggZXF1YWwgdG8gMC4xIC0gcmVkIGN1cnZlXG5saW5lcyhkZW5zaXR5KGxvZyhJbnNhbXBsZSR5KSwga2VybmVsPVwidHJpYW5ndWxhclwiLCBidz0wLjEpLCBjb2w9XCJyZWRcIiwgbHdkPTIpIiwic2N0Ijoic3VjY2Vzc19tc2coXCJFeGNlbGxlbnQhIFRoaXMgaXMgYSB2ZXJ5IGJlYXV0aWZ1bCBncmFwaGljIHdpdGggY29sb3JzISBXZSBvYnNlcnZlZCBkaWZmZXJlbnQgZGVuc2l0eSBjdXJ2ZXMuXCIpIiwiaGludCI6IlRoZSBzeW50YXggbG9nKGRhdGEkeCkgcHJvZHVjZXMgbG9nIG9mIHguIn0= 4.1.3 Exercise. Claim Frequency Assignment Text In this tutorial, you will model claims count data and decide whether a Poisson\\((\\lambda)\\) or a Negative Binomial\\((r=3,p)\\) better fits the data. The raw data are the number of claims filed by \\(n=100\\) policyholders. Recall that claims data are discrete, and take values \\(0, 1, 2, ...\\) and so we consider two discrete probability models. You will apply tools learned in Section 4.1 to make a decision on which model fits these data better. We also start with exploratory data analysis, making graphical and numeric summaries of data before fitting a model. Instructions. Make a table of the claims counts Make a barplot to graphically display the claims counts Compute the mean and variance of the claims count distribution. Based on these, do you think a Poisson or a Negative Binomial model might be better? eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDQpXG5jbGFpbXMgPSBybmJpbm9tKG4gPSAxMDAsIHNpemUgPSAzLCBwcm9iID0gMC41KVxuI0luc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCxcbiMgICAgICAgICAgICAgICAgICAgICAgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSkiLCJzYW1wbGUiOiJ0YWJsZShjbGFpbXMpXG5iYXJwbG90KD8/LCB4bGFiPVwiIyBDbGFpbXNcIilcblxubWVhbihjbGFpbXMpXG5fX18oY2xhaW1zKSIsInNvbHV0aW9uIjoidGFibGUoY2xhaW1zKVxuYmFycGxvdCh0YWJsZShjbGFpbXMpLCB4bGFiPVwiIyBDbGFpbXNcIilcbm1lYW4oY2xhaW1zKVxudmFyKGNsYWltcykiLCJzY3QiOiJzdWNjZXNzX21zZyhcIkFuZCB5b3UncmUgb2ZmISAgUFMgLSBkaWQgeW91IGxhYmVsIHlvdXIgYXhlcz9cIikiLCJoaW50IjoiVGhlIG91dHB1dCBmcm9tIHRoZSA8Y29kZT50YWJsZSgpPC9jb2RlPiBmdW5jdGlvbiBjYW4gYmUgdXNlZCBhcyBhbiBhcmd1bWVudCBpbiB0aGUgPGNvZGU+YmFycGxvdCgpPC9jb2RlPiBmdW5jdGlvbiJ9 Observe that the distribution is heavily right-skewed, and the sample variance is much larger than the sample mean. You may recall that if \\(X \\sim\\) Poisson\\((\\lambda)\\), \\[ E(X) = Var(X) = \\lambda. \\] We would expect the sample mean and sample variance to be roughly equal if the claims data came from the Poisson our first clue this distribution may not be best! Instructions. Fit the Poisson distribution by estimating \\(\\lambda\\) using maximum likelihood estimation. Make a \\(qq\\) plot comparing the observed data to the fitted Poisson. Fitting the distribution involves estimating the parameter \\(\\lambda\\). Do you recall the maximum likelihood estimator for a Poisson? If not, this is shown in the companion video for this tutorial. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDQpXG5jbGFpbXMgPSBybmJpbm9tKG4gPSAxMDAsIHNpemUgPSAzLCBwcm9iID0gMC41KVxuI0luc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCxcbiMgICAgICAgICAgICAgICAgICAgICAgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSkiLCJzYW1wbGUiOiJsYW1iZGEgPSA/P1xubGFtYmRhXG5cbiMjIG1ha2UgdGhlIHF1YW50aWxlc1xucD1zZXEoMC4wMSwwLjk5LCBieT0wLjAxKVxucXAgPSBxcG9pcyhwLCBsYW1iZGE9MylcblxuIyMgY29tcHV0ZSB0aGUgcXVhbnRpbGVzXG5xY2xhaW1zID0gcXVhbnRpbGUoPz8sIHApXG5cbiMjIE1ha2UgYSBwbG90IChhbmQgbGFiZWwgYXhlcyEpXG5wbG90KD8/LCA/PywgeWxpbT1jKDAsMTIpLHhsaW09YygwLDEyKSwgeGxhYj1cIk1vZGVsIFF1YW50aWxlc1wiLCB5bGFiPVwiRW1waXJpY2FsIFF1YW50aWxlc1wiKVxuYWJsaW5lKDAsMSkiLCJzb2x1dGlvbiI6ImxhbWJkYSA9IG1lYW4oY2xhaW1zKVxubGFtYmRhXG5cbiMjIG1ha2UgdGhlIHF1YW50aWxlc1xucHI9c2VxKDAuMDEsMC45OSwgYnk9MC4wMSlcbnFwID0gcXBvaXMocHIsIGxhbWJkYT0zKVxuXG4jIyBjb21wdXRlIHRoZSBxdWFudGlsZXNcbnFjbGFpbXMgPSBxdWFudGlsZShjbGFpbXMsIHByKVxuXG4jIyBNYWtlIGEgcGxvdCAoYW5kIGxhYmVsIGF4ZXMhKVxucGxvdChxcCwgcWNsYWltcywgeWxpbT1jKDAsMTIpLHhsaW09YygwLDEyKSwgeGxhYj1cIk1vZGVsIFF1YW50aWxlc1wiLCB5bGFiPVwiRW1waXJpY2FsIFF1YW50aWxlc1wiKVxuYWJsaW5lKDAsMSkiLCJzY3QiOiJzdWNjZXNzX21zZyhcIk5pY2UhICBCdXQgaXQncyBub3QgYSAqZ3JlYXQqIGZpdCwgaXMgaXQ/XCIpIiwiaGludCI6IlJlbWVtYmVyIHRoZSBNTEUgZm9yIGEgUG9pc3NvbiBpcyBqdXN0IHRoZSBzYW1wbGUgbWVhbiE8L3A+XG5cbjxwPlNob3VsZCB5b3UgYnJ1c2ggdXAgb24gdGhlICA8YSBocmVmPVwiaHR0cHM6Ly93d3cucmRvY3VtZW50YXRpb24ub3JnL3BhY2thZ2VzL2Jhc2UvdmVyc2lvbnMvMy42LjIvdG9waWNzL3F1YW50aWxlXCI+cXVhbnRpbGU8L2E+IGZ1bmN0aW9uPyJ9 Do you notice how the empirical quantiles dont match the model for some of the larger values in the right tail? This plot says the empirical quantiles are too large, thats why they are above the diagonal line \\(y=x\\). Our claims data are too right-skewed, and thats why the \\(qq\\) plot seems off for larger quantiles. Might the Negative Binomial might be more promising? Instructions. Fit the Negative Binomial by using the method of moments estimator to estimate \\(p\\). Make a \\(qq\\) plot comparing the observed data to the fitted Negative Binomial. To fit the Negative Binomial (\\(r=3, \\beta\\)), we need to estimate the parameter \\(\\beta\\) using the method of moments. Recall that the probability mass function for a Negative Binomial (Sec 2.2.3.3) is \\[ P(X = k) = \\frac{(k+r-1)!}{k!(r-1)!}\\left(\\frac{1}{1+\\beta}\\right)^r \\left(\\frac{\\beta}{1+\\beta} \\right)^k, \\hspace{5mm} k=0, 1, ... \\] with parameters \\(r\\) and \\(\\beta\\). Also recall that in the method of moments we equate the \\(t^{th}\\) sample moment and \\(t^{th}\\) model moment, \\[ E(X^t) = \\frac{1}{n}\\sum_{i=1}^{n}x_{i}^t, \\] where \\(t=1, 2, ...\\). If we use \\(t=1\\) to equate the first moments, we get the expression \\[ E(X) = r\\beta = 3\\beta = \\bar{x} = 3 \\] Solving the above for \\(\\beta\\), we see \\(\\hat{\\beta} = 1\\). Therefore the Negative Binomial(\\(r=3, \\beta=1\\)) is the fitted model. Next, we use R to fit this and make a qq plot. It is important to understand that distributions are not uniquely parameterized, and there can be different conventions across fields, textbooks, and software. Indeed, in R the function defines the Negative Binomial as \\[ P(X = x) = \\frac{(x+n-1)!}{(n-1)!x!}p^n(1-p)^x, \\hspace{5mm} x=0, 1, ... \\] This matches the definition in the textbook by equating \\(x=k\\), prob \\(p = \\frac{1}{1+\\beta}\\), and size \\(r=n\\). It is very important to carefully consider the parameterization of any distribution you use in R. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDQpXG5jbGFpbXMgPSBybmJpbm9tKG4gPSAxMDAsIHNpemUgPSAzLCBwcm9iID0gMC41KVxuI0luc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCxcbiMgICAgICAgICAgICAgICAgICAgICAgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSkiLCJzYW1wbGUiOiJwcj1zZXEoMC4wMSwwLjk5LCBieT0wLjAxKVxucWIgPSBxbmJpbm9tKHByLCBzaXplPT8/LCBwcm9iID0gPz8pXG5cbiMjIGNvbXB1dGUgdGhlIHF1YW50aWxlc1xucWNsYWltcyA9IHF1YW50aWxlKGNsYWltcywgcHIpXG5cbnBsb3QocWIsIHFjbGFpbXMsIHlsaW09YygwLDEyKSwgeGxpbT1jKDAsMTIpLCB5bGFiPVwiRW1waXJpY2FsIFF1YW50aWxlc1wiLCB4bGFiPVwiTW9kZWwgUXVhbnRpbGVzXCIpXG5hYmxpbmUoMCwxKSIsInNvbHV0aW9uIjoicCA9IDAuNVxucHI9c2VxKDAuMDEsMC45OSwgYnk9MC4wMSlcbnFiID0gcW5iaW5vbShwciwgc2l6ZT0zLCBwcm9iID0gcClcblxuIyMgY29tcHV0ZSB0aGUgcXVhbnRpbGVzXG5xY2xhaW1zID0gcXVhbnRpbGUoY2xhaW1zLCBwcilcblxucGxvdChxYiwgcWNsYWltcywgeWxpbT1jKDAsMTIpLCB4bGltPWMoMCwxMiksIHlsYWI9XCJFbXBpcmljYWwgUXVhbnRpbGVzXCIsIHhsYWI9XCJNb2RlbCBRdWFudGlsZXNcIilcbmFibGluZSgwLDEpIiwic2N0Ijoic3VjY2Vzc19tc2coXCJUaGlzIHNlZW1zIHRvIGJlIGEgYmV0dGVyIGZpdCB0aGFuIFBvaXNzb24uXCIpIiwiaGludCI6IlNob3VsZCB5b3UgYnJ1c2ggdXAgb24gdGhlICA8YSBocmVmPVwiaHR0cHM6Ly93d3cucmRvY3VtZW50YXRpb24ub3JnL3BhY2thZ2VzL2Jhc2UvdmVyc2lvbnMvMy42LjIvdG9waWNzL3FuYmlub21cIj5xbmJpbm9tPC9hPiBmdW5jdGlvbj8gIEl0IGNhbiBiZSBlYXN5IHRvIGVudGVyIHRoZSB3cm9uZyBwYXJhbWV0ZXJzIGZvciBhIGRpc3RyaWJ1dGlvbiwgZXNwZWNpYWxseSBpZiB0aGUgbmFtZXMgb3IgZGVmaW5pdGlvbnMgb2YgdGhlIHBhcmFtZXRlcnMgYXJlIG5vdCB1bml2ZXJzYWxseSBhZ3JlZWQgdXBvbi4gIEFsd2F5cyBjaGVjayEifQ== 4.2 Tools for Model Selection In this section, you learn how to: Summarize the data graphically without reference to a parametric distribution Determine measures that summarize deviations of a parametric from a nonparametric fit Use nonparametric estimators to approximate parameters that can be used to start a parametric estimation procedure Video: Tools for Model Selection Overheads: Tools for Model Selection (Click Tab to View) A. Comparing Distribution and Density Functions B. PP Plot C. QQ Plot D. Goodness-of-Fit Test E. Kolmogorov-Smirnov Test F. Chi-Square (2) Test Hide Hide Hide Hide Hide Hide 4.2.1 Exercise. Probability-Probability (PP) plot Assignment Text Probability-Probability (PP) plots can be used to corroborate the selection of parametric models. The Wisconsin Property Fund data has already been read into a data frame called Insample and we created subset data which contains the positive loss data called positive_loss. In this tutorial, you will generate PP plots with Gaussian and Gamma distribution. Instructions. Please generate PP plots for the positive loss amount y using Gaussian and Gamma. Based on PP plots, which parametric fitted model is closer to the empirical distribution? Use the function glm(response~1,data=,family=Gamma(link=log)) to fit generalized linear model (GLM) with gamma family. Find shape and rate parameters from fitted gamma GLM. (No action required on your part) Use the function glm(response~1,data=,family=gaussian(link=log)) to fit generalized linear model (GLM) with Gaussian distribution. Find mean and standard deviation from fitted Gaussian GLM. (No action required on your part) Use the function ecdf() to create the empirical distribution for positive loss. Use the function pgamma() to create distribution function for the Gamma distribution. Use the function pnorm() to create distribution function for the Gaussian distribution. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly91cmxkZWZlbnNlLmNvbS92My9fX2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9PcGVuQWN0VGV4dERldi9MREFDb3Vyc2UxL21haW4vRGF0YS9JbnNhbXBsZS5jc3ZfXzshIURaM2ZqZyFyYXdoUzFhVklCU2M2V1NyeEZVcXhSN0ZTQnV5YlAxcWszb1RPNjFYYjlXT00zOU5TTWdZem5pRU5PMzljZlpZY2ckIFwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSlcbmxpYnJhcnkoTUFTUylcbnBvc2l0aXZlX2xvc3MgPC0gc3Vic2V0KEluc2FtcGxlLCB5PjApIiwic2FtcGxlIjoiIyBGaXQgZ2FtbWFcbmZpdF9nYW1tYSA8LSBnbG0oZm9ybXVsYT0/PywgZGF0YT0/PywgZmFtaWx5PUdhbW1hKGxpbms9bG9nKSlcbnRoZXRhIDwtIGV4cChjb2VmKGZpdF9nYW1tYSkpKmdhbW1hLmRpc3BlcnNpb24oZml0X2dhbW1hKSBcbmFscGhhIDwtIDEvZ2FtbWEuZGlzcGVyc2lvbihmaXRfZ2FtbWEpXG4jIEZpdCBHYXVzc2lhblxuZml0X2dhdXNzaWFuIDwtIGdsbShmb3JtdWxhPT8/LCBkYXRhPT8/LCBmYW1pbHk9Z2F1c3NpYW4obGluaz1sb2cpKVxubXUgPC0gZXhwKGNvZWYoZml0X2dhdXNzaWFuKSkgIFxuc2lnbWEgPC0gc3FydChzdW1tYXJ5KGZpdF9nYXVzc2lhbikkZGlzcGVyc2lvbikgXG4jIENyZWF0ZSBlbXBpcmljYWwgZGlzdHJpYnV0aW9uXG5lbXBpcmljYWwgPC0gPz9cbiMgZ2FtbWEgcHAgcGxvdFxuZ2FtbWEgPC0gcGdhbW1hKD8/LCBzaGFwZT1hbHBoYSwgc2NhbGU9dGhldGEpXG5wbG90KD8/LCBnYW1tYSwgeGxhYj1cIkVtcGlyaWNhbCBERlwiLCB5bGFiPVwiR2FtbWEgREZcIiwgY2V4PTEpXG5hYmxpbmUoMCwxKVxuIyBnYXVzc2lhbiBwcCBwbG90XG5nYXVzc2lhbiA8LSBwbm9ybSg/PywgbWVhbj1tdSwgc2Q9c2lnbWEpXG5wbG90KD8/LCBnYXVzc2lhbiwgeGxhYj1cIkVtcGlyaWNhbCBERlwiLCB5bGFiPVwiR2F1c3NpYW4gREZcIiwgY2V4PTEpXG5hYmxpbmUoMCwxKSIsInNvbHV0aW9uIjoiIyBGaXQgZ2FtbWFcbmZpdF9nYW1tYSA8LSBnbG0ocG9zaXRpdmVfbG9zcyR5fjEsIFxuICAgICAgICAgICAgICAgICBkYXRhPXBvc2l0aXZlX2xvc3MsIFxuICAgICAgICAgICAgICAgICBmYW1pbHk9R2FtbWEobGluaz1sb2cpKVxudGhldGEgPC0gZXhwKGNvZWYoZml0X2dhbW1hKSkqZ2FtbWEuZGlzcGVyc2lvbihmaXRfZ2FtbWEpICNtdT10aGV0YS9hbHBoYVxuYWxwaGEgPC0gMS9nYW1tYS5kaXNwZXJzaW9uKGZpdF9nYW1tYSlcblxuIyBGaXQgZ2F1c3NpYW5cbmZpdF9nYXVzc2lhbiA8LSBnbG0ocG9zaXRpdmVfbG9zcyR5fjEsIFxuICAgICAgICAgICAgICAgICBkYXRhPXBvc2l0aXZlX2xvc3MsIFxuICAgICAgICAgICAgICAgICBmYW1pbHk9Z2F1c3NpYW4obGluaz1sb2cpKVxubXUgPC0gZXhwKGNvZWYoZml0X2dhdXNzaWFuKSkgIyBvciBtZWFuKHBvc2l0aXZlX2xvc3MkeSlcbnNpZ21hIDwtIHNxcnQoc3VtbWFyeShmaXRfZ2F1c3NpYW4pJGRpc3BlcnNpb24pICMgb3Igc2QocG9zaXRpdmVfbG9zcyR5KSBzbGlnaHRseSBkaWZmZXJlbnRcblxuIyBDcmVhdCBlbXBpcmljYWwgZGlzdHJpYnV0aW9uXG5lbXBpcmljYWwgPC0gZWNkZihwb3NpdGl2ZV9sb3NzJHkpXG5cbiMgZ2FtbWEgcHAgcGxvdFxuZ2FtbWEgPC0gcGdhbW1hKHBvc2l0aXZlX2xvc3MkeSwgc2hhcGU9YWxwaGEsIHNjYWxlPXRoZXRhKVxucGxvdChlbXBpcmljYWwocG9zaXRpdmVfbG9zcyR5KSwgZ2FtbWEsICAjIGVtcGlyaWNhbCgpIHJldHVybnMgdGhlIHBlcmNlbnRpbGVzIGZvciBwb3NpdGl2ZV9sb3NzJHlcbiAgICAgeGxhYj1cIkVtcGlyaWNhbCBERlwiLCB5bGFiPVwiR2FtbWEgREZcIiwgY2V4PTEpXG5hYmxpbmUoMCwxKVxuXG4jIGdhdXNzaWFuIHBwIHBsb3RcbmdhdXNzaWFuIDwtIHBub3JtKHBvc2l0aXZlX2xvc3MkeSwgbWVhbj1tdSwgc2Q9c2lnbWEpXG5wbG90KGVtcGlyaWNhbChwb3NpdGl2ZV9sb3NzJHkpLCBnYXVzc2lhbiwgXG4gICAgIHhsYWI9XCJFbXBpcmljYWwgREZcIiwgeWxhYj1cIkdhdXNzaWFuIERGXCIsIGNleD0xKVxuYWJsaW5lKDAsMSkiLCJzY3QiOiJzdWNjZXNzX21zZyhcIkdvb2Qgam9iISBQUCBwbG90IGlzIGFibGUgdG8gY29tcGFyZSBjdW11bGF0aXZlIHByb2JhYmlsaXRpZXMgdW5kZXIgdHdvIG1vZGVscy4gR2FtbWEgaXMgY2xvc2VyIHRvIHRoZSBlbXBpcmljYWwgZGlzdHJpYnV0aW9uLlwiKSIsImhpbnQiOiJXZSBzaG93IHRoZSBjb2RlIHRoYXQgdXNlcyBHTE0gdG8gZmluZCBwYXJhbWV0ZXJzLiBTdGF5IHR1bmVkIGZvciBtb3JlIGRldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IEdMTSBpbiBsYXRlciBjaGFwdGVycy4ifQ== 4.2.2 Exercise. Quantile-Quantile (QQ) plot Assignment Text PP plot shows cumulative distribution functions, which can sometimes be difficult to detect where a fitted parametric distribution is deficient. As an alternative, it is common to use a quantile-quantile (QQ) plot. The Wisconsin Property Fund data has already been read into a data frame called Insample and we also created a subset data which included only positive loss data called positive_loss. In this tutorial, you will generate QQ plots with Gaussian and Gamma distribution. Instructions. Please generate QQ plots for the positive loss amount y using Gaussian and Gamma. Based on the QQ plot, which parametric fitted model is closer to the empirical distribution? Find sample size, mean, variance, and standard deviation for the positive loss. p_value is a list of probabilities, given here. Use the function qnorm() to create quantile function for the Gaussian distribution. Use the function qgamma() to create quantile function for the Gamma distribution. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly91cmxkZWZlbnNlLmNvbS92My9fX2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9PcGVuQWN0VGV4dERldi9MREFDb3Vyc2UxL21haW4vRGF0YS9JbnNhbXBsZS5jc3ZfXzshIURaM2ZqZyFyYXdoUzFhVklCU2M2V1NyeEZVcXhSN0ZTQnV5YlAxcWszb1RPNjFYYjlXT00zOU5TTWdZem5pRU5PMzljZlpZY2ckIFwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSlcblxucG9zaXRpdmVfbG9zcyA8LSBzdWJzZXQoSW5zYW1wbGUsIHk+MCkiLCJzYW1wbGUiOiIjIFNhbXBsZSBzaXplXG5uIDwtID8/XG4jIFBvc2l0aXZlIGxvc3MgbWVhblxubWVhbiA8LSA/P1xuIyBQb3NpdGl2ZSBsb3NzIHZhcmlhbmNlXG52YXJpYW5jZSA8LSA/P1xuIyBQb3NpdGl2ZSBsb3NzIHN0YW5kYXJkIHZhcmlhbmNlXG5zZCA8LSA/P1xuIyBQcm9iYWJpbGl0aWVzXG5wX3ZhbHVlcyA8LSBzZXEoMS8obisxKSwgbi8obisxKSwgYnk9MS8obisxKSlcbm5vcm1hbF9xdWFudGlsZXMgPC0gcW5vcm0oPz8pXG4jIEdhdXNzaWFuIFFRIFBsb3RcbnBsb3QoPz8sID8/LCB4bGFiID0gJ1RoZW9yZXRpY2FsIFF1YW50aWxlcyBmcm9tIEdhdXNzaWFuIERpc3RyaWJ1dGlvbicsIHlsYWIgPSAnU2FtcGxlIFF1YW50aWxlcyBvZiBQb3NpdGl2ZSBMb3NzJywgbWFpbiA9ICdHYXVzc2lhbiBRUSBQbG90IG9mIFBvc2l0aXZlIExvc3MnKVxuYWJsaW5lKDAsMSlcbmdhbW1hX3F1YW50aWxlcyA8LSBxZ2FtbWEoPz8pXG4jIEdhbW1hIFFRIFBsb3RcbnBsb3QoPz8sID8/LCB4bGFiID0gJ1RoZW9yZXRpY2FsIFF1YW50aWxlcyBmcm9tIEdhbW1hIERpc3RyaWJ1dGlvbicsIHlsYWIgPSAnU2FtcGxlIFF1YW50aWxlcyBvZiBQb3NpdGl2ZSBMb3NzJywgbWFpbiA9ICdHYW1tYSBRUSBQbG90IG9mIFBvc2l0aXZlIExvc3MnKVxuYWJsaW5lKDAsMSkiLCJzb2x1dGlvbiI6IiMgU2FtcGxlIHNpemVcbm4gPC0gbGVuZ3RoKHBvc2l0aXZlX2xvc3MkeSlcbiMgUG9zaXRpdmUgbG9zcyBtZWFuXG5tZWFuIDwtIG1lYW4ocG9zaXRpdmVfbG9zcyR5KVxuIyBQb3NpdGl2ZSBsb3NzIHZhcmlhbmNlXG52YXJpYW5jZSA8LSB2YXIocG9zaXRpdmVfbG9zcyR5KVxuIyBQb3NpdGl2ZSBsb3NzIHN0YW5kYXJkIHZhcmlhbmNlXG5zZCA8LSBzZChwb3NpdGl2ZV9sb3NzJHkpXG5cbiMgUHJvYmFiaWxpdGllc1xucF92YWx1ZXMgPC0gc2VxKDEvKG4rMSksIG4vKG4rMSksIGJ5PTEvKG4rMSkpXG5cbiMgQ2FsY3VsYXRlIEdhdXNzaWFuIHF1YW50aWxlcyB1c2luZyBtZWFuIGFuZCBzdGFuZGFyZCBkZXZpYXRpb24gZnJvbSBwb3NpdGl2ZSBsb3NzXG5ub3JtYWxfcXVhbnRpbGVzIDwtIHFub3JtKHBfdmFsdWVzLCBtZWFuLCBzZClcblxuIyBHYXVzc2lhbiBRUSBQbG90XG5wbG90KHNvcnQobm9ybWFsX3F1YW50aWxlcyksIFxuICAgICBzb3J0KHBvc2l0aXZlX2xvc3MkeSksIFxuICAgICB4bGFiID0gJ1RoZW9yZXRpY2FsIFF1YW50aWxlcyBmcm9tIEdhdXNzaWFuIERpc3RyaWJ1dGlvbicsIFxuICAgICB5bGFiID0gJ1NhbXBsZSBRdWFudGlsZXMgb2YgUG9zaXRpdmUgTG9zcycsIFxuICAgICBtYWluID0gJ0dhdXNzaWFuIFFRIFBsb3Qgb2YgUG9zaXRpdmUgTG9zcycpXG5hYmxpbmUoMCwxKVxuXG4jIENhbGN1bGF0ZSBHYW1tYSBxdWFudGlsZXMgdXNpbmcgbWVhbiBhbmQgc3RhbmRhcmQgZGV2aWF0aW9uIGZyb20gcG9zaXRpdmUgbG9zcyB0byBjYWxjdWxhdGUgc2hhcGUgYW5kIHNjYWxlIHBhcmFtZXRlcnNcbmdhbW1hX3F1YW50aWxlcyA8LSBxZ2FtbWEocF92YWx1ZXMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFwZSA9IG1lYW5eMi92YXJpYW5jZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlID0gdmFyaWFuY2UvbWVhbilcblxuIyBHYW1tYSBRUSBQbG90XG5wbG90KHNvcnQoZ2FtbWFfcXVhbnRpbGVzKSwgXG4gICAgIHNvcnQocG9zaXRpdmVfbG9zcyR5KSwgXG4gICAgIHhsYWIgPSAnVGhlb3JldGljYWwgUXVhbnRpbGVzIGZyb20gR2FtbWEgRGlzdHJpYnV0aW9uJywgXG4gICAgIHlsYWIgPSAnU2FtcGxlIFF1YW50aWxlcyBvZiBQb3NpdGl2ZSBMb3NzJywgXG4gICAgIG1haW4gPSAnR2FtbWEgUVEgUGxvdCBvZiBQb3NpdGl2ZSBMb3NzJylcbmFibGluZSgwLDEpIiwic2N0Ijoic3VjY2Vzc19tc2coXCJHb29kIGpvYiEgUVEgcGxvdCBjb21wYXJlcyB0d28gZml0dGVkIG1vZGVscyB0aHJvdWdoIHRoZWlyIHF1YW50aWxlcy4gQWdhaW4sIEdhbW1hIGlzIGJldHRlciBmaXQuXCIpIiwiaGludCI6IldlIGRpcmVjdGx5IHVzZWQgdGhlIHNhbXBsZSBtZWFuIGFuZCB2YXJpYW5jZSB0byBmaW5kIHBhcmFtZXRlcnMuIGkuZS4gR2F1c3NpYW4gcXVhbnRpbGVzIGlzIGNhbGN1bGF0ZWQgYmFzZWQgb24gbWVhbiBhbmQgc3RhbmRhcmQgZGV2aWF0aW9uIGZyb20gcG9zaXRpdmUgbG9zcy4ifQ== 4.2.3 Exercise. Kolmogorov-Smirnov test Assignment Text For reporting results, it can be effective to supplement the graphical displays with selected statistics that summarize model goodness of fit. The Wisconsin Property Fund data has already been read into a data frame called Insample. Previously, we also created a subset, positive_loss, which included only positive loss. Please perform Kolmogorov-Smirnov tests. Instructions. Compare the empirical positive loss amount y distribution to gamma distribution by performing the Kolmogorov-Smirnov test. Use the function ks.test to perform Kolmogorov-Smirnov test. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoTUFTUylcbmxpYnJhcnkoc3RhdHMpXG5cbkluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly91cmxkZWZlbnNlLmNvbS92My9fX2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9PcGVuQWN0VGV4dERldi9MREFDb3Vyc2UxL21haW4vRGF0YS9JbnNhbXBsZS5jc3ZfXzshIURaM2ZqZyFyYXdoUzFhVklCU2M2V1NyeEZVcXhSN0ZTQnV5YlAxcWszb1RPNjFYYjlXT00zOU5TTWdZem5pRU5PMzljZlpZY2ckIFwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSlcblxuIyBTdWJzZXQgZm9yIHBvc2l0aXZlIGxvc3NcbnBvc2l0aXZlX2xvc3MgPC0gc3Vic2V0KEluc2FtcGxlLCB5PjApXG5cbiMgRml0IGdhbW1hXG5maXRfZ2FtbWEgPC0gZ2xtKHBvc2l0aXZlX2xvc3MkeX4xLCBcbiAgICAgICAgICAgICAgICAgZGF0YT1wb3NpdGl2ZV9sb3NzLCBcbiAgICAgICAgICAgICAgICAgZmFtaWx5PUdhbW1hKGxpbms9bG9nKSlcbnRoZXRhIDwtIGV4cChjb2VmKGZpdF9nYW1tYSkpKmdhbW1hLmRpc3BlcnNpb24oZml0X2dhbW1hKSAjbXU9dGhldGEvYWxwaGFcbmFscGhhIDwtIDEvZ2FtbWEuZGlzcGVyc2lvbihmaXRfZ2FtbWEpXG5cbmdhbW1hIDwtIHBnYW1tYShwb3NpdGl2ZV9sb3NzJHksIHNoYXBlPWFscGhhLCBzY2FsZT10aGV0YSkiLCJzYW1wbGUiOiIjIFBlcmZvcm1zIEtvbG1vZ29yb3YtU21pcm5vdiB0ZXN0c1xua3MudGVzdCg/PywgXCJwZ2FtbWFcIiwgPz8sID8/KVxuXG4jIFBlcmZvcm1zIEtvbG1vZ29yb3YtU21pcm5vdiB0ZXN0c1xua3MudGVzdCg/PywgPz8pIiwic29sdXRpb24iOiIjIFBlcmZvcm1zIEtvbG1vZ29yb3YtU21pcm5vdiB0ZXN0c1xua3MudGVzdChwb3NpdGl2ZV9sb3NzJHksIFwicGdhbW1hXCIsIHRoZXRhLCBhbHBoYSlcblxuIyBQZXJmb3JtcyBLb2xtb2dvcm92LVNtaXJub3YgdGVzdHNcbmtzLnRlc3QocG9zaXRpdmVfbG9zcyR5LCBnYW1tYSkiLCJzY3QiOiJzdWNjZXNzX21zZyhcIkFjY29yZGluZyB0byB0aGUgS29sbW9nb3Jvdi1TbWlybm92IHRlc3QsIHRoZSB0d28gZGlzdHJpYnV0aW9uIGZ1bmN0aW9ucyBhcmUgbm90IGVxdWFsLiBXZSBoYXZlIHNlZW4gc29tZSBkZXZpYXRpb25zIGZyb20gdGhlIFFRIGdyYXBoIGFuZCBQUCBncmFwaC4gV2UgbmVlZCB0byBmaW5kIGEgYmV0dGVyIHBhcmFtZXRyaWMgbW9kZWwuXCIpIiwiaGludCI6IlRha2Ugc29tZSB0aW1lIHRvIGV4cGxvcmUgdGhlIG9ubGluZSA8Y29kZT5SPC9jb2RlPiBkb2N1bWVudGF0aW9uLiA8Y29kZT50aGV0YTwvY29kZT4sIDxjb2RlPmFscGhhPC9jb2RlPiwgYW5kIDxjb2RlPmdhbW1hPC9jb2RlPiBjYW4gYmUgZm91bmQgaW4gdGhlIHByZXZpb3VzIHF1ZXN0aW9uLiJ9 4.3 Model Selection: Likelihood Ratio Tests and Goodness of Fit Video: Likelihood Ratio Tests and Goodness of Fit Overheads: Likelihood Ratio Tests and Goodness of Fit (Click Tab to View) A. Likelihood Ratio Test B. Likelihood Ratio Test Process C. Information Criteria: Exam STAM Version D. Information Criteria: Alternative Version Hide Hide Hide Hide 4.4 Estimation using Modified Data: Nonparametric Approach In this section, you learn how to: Describe grouped and censored truncated data Estimate distributions nonparametrically based on grouped and censored data Video: Nonparametric Estimation using Modified Data Overheads: Nonparametric Estimation using Modified Data (Click Tab to View) A. Grouped Data B. Censored Data C. Kaplan-Meier Product Limit Estimator Hide Hide Hide 4.4.1 Exercise. Nonparametric Estimation using Modified Data Assignment Text Placing insurance deductibles generate truncated data (from the left), while policy limits produce censored data (from the right). The Wisconsin Property Fund data has already been read into a data frame called Insample. These data consist of claim experience for fund members over the years 2006-2010, inclusive. In addition, we created a subset data which included only positive loss data called positive_loss. Under hypothetical policy limit, 100000 USD, and deductible information, Deduct, in dataset, please find Kaplan-Meier Product Limit Estimator and the Nelson-Äalen estimator of the positive loss distribution function. Please plot the survival function accordingly. Instructions. Create the hypothetical policy limit, 100000 USD, and attach it to positive_loss data. Add actual payment column using dplyr data wrangling package. Add UnCensored column using the traditional method. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoTUFTUylcbmxpYnJhcnkoZHBseXIpXG5cbkluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly91cmxkZWZlbnNlLmNvbS92My9fX2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9PcGVuQWN0VGV4dERldi9MREFDb3Vyc2UxL21haW4vRGF0YS9JbnNhbXBsZS5jc3ZfXzshIURaM2ZqZyFyYXdoUzFhVklCU2M2V1NyeEZVcXhSN0ZTQnV5YlAxcWszb1RPNjFYYjlXT00zOU5TTWdZem5pRU5PMzljZlpZY2ckIFwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSlcblxuIyBTdWJzZXQgZm9yIHBvc2l0aXZlIGxvc3NcbnBvc2l0aXZlX2xvc3MgPC0gc3Vic2V0KEluc2FtcGxlLCB5PjApIiwic2FtcGxlIjoibGlicmFyeShkcGx5cilcbiMgQWRkIHBvbGljeSBsaW1pdCBmb3IgcG9zaXRpdmUgbG9zcyBkYXRhXG5wb3NpdGl2ZV9sb3NzJFBvbGljeUxpbWl0IDwtID8/XG5cbiMgQWRkIGFjdHVhbCBwYXltZW50IGNvbHVtbjogdXNpbmcgZHBseXIgXG5wb3NpdGl2ZV9sb3NzX2xpbWl0IDwtIHBvc2l0aXZlX2xvc3MgJT4lIHJvd3dpc2UoKSAlPiUgbXV0YXRlKEFtb3VudFBhaWQ9Pz8pXG5cbiMgQWRkIFVuQ2Vuc29yZWQgY29sdW1uOiB0cmFkaXRpb25hbCBtZXRob2RcbnBvc2l0aXZlX2xvc3NfbGltaXQkVW5DZW5zb3JlZCA8LSA/P1xuXG4jIFByaW50IGRhdGFzZXRcbmhlYWQoKSIsInNvbHV0aW9uIjoibGlicmFyeShkcGx5cilcblxuIyBBZGQgcG9saWN5IGxpbWl0IGZvciBwb3NpdGl2ZSBsb3NzIGRhdGFcbnBvc2l0aXZlX2xvc3MkUG9saWN5TGltaXQgPC0gMTAwMDAwXG5cbiMgQWRkIGFjdHVhbCBwYXltZW50IGNvbHVtbjogdXNpbmcgZHBseXIgXG5wb3NpdGl2ZV9sb3NzX2xpbWl0IDwtIHBvc2l0aXZlX2xvc3MgJT4lIHJvd3dpc2UoKSAlPiUgbXV0YXRlKEFtb3VudFBhaWQ9bWluKHksIFBvbGljeUxpbWl0KSlcblxuIyBBZGQgVW5DZW5zb3JlZCBjb2x1bW46IHRyYWRpdGlvbmFsIG1ldGhvZFxucG9zaXRpdmVfbG9zc19saW1pdCRVbkNlbnNvcmVkIDwtIDEqKHBvc2l0aXZlX2xvc3NfbGltaXQkQW1vdW50UGFpZCA8IHBvc2l0aXZlX2xvc3NfbGltaXQkUG9saWN5TGltaXQpXG5cbiMgUHJpbnQgZGF0YXNldFxuaGVhZChwb3NpdGl2ZV9sb3NzX2xpbWl0KSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiR2V0dGluZyBzdGFydGVkIGlzIGFsd2F5cyB0aGUgaGFyZGVzdCB0aGluZyB0byBkby4gRXhjZWxsZW50IHN0YXJ0ISBUaGVyZSBhcmUgbWFueSB3YXlzIHRvIGRvIGRhdGEgbWFuaXB1bGF0aW9uXCIpIiwiaGludCI6IldlIHdpbGwgdXNlIDxjb2RlPmRwbHlyPC9jb2RlPiBhbmQgdHJhZGl0aW9uYWwgbWV0aG9kcyB0byBwZXJmb3JtIGRhdGEgd3JhbmdsaW5nLiJ9 4.4.2 Exercise. Nonparametric Estimation using Modified Data II Instructions. Under hypothetical policy limit, 100000 USD, use the Kaplan-Meier product limit survfit() to estimate the survival function for the right-censored empirical distribution for the positive loss amount y. Under hypothetical policy limit, use the Nelson-Aalen estimate of the cumulative hazard function to obtain an estimate of the survival function for the right-censored empirical distribution for the positive loss amount y. Under hypothetical policy limit and deductible information, use the Nelson-Aalen estimate of the cumulative hazard function to obtain an estimate of the survival function for the left-truncated and right-censored empirical distribution function for the positive loss amount y. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoTUFTUylcbmxpYnJhcnkoZHBseXIpXG5saWJyYXJ5KHN1cnZpdmFsKSBcblxuSW5zYW1wbGUgPC0gcmVhZC5jc3YoXCJodHRwczovL3VybGRlZmVuc2UuY29tL3YzL19faHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdl9fOyEhRFozZmpnIXJhd2hTMWFWSUJTYzZXU3J4RlVxeFI3RlNCdXliUDFxazNvVE82MVhiOVdPTTM5TlNNZ1l6bmlFTk8zOWNmWlljZyQgXCIsIGhlYWRlcj1ULCBuYS5zdHJpbmdzPWMoXCIuXCIpLCBzdHJpbmdzQXNGYWN0b3JzPUZBTFNFKVxuXG4jIFN1YnNldCBmb3IgcG9zaXRpdmUgbG9zc1xucG9zaXRpdmVfbG9zcyA8LSBzdWJzZXQoSW5zYW1wbGUsIHk+MClcblxuIyBBZGQgcG9saWN5IGxpbWl0IGZvciBwb3NpdGl2ZSBsb3NzIGRhdGFcbnBvc2l0aXZlX2xvc3MkUG9saWN5TGltaXQgPC0gMTAwMDAwXG5cbiMgQWRkIGFjdHVhbCBwYXltZW50IGNvbHVtbjogdXNpbmcgZHBseXIgXG5wb3NpdGl2ZV9sb3NzX2xpbWl0IDwtIHBvc2l0aXZlX2xvc3MgJT4lIHJvd3dpc2UoKSAlPiUgbXV0YXRlKEFtb3VudFBhaWQ9bWluKHksIFBvbGljeUxpbWl0KSlcblxuIyBBZGQgVW5DZW5zb3JlZCBjb2x1bW46IHRyYWRpdGlvbmFsIG1ldGhvZFxucG9zaXRpdmVfbG9zc19saW1pdCRVbkNlbnNvcmVkIDwtIDEqKHBvc2l0aXZlX2xvc3NfbGltaXQkQW1vdW50UGFpZCA8IHBvc2l0aXZlX2xvc3NfbGltaXQkUG9saWN5TGltaXQpIiwic2FtcGxlIjoiIyBLTSBlc3RpbWF0ZVxuS00wIDwtIHN1cnZmaXQoPz8sIHR5cGU9XCJrYXBsYW4tbWVpZXJcIiwgZGF0YT0/PylcbiMgUGxvdCBmdW5jdGlvbiBzdXJ2aXZhbCBmdW5jdGlvblxucGxvdCg/PywgY29uZi5pbnQ9RkFMU0UsIHhsYWI9XCJ4XCIsIHlsYWI9XCJLYXBsYW4gTWVpZXIgU3Vydml2YWxcIilcbiMgTmVsc29uLUFhbGVuIGVzdGltYXRlXG5OQTAgPC0gc3VydmZpdCg/PywgdHlwZT0/PywgZGF0YT0/PylcbnBsb3QoPz8sIGNvbmYuaW50PUZBTFNFLCB4bGFiPVwieFwiLCB5bGFiPVwiTmVsc29uLUFhbGVuIFN1cnZpdmFsXCIpXG4jIE5lbHNvbi1BYWxlbiBlc3RpbWF0ZSB3aXRoIGRlZHVjdGlibGVcbk5BMSA8LSBzdXJ2Zml0KD8/KVxucGxvdCg/PywgY29uZi5pbnQ9RkFMU0UsIHhsYWI9XCJ4XCIsIHlsYWI9XCJOZWxzb24tQWFsZW4gU3Vydml2YWxcIikiLCJzb2x1dGlvbiI6IiMgS00gZXN0aW1hdGVcbktNMCA8LSBzdXJ2Zml0KFN1cnYoQW1vdW50UGFpZCwgVW5DZW5zb3JlZCkgfiAxLCB0eXBlPVwia2FwbGFuLW1laWVyXCIsIGRhdGE9cG9zaXRpdmVfbG9zc19saW1pdClcblxuIyBwbG90IGZ1bmN0aW9uIHN1cnZpdmFsIGZ1bmN0aW9uXG5wbG90KEtNMCwgY29uZi5pbnQ9RkFMU0UsIHhsYWI9XCJ4XCIsIHlsYWI9XCJLYXBsYW4gTWVpZXIgU3Vydml2YWxcIilcblxuIyBOZWxzb24tQWFsZW4gZXN0aW1hdGVcbk5BMCA8LSBzdXJ2Zml0KFN1cnYoQW1vdW50UGFpZCwgVW5DZW5zb3JlZCkgfiAxLCB0eXBlPVwiZmxlbWluZy1oYXJyaW5ndG9uXCIsIGRhdGE9cG9zaXRpdmVfbG9zc19saW1pdClcblxuIyBwbG90IGZ1bmN0aW9uIHN1cnZpdmFsIGZ1bmN0aW9uXG5wbG90KE5BMCwgY29uZi5pbnQ9RkFMU0UsIHhsYWI9XCJ4XCIsIHlsYWI9XCJOZWxzb24tQWFsZW4gU3Vydml2YWxcIilcblxuIyBOZWxzb24tQWFsZW4gZXN0aW1hdGUgd2l0aCBkZWR1Y3RpYmxlXG5OQTEgPC0gc3VydmZpdChTdXJ2KERlZHVjdCwgQW1vdW50UGFpZCwgVW5DZW5zb3JlZCkgfiAxLCB0eXBlPVwiZmxlbWluZy1oYXJyaW5ndG9uXCIsIGRhdGE9cG9zaXRpdmVfbG9zc19saW1pdClcblxuIyBwbG90IGZ1bmN0aW9uIHN1cnZpdmFsIGZ1bmN0aW9uXG5wbG90KE5BMSwgY29uZi5pbnQ9RkFMU0UsIHhsYWI9XCJ4XCIsIHlsYWI9XCJOZWxzb24tQWFsZW4gU3Vydml2YWxcIikiLCJzY3QiOiJzdWNjZXNzX21zZyhcIkV4Y2VsbGVudCEgIE5vdyB3ZSBjYW4gc2VlIGhvdyB0aGUgcG9saWN5IGxpbWl0IGFuZCBkZWR1Y3RpYmxlIGluZm9ybWF0aW9uIGNoYW5nZWQgc3Vydml2YWwgY3VydmUuXCIpIiwiaGludCI6IlRha2Ugc29tZSB0aW1lIHRvIGV4cGxvcmUgdGhlIG9ubGluZSA8Y29kZT5SPC9jb2RlPiBkb2N1bWVudGF0aW9uLjwvcD5cblxuPHA+VXNlIHRoZSBmdW5jdGlvbiBTdXJ2KCkgdG8gY3JlYXRlIHRoZSBlbXBpcmljYWwgZGlzdHJpYnV0aW9uLiJ9 4.5 Estimation using Modified Data: Parametric Approach In this section, you learn how to: Describe grouped and censored truncated data Estimate parametric distributions based on grouped, censored,and truncated data Video: Parametric Estimation using Modified Data Overheads: Parametric Estimation using Modified Data (Click Tab to View) A. Truncated Data B. Maximum Likelihood Estimation with Grouped Data C. Censored Data Likelihood I D. Censored Data Likelihood II E. Maximum Likelihood Estimation Using Censored and Truncated Data I F. Maximum Likelihood Estimation Using Censored and Truncated Data II Hide Hide Hide Hide Hide Hide 4.6 Bayesian Inference In this section, you learn how to: Describe the Bayesian model as an alternative to the frequentist approach and summarize the five components of this modeling approach. Summarize posterior distributions of parameters and use these posterior distributions to predict new outcomes. Use conjugate distributions to determine posterior distributions of parameters Video: Bayesian Inference Overheads: Bayesian Inference (Click Tab to View) A. Bayesian Inference B. Bayesian Inference Strengths C. Bayesian Model I D. Bayesian Model II E. Posterior Computation F. PoissonGamma Conjugate Family Hide Hide Hide Hide Hide Hide 4.6.1 Visualizing Bayesian Methods Assignment Text In this tutorial, we will visually explore the prior and posterior distributions from Example 4.4.1, and explore what would happen if we observed one more observation as well. Recall that for this problem, the prior distribution was \\[ \\pi(q) = q^3/0.07, \\hspace{5mm} 0.6 \\leq q \\leq 0.8. \\] two observations from a Bernoulli(q) were \\(X_1 = 1, X_2 = 0\\), and the posterior was found (Example 4.4.1) to be \\[ \\pi(q \\mid 1,0) = \\frac{q^4 - q^5}{0.014069}. \\] Instructions. Make a plot of the prior distribution Think about how you expect the observed data to reshape it to the posterior. Add the posterior and a legend to your plot, to confirm the influence of the observed data. This requires advanced commands such as lines and legend eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJxID0gc2VxKDAuNiwgMC44LCBieSA9IC4wMSlcbnByaW9yID0gPz9cbnBsb3QoPz8gLCA/PywgY29sPVwicmVkXCIsIHR5cGU9XCJsXCIsIHlsYWI9XCJcIikiLCJzb2x1dGlvbiI6InEgPSBzZXEoMC42LCAwLjgsIGJ5ID0gLjAxKVxucHJpb3IgPSBxXjMvMC4wN1xucGxvdChxLCBwcmlvciwgY29sPVwicmVkXCIsIHR5cGU9XCJsXCIsIHlsYWI9XCJcIikiLCJzY3QiOiJzdWNjZXNzX21zZyhcIkV4Y2VsbGVudCFcIikiLCJoaW50IjoiUmVjYWxsIHRoZSBtYXRoZW1hdGljYWwgZGVmaW5pdGlvbiBvZiB0aGUgcHJpb3IgZGVuc2l0eSBmdW5jdGlvbi4gIFBsb3QgdGhpcyBhZ2FpbnN0IHRoZSBzZXF1ZW5jZSBvZiBwYXJhbWV0ZXIgdmFsdWVzLiJ9 Notice that the prior distribution sets the support for \\(q\\), which is bounded between 0.6 and 0.8. The posterior will necessarily have this same support. Notice also that the prior distribution places more mass for larger values of \\(q\\). This is saying that prior to observing data, we think larger parameters values near 0.8 are more likely than smaller values near 0.6 The observed data has a claim in year 1 (\\(X_1 = 1\\)) and no claim in year 2 (\\(X_2 = 0\\)). So, we have two independent samples drawn from a Bernoulli(q), and \\(\\bar{X} = 0.5\\). If we were only using the likelihood and a method such as maximum likelihood estimation, we would estimate \\(\\widehat{q} = \\bar{X} = 0.5\\). So the data are telling us that values near \\(q=0.5\\) are consistent. But, Bayesian methods blend information from the data with information from the prior to produce a posterior. So, expect that our posterior distribution will place more mass towards smaller values of \\(q\\), and less towards larger values. Lets see if that is true. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJxID0gc2VxKDAuNiwgMC44LCBieSA9IC4wMSlcbj8/ID0gcV4zLzAuMDdcbnBvc3RlcmlvciA9ID8/XG5cbnBsb3QocSwgcHJpb3IsIGNvbD1cInJlZFwiLCB0eXBlPVwibFwiLCB5bGFiPVwiXCIpXG5saW5lcyhxLCA/PywgY29sPVwiYmx1ZVwiLCB0eXBlPVwibFwiLCBsdHk9MilcbmxlZ2VuZChcInRvcGxlZnRcIixsZWdlbmQ9YyhcIlByaW9yXCIsXCJQb3N0ZXJpb3JcIiksIGNvbD0/PywgbHR5PWMoMSwyKSkiLCJzb2x1dGlvbiI6InEgPSBzZXEoMC42LCAwLjgsIGJ5ID0gLjAxKVxucHJpb3IgPSBxXjMvMC4wN1xucG9zdGVyaW9yID0gKHFeNCAtIHFeNSkvMC4wMTQwNjlcblxucGxvdChxLCBwcmlvciwgY29sPVwicmVkXCIsIHR5cGU9XCJsXCIsIHlsYWI9XCJcIilcbmxpbmVzKHEsIHBvc3RlcmlvciwgY29sPVwiYmx1ZVwiLCB0eXBlPVwibFwiLCBsdHk9MilcbmxlZ2VuZChcInRvcGxlZnRcIixsZWdlbmQ9YyhcIlByaW9yXCIsXCJQb3N0ZXJpb3JcIiksIGNvbD1jKFwicmVkXCIsXCJibHVlXCIpLCBsdHk9YygxLDIpKSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiRXhjZWxsZW50ISAgTm93IHdlIGNhbiBzZWUgaG93IHRoZSBvYnNlcnZlZCBkYXRhIHNoaWZ0ZWQgb3VyIHVuZGVyc3RhbmRpbmcgb2YgdGhpcyB1bmtub3duIHBhcmFtdGVyLlwiKSIsImhpbnQiOiJNYWtlIHN1cmUgeW91IHVuZGVyc3RhbmQgd2hpY2ggaXMgdGhlIHByaW9yIGRlbnNpdHkgYW5kIHdoaWNoIGlzIHRoZSBwb3N0ZXJpb3IuICBBbHNvLCBtYWtlIHN1cmUgeW91IGFyZSBpbiB0aGUgaGFiaXQgb2Yga2VlcGluZyBjb2xvcnMgYW5kIGxpbmUgdHlwZXMgY29uc2lzdGVudCBpbiB5b3VyIHdvcmsuIn0= Indeed, the posterior has shifted the mass towards lower values, balancing what the data tell us and what the prior tells us. Since this is only two data points, the shift is not especially dramatic. Assignment Extension Lets continue with the prior example, but now imagine we next observe the third year, and there was again no claim, \\(X_3 = 0\\). We will compute the new posterior distribution, and compare it to the posterior in the previous problem. Instructions. Make a plot showing the original prior, posterior from example 4.1.1, and posterior for the new case. The posterior distribution after observing three data points is: \\[ \\pi(q \\mid 1,0,0) \\propto f(1\\mid q)f(0\\mid q)f(0\\mid q)\\pi(q) = q(1-q)(1-q)q^3 = q^4 - 2q^5 + q^6 \\] Recall the posterior is proportional to \\(q^4 - 2q^5 + q^6\\), so that means \\[ \\pi(q \\mid 1,0,0) = c \\left(q^4 - 2q^5 + q^6 \\right). \\] In order to find the normalizing constant \\(c\\), we would need to integrate this and make sure the integral is 1: \\[ \\begin{array}{ll} 1 &amp;= \\int_{q=0.6}^{0.8} c \\left(q^4 - 2q^5 + q^6\\right)dq\\\\ &amp;= c \\left(\\frac{1}{5}q^5 - \\frac{2}{6} q^6 +\\frac{1}{7} q^7 \\right) \\rvert_{q=0.6}^{q=0.8}\\\\ &amp;= c \\left( 0.0081 - 0.00400 \\right)\\\\ &amp;= c \\left(0.0041 \\right)\\\\ \\end{array} \\] Thus, we see the normalizing constant is \\(c = \\frac{1}{.0041}\\). We can now revisit the code and add the new posterior line: eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJxID0gc2VxKDAuNiwgMC44LCBieSA9IC4wMSlcbnByaW9yID0gcV4zLzAuMDdcbnBvc3Rlcmlvcl9vbGQgPSAocV40IC0gcV41KS8wLjAxNDA2OVxucG9zdGVyaW9yX25ldyA9ID8/XG5cbnBsb3QocSwgcHJpb3IsIGNvbD1cInJlZFwiLCB0eXBlPVwibFwiLCB5bGFiPVwiXCIpXG5saW5lcyhxLCBwb3N0ZXJpb3Jfb2xkLCBjb2w9XCJibHVlXCIsIHR5cGU9XCJsXCIsIGx0eT0yKVxubGluZXMocSwgcG9zdGVyaW9yX25ldywgY29sPVwiZ3JlZW5cIiwgdHlwZT1cImxcIiwgbHR5PTMpXG5sZWdlbmQoXCJ0b3BsZWZ0XCIsbGVnZW5kPWMoXCJQcmlvclwiLFwiT2xkIFBvc3RlcmlvclwiLFwiTmV3IFBvc3RlcmlvclwiKSwgY29sPWMoXCJyZWRcIixcImJsdWVcIiw/PyksIGx0eT1jKDEsMiwzKSkiLCJzb2x1dGlvbiI6InEgPSBzZXEoMC42LCAwLjgsIGJ5ID0gLjAxKVxucHJpb3IgPSBxXjMvMC4wN1xucG9zdGVyaW9yX29sZCA9IChxXjQgLSBxXjUpLzAuMDE0MDY5XG5wb3N0ZXJpb3JfbmV3ID0gKHFeNCAtIDIqcV41K3FeNikvMC4wMDQxXG5cbnBsb3QocSwgcHJpb3IsIGNvbD1cInJlZFwiLCB0eXBlPVwibFwiLCB5bGFiPVwiXCIpXG5saW5lcyhxLCBwb3N0ZXJpb3Jfb2xkLCBjb2w9XCJibHVlXCIsIHR5cGU9XCJsXCIsIGx0eT0yKVxubGluZXMocSwgcG9zdGVyaW9yX25ldywgY29sPVwiZ3JlZW5cIiwgdHlwZT1cImxcIiwgbHR5PTMpXG5sZWdlbmQoXCJ0b3BsZWZ0XCIsbGVnZW5kPWMoXCJQcmlvclwiLFwiT2xkIFBvc3RlcmlvclwiLFwiTmV3IFBvc3RlcmlvclwiKSwgY29sPWMoXCJyZWRcIixcImJsdWVcIixcImdyZWVuXCIpLCBsdHk9YygxLDIsMykpIiwic2N0Ijoic3VjY2Vzc19tc2coXCJOaWNlIVwiKSJ9 As expected, the new posterior has shifted even more mass towards lower parameter values in the posterior, since \\(\\bar{X} = \\frac{1}{3}\\) and the data are more consistent with low parameter values for \\(q\\). "],["aggregate-loss-models.html", "Chapter 5 Aggregate Loss Models 5.1 Introduction 5.2 Individual Risk Model 5.3 Collective Risk Model - Part I 5.4 Collective Risk Model - Part II 5.5 Tweedie Distribution 5.6 Effects of Coverage Modifications", " Chapter 5 Aggregate Loss Models Draft - Chapter Not Yet Complete Chapter description This chapter introduces probability models for describing the aggregate (total) claims that arise from a portfolio of insurance contracts. We present two standard modeling approaches, the individual risk model and the collective risk model. Further, we discuss strategies for computing the distribution of the aggregate claims, including exact methods for special cases, recursion, and simulation. Finally, we examine the effects of individual policy modifications such as deductibles, coinsurance, and inflation, on the frequency and severity distributions, and thus on the aggregate loss distribution. Although not needed to go through the tutorials, some users may wish to download the overheads used in the videos. Download Chapter Five overheads as a .pdf file. By watching the videos and working through the tutorial exercises, you will get an appreciation for aggregate loss models. For a deeper dive, see the corresponding chapter in the textbook, Chapter Five of Loss Data Analytics. 5.1 Introduction In this section, we learn how to: Record aggregated losses from an insurance system Identify actuarial applications of aggregate loss models Video: Introduction to Aggregate Loss Models Overheads: Introduction to Aggregate Loss Models (Click Tab to View) A. Basic Terminology B. Goal C. Models D. Example E. Applications Hide Hide Hide Hide Hide 5.2 Individual Risk Model In this section, we learn how to: Build an individual risk model for a portfolio of insurance contracts Apply individual risk model to life and nonlife insurance Compute the distribution of aggregate losses from an individual risk model Video: Individual Risk Model Overheads: Individual Risk Model (Click Tab to View) A. Individual Risk Model B. Applications C. Example D. Aggregate Loss Distribution E. R Example #1 F. R Example #2 Hide Hide Hide Hide Hide Hide 5.2.1 Exercise. Individual Risk Model I Assignment Text In this assignment, we will revisit Example 5.2.1 in the textbook and generate using simulation in R. Even though we will `officially start to work with simulation since Chapter 6, this exercise provides you an opportunity to taste a flavor of simulation with an example. Instructions Use the function rbinom() to simulate the number of claims that follow binomial distribution. For reproducibility of results, fix the random seed as 1000 and generate 10,000 observations of claim frequencies for each group of policies. Specify the size and probability when you simulate the number of claims with binomial distribution in each group of policies. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJzZXQuc2VlZChfX19fKSAgICAgXG5yICA8LSBfX19fICAgICAgICAgXG5xMSA8LSAwLjA1ICAgICAgICAgXG5xMiA8LSBfX19fICAgICAgICAgXG5uMSA8LSBfX19fICAgICAgICAgXG5uMiA8LSAyMDAgICAgICAgICAgXG5cbm4xIDwtIHJiaW5vbShyLCBzaXplPW4xLCBwcm9iPXExKSBcbm4yIDwtIHJiaW5vbShyLCBzaXplPV9fLCBwcm9iPV9fKSAiLCJzb2x1dGlvbiI6InNldC5zZWVkKDEwMDApICAgICAjIEZvciByZXByb2R1Y2liaWxpdHkgb2YgcmVzdWx0c1xuciAgPC0gMTAwMDAgICAgICAgICMgTnVtYmVyIG9mIG9ic2VydmF0aW9ucyB0byBzaW11bGF0ZSBmb3IgZWFjaCBwb2xpY3lcbnExIDwtIDAuMDUgICAgICAgICAjIFByb2JhYmlsaXR5IG9mIGNsYWltIGZyb20gcG9saWN5IDFcbnEyIDwtIDAuMDYgICAgICAgICAjIFByb2JhYmlsaXR5IG9mIGNsYWltIGZyb20gcG9saWN5IDJcbm4xIDwtIDEwMCAgICAgICAgICAjIE51bWJlciBvZiB0eXBlIDEgcG9saWNpZXNcbm4yIDwtIDIwMCAgICAgICAgICAjIE51bWJlciBvZiB0eXBlIDIgcG9saWNpZXNcblxuXG5uMSA8LSByYmlub20ociwgc2l6ZT1uMSwgcHJvYj1xMSkgIyBHZW5lcmF0ZSByPTEwMDAwIG9ic2VydmF0aW9ucyBvZiBOMSBmcm9tIEJpbm9taWFsXG5uMiA8LSByYmlub20ociwgc2l6ZT1uMiwgcHJvYj1xMikgIyBHZW5lcmF0ZSByPTEwMDAwIG9ic2VydmF0aW9ucyBvZiBOMiBmcm9tIEJpbm9taWFsIiwic2N0Ijoic3VjY2Vzc19tc2coXCJHb29kIGpvYiEgVGhpcyBleGVyY2lzZSBpcyBiYXNpY2FsbHkgYSByZWNhcGl0dWxhdGlvbiBvZiBDaGFwdGVyIDIgYnV0IHN0aWxsIHF1aXRlIGltcG9ydGFudCBhcyBvbmUgb2YgdGhlIGJ1aWxkaW5nIGJsb2NrcyBvZiBJbmRpdmlkdWFsIFJpc2sgTW9kZWxzLlwiKSIsImhpbnQiOiJOb3RlIHRoYXQgbnVtYmVyIG9mIHBvbGljaWVzIGFuZCBwcm9iYWJpbGl0eSBvZiBjbGFpbSBwZXIgcG9saWN5IGNvcnJlc3BvbmQgdG8gdGhlIHNpemUgYW5kIGluY2lkZW5jZSBwcm9iYWJpbGl0eSBpbiBhIGJpbm9taWFsIGRpc3RyaWJ1dGlvbiBmb3IgYSBjbGFpbSBmcmVxdWVuY3kgcmFuZG9tIHZhcmlhYmxlLCByZXNwZWN0aXZlbHkuIn0= 5.2.2 Exercise. Individual Risk Model II Assignment Text In this assignment, we will revisit Example 5.2.1 in the textbook and reproduce the theoretical results for moments calculation in individual risk models using simulation in R. We use the simulated frequencies for each group of policies in Exercise 5.5.2.1 and continue to simulate compound losses in an individual risk model as elaborated in Section 5.4.2. Instructions Use the function runif() to claim amounts that follow uniform distribution for each group of policies. Specify the parameters of uniform random variables, minimum and maximum values of claim amounts from each type of policies. Initialize an empty vector of length \\(r\\) to store \\(r\\) observations of simulated \\(S\\). In each simulation, calculate \\(j\\)th simulated aggregate loss and store it in \\(j\\)th component of \\(S\\) for \\(j=1, \\ldots, R\\). Compute mean and variance of \\(S\\) by simulation using mean() and var(), and compare these values to their corresponding theoretical values, 2,800 and 600,467, respectively. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEwMDApICAgICAjIEZvciByZXByb2R1Y2liaWxpdHkgb2YgcmVzdWx0c1xuciAgPC0gMTAwMDAgICAgICAgICMgTnVtYmVyIG9mIG9ic2VydmF0aW9ucyB0byBzaW11bGF0ZSBmb3IgZWFjaCBwb2xpY3lcbnExIDwtIDAuMDUgICAgICAgICAjIFByb2JhYmlsaXR5IG9mIGNsYWltIGZyb20gcG9saWN5IDFcbnEyIDwtIDAuMDYgICAgICAgICAjIFByb2JhYmlsaXR5IG9mIGNsYWltIGZyb20gcG9saWN5IDJcbm4xIDwtIDEwMCAgICAgICAgICAjIE51bWJlciBvZiB0eXBlIDEgcG9saWNpZXNcbm4yIDwtIDIwMCAgICAgICAgICAjIE51bWJlciBvZiB0eXBlIDIgcG9saWNpZXNcblxubjEgPC0gcmJpbm9tKHIsIHNpemU9bjEsIHByb2I9cTEpICMgR2VuZXJhdGUgcj0xMDAwMCBvYnNlcnZhdGlvbnMgb2YgTjEgZnJvbSBCaW5vbWlhbFxubjIgPC0gcmJpbm9tKHIsIHNpemU9bjIsIHByb2I9cTIpICMgR2VuZXJhdGUgcj0xMDAwMCBvYnNlcnZhdGlvbnMgb2YgTjIgZnJvbSBCaW5vbWlhbCIsInNhbXBsZSI6InNldC5zZWVkKDEwMDApICAgICBcbnIgIDwtIDEwMDAwICAgICAgICBcbm0xIDwtIDA7IE0xIDwtIF9fXyBcbm0yIDwtIF87IE0yIDwtIDMwMCBcblxuIyBuMTogR2VuZXJhdGVkIDEwMDAwIG9ic2VydmF0aW9ucyBvZiBjbGFpbSBmcmVxdWVuY3kgZnJvbSB0aGUgZmlyc3QgIGdyb3VwIG9mIHBvbGljaWVzIHdpdGggQmlub21pYWxcbiMgbjI6IEdlbmVyYXRlZCAxMDAwMCBvYnNlcnZhdGlvbnMgb2YgY2xhaW0gZnJlcXVlbmN5IGZyb20gdGhlIHNlY29uZCBncm91cCBvZiBwb2xpY2llcyB3aXRoIEJpbm9taWFsXG5cblMgPC0gcmVwKF9fLCByKSBcblxuZm9yKGogaW4gMTpyKSB7IFxuICB4MV9qIDwtIHJ1bmlmKG4xW2pdLCBtaW49bTEsIG1heD1fXylcbiAgeDJfaiA8LSBydW5pZihfX19fXywgbWluPV9fLCBtYXg9TTIpXG4gIFNbal0gPC0gc3VtKHgxX2opK3N1bShfX18pXG59XG5fX19fKFMpIFxudmFyKF8pICAiLCJzb2x1dGlvbiI6InNldC5zZWVkKDEwMDApICAgICAjIEZvciByZXByb2R1Y2liaWxpdHkgb2YgcmVzdWx0c1xuciAgPC0gMTAwMDAgICAgICAgICMgTnVtYmVyIG9mIG9ic2VydmF0aW9ucyB0byBzaW11bGF0ZSBmb3IgZWFjaCBwb2xpY3lcbm0xIDwtIDA7IE0xIDwtIDQwMCAjIFBhcmFtZXRlcnMgZm9yIHNldmVyaXR5IGRpc3RyaWJ1dGlvbiBYXzFcbm0yIDwtIDA7IE0yIDwtIDMwMCAjIFBhcmFtZXRlcnMgZm9yIHNldmVyaXR5IGRpc3RyaWJ1dGlvbiBYXzJcblxuIyBuMTogR2VuZXJhdGVkIDEwMDAwIG9ic2VydmF0aW9ucyBvZiBjbGFpbSBmcmVxdWVuY3kgZnJvbSB0aGUgZmlyc3QgIGdyb3VwIG9mIHBvbGljaWVzIHdpdGggQmlub21pYWxcbiMgbjI6IEdlbmVyYXRlZCAxMDAwMCBvYnNlcnZhdGlvbnMgb2YgY2xhaW0gZnJlcXVlbmN5IGZyb20gdGhlIHNlY29uZCBncm91cCBvZiBwb2xpY2llcyB3aXRoIEJpbm9taWFsXG5cblMgPC0gcmVwKE5BLCByKSAjIEluaXRpYWxpemUgYW4gZW1wdHkgdmVjdG9yIHRvIHN0b3JlIFMgb2JzZXJ2YXRpb25zXG5cblxuZm9yKGogaW4gMTpyKSB7IFxuICB4MV9qIDwtIHJ1bmlmKG4xW2pdLCBtaW49bTEsIG1heD1NMSlcbiAgeDJfaiA8LSBydW5pZihuMltqXSwgbWluPW0yLCBtYXg9TTIpXG4gIFNbal0gIDwtIHN1bSh4MV9qKStzdW0oeDJfaikgIyBDYWxjdWxhdGUganRoIHNpbXVsYXRlZCBhZ2dyZWdhdGUgbG9zcyBhbmQgc3RvcmUgaXQgYXQgU1tqXVxufVxuICBcbm1lYW4oUykgIyBDb21wYXJlIHRvIHRoZW9yZXRpY2FsIHZhbHVlIG9mIDIsODAwXG52YXIoUykgICMgQ29tcGFyZSB0byB0aGVvcmV0aWNhbCB2YWx1ZSBvZiA2MDAsNDY3Iiwic2N0Ijoic3VjY2Vzc19tc2coXCJHb29kIGpvYiEgTm90ZSB0aGF0IHNpbXVsYXRpb24gaXMgb25lIG9mIHRoZSBtb3N0IHBvd2VyZnVsIHRlY2huaXF1ZXMgaW4gbG9zcyBkYXRhIGFuYWx5dGljcyBzbyB3ZSBiZWxpZXZlIHRoaXMgZXhlcmNpc2UgaGVscGVkIHlvdSBhIGJpdCB0byBncm93IGFzIGFuIGV4cGVydCBpbiBsb3NzIGRhdGEgYW5hbHl0aWNzLlwiKSIsImhpbnQiOiJOb3RlIHRoYXQgd2UgbmVlZCB0byBzaW11bGF0ZSBjbGFpbSBhbW91bnRzIHRoYXQgY29ycmVzcG9uZHMgdG8gdGhlIG51bWJlciBvZiBjbGFpbXMgc28gdGhhdCB0aGUgcGFyYW1ldGVycyB1c2VkIGluIDxjb2RlPnJ1bmlmKCk8L2NvZGU+IGZ1bmN0aW9uIG1heSBkZXBlbmQgb24gdGhlIG51bWJlciBvZiBzaW11bGF0ZWQgY2xhaW1zLiJ9 5.3 Collective Risk Model - Part I In this section, we learn how to: Build a collective risk model for a portfolio of insurance contracts Calculate mean and variance of the aggregate loss Fit frequency and severity components in a collective risk model Video: Collective Risk Model - Part I Overheads: Collective Risk Model - Part I (Click Tab to View) A. Collective Risk Model B. Compound Distribution C. Moments D. Model Fitting E. Model Fitting - Property Fund Hide Hide Hide Hide Hide 5.3.1 Exercise. Collective Risk Model I Assignment Text In this assignment, we will fit a collective risk model for an actual portfolio of insurance contracts, LGPIF data with R. We use negative binomial and Pareto distributions for the frequency and severity components, respectively. Instructions Use the function optim() to find the maximum likelihood estimates of the frequency and severity distributions. For the likelihood of frequency component, we use dnbinom(). Note that we use the same parametrization as in the textbook so that \\(\\text{size}=r\\) and \\(\\text{prob}=1/(1+\\beta)\\). For the likelihood of severity component, we use dlomax(). Note that we use the same parametrization as in the textbook so that \\(\\text{shape}=\\alpha\\) and \\(\\text{scale}=\\theta\\). eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSlcbmxpYnJhcnkobG1lNClcblxuZGxvbWF4IDwtIGZ1bmN0aW9uKHgsIHNoYXBlPTEsIHNjYWxlPTEsIGxvZz1GQUxTRSkge1xuICBpZiAobG9nPT1GQUxTRSkgcmVzdWx0IDwtIHNoYXBlKnNjYWxlXnNoYXBlIC8gKHNjYWxlICsgeCleKHNoYXBlKzEpXG4gIGlmIChsb2c9PVRSVUUgKSByZXN1bHQgPC0gbG9nKHNoYXBlKStzaGFwZSpsb2coc2NhbGUpLShzaGFwZSsxKSpsb2coc2NhbGUgKyB4KVxuICByZXR1cm4ocmVzdWx0KSB9Iiwic2FtcGxlIjoiSW5zYW1wbGVUb3duIDwtIHN1YnNldChJbnNhbXBsZSwgVHlwZVRvd249PTEpXG5cbiMgVGhlIG5lZ2F0aXZlIGJpbm9taWFsIGZyZXF1ZW5jeSBtb2RlbDogTlxuTiA8LSBJbnNhbXBsZVRvd24kRnJlcVxuZnJlcV9saWsgPC0gZnVuY3Rpb24ocGFybSkge1xuICByICAgIDwtIHBhcm1bMV1cbiAgYmV0YSA8LSBwYXJtWzJdXG4gIGxpayAgPC0gLXN1bShkbmJpbm9tKE4sIHNpemU9XywgcHJvYj0xLygxK19fXyksIGxvZz1UUlVFKSlcbiAgcmV0dXJuKGxpaylcbn1cbmluaXQucGFybS5mcmVxIDwtIGMobWVhbihOKS8odmFyKE4pL21lYW4oTiktMSksIHZhcihOKS9tZWFuKE4pLTEpICMgaW5pdGlhbCBlc3RpbWF0ZXMgYnkgbWV0aG9kIG9mIG1vbWVudHNcbmZyZXFfbW9kICAgICAgIDwtIF9fX19fKHBhcj1pbml0LnBhcm0uZnJlcSwgZm49X19fKSAjIE1heGltdW0gbGlrZWxpaG9vZCBlc3RpbWF0aW9uIGZvciB0aGUgZnJlcXVlbmN5IG1vZGVsXG5cbnIuZXN0ICAgIDwtIGZyZXFfbW9kJHBhclsxXVxuYmV0YS5lc3QgPC0gZnJlcV9tb2QkcGFyWzJdXG5cbmZyZXFfdGFibGUgPC0gY2JpbmQodGFibGUoTilbMTo0XS9sZW5ndGgoTiksIGRuYmlub20oMDozLCBzaXplPV9fXywgcHJvYj0xLygxK2JldGEuZXN0KSkpXG5mcmVxX3RhYmxlIDwtIHJiaW5kKGZyZXFfdGFibGUsIDEtY29sU3VtcyhmcmVxX3RhYmxlKSlcbnJvd25hbWVzKGZyZXFfdGFibGUpWzVdIDwtIFwiNCtcIlxuY29sbmFtZXMoZnJlcV90YWJsZSkgICAgPC0gYyhcIkVtcGlyaWNhbFwiLCBcIlRoZW9yZXRpY2FsXCIpXG4jIEVtcGlyaWNhbCBhbmQgZml0dGVkIGRpc3RyaWJ1dGlvbnMgb2Ygb2JzZXJ2ZWQgTlxuZnJlcV90YWJsZVxuXG4jIFRoZSBQYXJldG8gc2V2ZXJpdHkgbW9kZWw6IFhiYXJcblhiYXIgPC0gSW5zYW1wbGVUb3duJHlBdmdbd2hpY2goSW5zYW1wbGVUb3duJEZyZXE+MCldXG5zZXZfbGlrIDwtIGZ1bmN0aW9uKHBhcm0pIHtcbiAgYWxwaGEgPC0gIHBhcm1bMV1cbiAgdGhldGEgPC0gIHBhcm1bMl1cbiAgbGlrICAgPC0gLXN1bShkbG9tYXgoWGJhciwgc2hhcGU9X19fLCBzY2FsZT1fX18sIGxvZz1UUlVFKSlcbiAgcmV0dXJuKGxpaylcbn1cbmluaXQucGFybS5zZXYgPC0gYyggMi8oMS1tZWFuKFhiYXIpXjIvdmFyKFhiYXIpKSAgLCBtZWFuKFhiYXIpKigyLygxLW1lYW4oWGJhcileMi92YXIoWGJhcikpLTEpICkgIyBpbml0aWFsIGVzdGltYXRlcyBieSBtZXRob2Qgb2YgbW9tZW50c1xuc2V2X21vZCAgICAgICA8LSBfX19fXyhwYXI9X19fLCBmbj1zZXZfbGlrLCBtZXRob2Q9XCJMLUJGR1MtQlwiKSAjIE1heGltdW0gbGlrZWxpaG9vZCBlc3RpbWF0aW9uIGZvciB0aGUgc2V2ZXJpdHkgbW9kZWxcbmFscGhhLmVzdCAgICAgPC0gc2V2X21vZCRwYXJbMV1cbnRoZXRhLmVzdCAgICAgPC0gc2V2X21vZCRwYXJbMl1cblxuIyBFbXBpcmljYWwgYW5kIGZpdHRlZCBkaXN0cmlidXRpb25zIG9mIG9ic2VydmVkIFhiYXJcbnBsb3QoMS0odGhldGEuZXN0Lyh0aGV0YS5lc3Qrc29ydChYYmFyKSkpXmFscGhhLmVzdCwgcmFuayhzb3J0KFhiYXIpKS8obGVuZ3RoKFhiYXIpKzEpLFxuICAgICB5bGFiID0gXCJFbXBpcmljYWwgUXVhbnRpbGVzXCIsIHhsYWIgPSBcIlRoZW9yZXRpY2FsIFF1YW50aWxlc1wiLFxuICAgICBtYWluID0gXCJTZXZlcml0eSBNb2RlbFwiKSIsInNvbHV0aW9uIjoiSW5zYW1wbGVUb3duIDwtIHN1YnNldChJbnNhbXBsZSwgVHlwZVRvd249PTEpXG5cbiMgVGhlIG5lZ2F0aXZlIGJpbm9taWFsIGZyZXF1ZW5jeSBtb2RlbDogTlxuTiA8LSBJbnNhbXBsZVRvd24kRnJlcVxuZnJlcV9saWsgPC0gZnVuY3Rpb24ocGFybSkge1xuICByICAgIDwtIHBhcm1bMV1cbiAgYmV0YSA8LSBwYXJtWzJdXG4gIGxpayAgPC0gLXN1bShkbmJpbm9tKE4sIHNpemU9ciwgcHJvYj0xLygxK2JldGEpLCBsb2c9VFJVRSkpXG4gIHJldHVybihsaWspXG59XG5pbml0LnBhcm0uZnJlcSA8LSBjKG1lYW4oTikvKHZhcihOKS9tZWFuKE4pLTEpLCB2YXIoTikvbWVhbihOKS0xKSAjIGluaXRpYWwgZXN0aW1hdGVzIGJ5IG1ldGhvZCBvZiBtb21lbnRzXG5mcmVxX21vZCAgICAgICA8LSBvcHRpbShwYXI9aW5pdC5wYXJtLmZyZXEsIGZuPWZyZXFfbGlrKSAjIE1heGltdW0gbGlrZWxpaG9vZCBlc3RpbWF0aW9uIGZvciB0aGUgZnJlcXVlbmN5IG1vZGVsXG5cbnIuZXN0ICAgIDwtIGZyZXFfbW9kJHBhclsxXVxuYmV0YS5lc3QgPC0gZnJlcV9tb2QkcGFyWzJdXG5cbmZyZXFfdGFibGUgPC0gY2JpbmQodGFibGUoTilbMTo0XS9sZW5ndGgoTiksIGRuYmlub20oMDozLCBzaXplPXIuZXN0LCBwcm9iPTEvKDErYmV0YS5lc3QpKSlcbmZyZXFfdGFibGUgPC0gcmJpbmQoZnJlcV90YWJsZSwgMS1jb2xTdW1zKGZyZXFfdGFibGUpKVxucm93bmFtZXMoZnJlcV90YWJsZSlbNV0gPC0gXCI0K1wiXG5jb2xuYW1lcyhmcmVxX3RhYmxlKSAgICA8LSBjKFwiRW1waXJpY2FsXCIsIFwiVGhlb3JldGljYWxcIilcbiMgRW1waXJpY2FsIGFuZCBmaXR0ZWQgZGlzdHJpYnV0aW9ucyBvZiBvYnNlcnZlZCBOXG5mcmVxX3RhYmxlXG5cbiMgVGhlIFBhcmV0byBzZXZlcml0eSBtb2RlbDogWGJhclxuWGJhciA8LSBJbnNhbXBsZVRvd24keUF2Z1t3aGljaChJbnNhbXBsZVRvd24kRnJlcT4wKV1cbnNldl9saWsgPC0gZnVuY3Rpb24ocGFybSkge1xuICBhbHBoYSA8LSAgcGFybVsxXVxuICB0aGV0YSA8LSAgcGFybVsyXVxuICBsaWsgICA8LSAtc3VtKGRsb21heChYYmFyLCBzaGFwZT1hbHBoYSwgc2NhbGU9dGhldGEsIGxvZz1UUlVFKSlcbiAgcmV0dXJuKGxpaylcbn1cbmluaXQucGFybS5zZXYgPC0gYyggMi8oMS1tZWFuKFhiYXIpXjIvdmFyKFhiYXIpKSAgLCBtZWFuKFhiYXIpKigyLygxLW1lYW4oWGJhcileMi92YXIoWGJhcikpLTEpICkgIyBpbml0aWFsIGVzdGltYXRlcyBieSBtZXRob2Qgb2YgbW9tZW50c1xuc2V2X21vZCAgICAgICA8LSBvcHRpbShwYXI9aW5pdC5wYXJtLnNldiwgZm49c2V2X2xpaywgbWV0aG9kPVwiTC1CRkdTLUJcIikgIyBNYXhpbXVtIGxpa2VsaWhvb2QgZXN0aW1hdGlvbiBmb3IgdGhlIHNldmVyaXR5IG1vZGVsXG5hbHBoYS5lc3QgICAgIDwtIHNldl9tb2QkcGFyWzFdXG50aGV0YS5lc3QgICAgIDwtIHNldl9tb2QkcGFyWzJdXG5cbiMgRW1waXJpY2FsIGFuZCBmaXR0ZWQgZGlzdHJpYnV0aW9ucyBvZiBvYnNlcnZlZCBYYmFyXG5wbG90KDEtKHRoZXRhLmVzdC8odGhldGEuZXN0K3NvcnQoWGJhcikpKV5hbHBoYS5lc3QsIHJhbmsoc29ydChYYmFyKSkvKGxlbmd0aChYYmFyKSsxKSxcbiAgICAgeWxhYiA9IFwiRW1waXJpY2FsIFF1YW50aWxlc1wiLCB4bGFiID0gXCJUaGVvcmV0aWNhbCBRdWFudGlsZXNcIixcbiAgICAgbWFpbiA9IFwiU2V2ZXJpdHkgTW9kZWxcIikiLCJzY3QiOiJzdWNjZXNzX21zZyhcIkNoZWVycyEgTm90ZSB0aGF0IHdlIHVzdWFsbHkgYWRkIGNvdmFyaWF0ZXMgaW4gdGhlIGZyZXF1ZW5jeSBhbmQgc2V2ZXJpdHkgbW9kZWxzIGZvciByaXNrIGNsYXNzaWZpY2F0aW9uIHB1cnBvc2UgaW4gcHJhY3RpY2UuXCIpIiwiaGludCI6IlNpbmNlIDxlbT5vcHRpbTwvZW0+IG1pbmltaXplcyBnaXZlbiBmdW5jdGlvbiBieSBkZWZhdWx0LCB3ZSBwdXQgdGhlIG5lZ2F0aXZlIGxpa2VsaWhvb2QgYXMgYW4gb2JqZWN0aXZlIGZ1bmN0aW9uIHRvIGJlIG1pbmltaXplZC4ifQ== 5.4 Collective Risk Model - Part II In this section, we learn how to: Compute the aggregate loss distribution Implement numerical strategies in R Video: Collective Risk Model - Part II Overheads: Collective Risk Model - Part II (Click Tab to View) A. Computing the Aggregate Loss Distribution B. Direct Calculation C. Direct Calculation - R Code D. Recursive Method E. Recursive Method - R Code F. Monte Carlo Simulation Hide Hide Hide Hide Hide Hide 5.4.1 Exercise. Collective Risk Model II Assignment Text In this assignment, we will analyze aggregate loss distribution by combining fitted frequency and severity components. Since it is usually very hard to obtain a closed form of distribution function of the compound loss in a collective risk model, we rely on simulations to compute the aggregate loss distribution. Instructions We use the fitted frequency and severity models using LGPIF data as we have done in Tutorial 5.3, with negative binomial and Pareto distributions, respectively. To generate random samples from the fitted frequency and severity models, we use rnbinom() and rlomax(). Note that these generated random samples are used as inputs to compute the aggregate claim amount distribution. We use aggregateDist() to simulate compound losses that match the observed data upon the fitted frequency and severity models. It is an important task in order to visualize the distribution of compound losses and make subsequent decisions on ratemaking. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSlcbmxpYnJhcnkobG1lNClcblxuYWdncmVnYXRlLnBvcnRmb2xpbyA8LSBmdW5jdGlvbih4LCBieSA9IG5hbWVzKHgkbm9kZXMpLCBGVU4gPSBzdW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzaWZpY2F0aW9uID0gVFJVRSwgcHJlZml4ID0gTlVMTCwgLi4uKVxue1xuICAgIGxldmVsLm5hbWVzIDwtIG5hbWVzKHgkbm9kZXMpICAgICAgICMgbGV2ZWwgbmFtZXNcbiAgICBubGV2ZWxzIDwtIGxlbmd0aChsZXZlbC5uYW1lcykgICAgICAjIG51bWJlciBvZiBsZXZlbHNcbiAgICB5ZWFycyA8LSBsZXZlbC5uYW1lc1tubGV2ZWxzXSAgICAgICAjIG5hbWUgb2YgbGFzdCBsZXZlbFxuXG4gICAgIyMgTWF0Y2ggbGV2ZWwgbmFtZXMgaW4gJ2J5JyB0byB0aG9zZSBpbiB0aGUgbW9kZWxcbiAgICBieSA8LSBtYXRjaC5hcmcoYnksIGxldmVsLm5hbWVzLCBzZXZlcmFsLm9rID0gVFJVRSlcblxuICAgICMjIFZlcnNpb24gb2YgRlVOIGFibGUgdG8gd29yayBvbiBsaXN0c1xuICAgIGZ1biA8LSBmdW5jdGlvbih4LCAuLi4pIEZVTih1bmxpc3QoeCksIC4uLilcblxuICAgICMjIFRoZSBtb3N0IGNvbW1vbiBjYXNlIHNob3VsZCBiZSB0byBhZ2dyZWdhdGUgY2xhaW0gYW1vdW50cyBieVxuICAgICMjIG5vZGUuIFRoaXMgY2FzZSBiZWluZyB2ZXJ5IHNpbXBsZSwgaXQgaXMgdHJlYXRlZCBzZXBhcmF0ZWx5LlxuICAgIGlmIChpZGVudGljYWwoYnksIGxldmVsLm5hbWVzKSlcbiAgICAgICAgcmV0dXJuKGNiaW5kKGlmIChjbGFzc2lmaWNhdGlvbikgeCRjbGFzc2lmaWNhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgIGFycmF5KHNhcHBseSh4JGRhdGEsIEZVTiwgLi4uKSwgZGltKHgkZGF0YSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBkaW1uYW1lcyA9IGxpc3QoTlVMTCwgcGFzdGUocHJlZml4LCBjb2xuYW1lcyh4JGRhdGEpLCBzZXAgPSBcIlwiKSkpKSlcblxuICAgICMjIFN1bW1hcmllcyBvbmx5IGJ5IGxhc3QgbGV2ZWwgKHllYXJzKSBhcmUgYWxzbyBzaW1wbGUgdG8gaGFuZGxlLlxuICAgIGlmIChpZGVudGljYWwoYnksIHllYXJzKSlcbiAgICB7XG4gICAgICAgIHJlcyA8LSBhcHBseSh4JGRhdGEsIDIsIGZ1biwgLi4uKVxuICAgICAgICBuYW1lcyhyZXMpIDwtIHBhc3RlKHByZWZpeCwgY29sbmFtZXMoeCRkYXRhKSwgc2VwID0gXCJcIilcbiAgICAgICAgcmV0dXJuKHJlcylcbiAgICB9XG5cbiAgICAjIyBUaGUgb3RoZXIgcG9zc2liaWxpdGllcyByZXF1aXJlIHRvIHNwbGl0IHRoZSBkYXRhIGluIGdyb3VwcyBhc1xuICAgICMjIHNwZWNpZmllZCBpbiBhcmd1bWVudCAnYnknLiBJZiB0aGUgbGFzdCBsZXZlbCAoeWVhcnMpIGlzIGluXG4gICAgIyMgJ2J5JywgdGhlbiB0aGUgbWF0cml4IHN0cnVjdHVyZSBtdXN0IGJlIHJldGFpbmVkIHRvIG1ha2UgdGhlXG4gICAgIyMgc3VtbWFyaWVzLiBPdGhlcndpc2UsIGl0IGNhbiBqdXN0IGJlIGRyb3BwZWQgc2luY2Ugc3VtbWFyaWVzXG4gICAgIyMgd2lsbCBzcGFuIHRoZSB5ZWFycyBvZiBvYnNlcnZhdGlvbi5cbiAgICAjI1xuICAgICMjIENvbnZlcnQgdGhlIHNlcXVlbmNlIG9mIHN1YnNjcmlwdHMgaW50byBmYWN0b3JzIGJ5IHBhc3RpbmcgdGhlXG4gICAgIyMgZGlnaXRzIHRvZ2V0aGVyLiBJdCBpcyBpbXBvcnRhbnQgKm5vdCogdG8gc29ydCB0aGUgbGV2ZWxzIGluXG4gICAgIyMgY2FzZSB0aGUgbGV2ZWxzIGluICdieScgYXJlIG5vdCBpbiB0aGUgc2FtZSBvcmRlciBhcyBpblxuICAgICMjICdsZXZlbC5uYW1lcycuXG4gICAgcm93cyA8LSBzZXRkaWZmKGJ5LCB5ZWFycykgICAgICAgICAgIyBncm91cHMgb3RoZXIgdGhhbiB5ZWFyc1xuICAgIHMgPC0geCRjbGFzc2lmaWNhdGlvblssIHJvd3MsIGRyb3AgPSBGQUxTRV0gIyBzdWJzY3JpcHRzXG4gICAgZiA8LSBhcHBseShzLCAxLCBwYXN0ZSwgY29sbGFwc2UgPSBcIlwiKSAgICAgICMgZ3JvdXBpbmcgSURzXG4gICAgZiA8LSBmYWN0b3IoZiwgbGV2ZWxzID0gdW5pcXVlKGYpKSAgICAgICAgICAjIGZhY3RvcnNcbiAgICBzIDwtIHNbbWF0Y2gobGV2ZWxzKGYpLCBmKSwgLCBkcm9wID0gRkFMU0VdICMgdW5pcXVlIHN1YnNjcmlwdHNcbiAgICB4eCA8LSBzcGxpdCh4JGRhdGEsIGYpICAgICAgICAgICAgICAgICAgICAgICMgc3BsaXQgZGF0YVxuXG4gICAgIyMgTWFrZSBzdW1tYXJpZXNcbiAgICBpZiAoeWVhcnMgJWluJSBieSlcbiAgICB7XG4gICAgICAgIHh4IDwtIGxhcHBseSh4eCwgbWF0cml4LCBuY29sID0gbmNvbCh4JGRhdGEpKVxuICAgICAgICByZXMgPC0gdChzYXBwbHkoeHgsIGZ1bmN0aW9uKHgsIC4uLikgYXBwbHkoeCwgMiwgZnVuLCAuLi4pLCAuLi4pKVxuICAgICAgICBjb2xzIDwtIGNvbG5hbWVzKHgkZGF0YSlcbiAgICB9XG4gICAgZWxzZVxuICAgIHtcbiAgICAgICAgcmVzIDwtIHNhcHBseSh4eCwgZnVuLCAuLi4pXG4gICAgICAgIGNvbHMgPC0gZGVwYXJzZShzdWJzdGl0dXRlKEZVTikpXG4gICAgfVxuXG4gICAgIyMgUmV0dXJuIHJlc3VsdHMgYXMgYSBtYXRyaXhcbiAgICBzdHJ1Y3R1cmUoY2JpbmQoaWYgKGNsYXNzaWZpY2F0aW9uKSBzLCByZXMpLFxuICAgICAgICAgICAgICBkaW1uYW1lcyA9IGxpc3QoTlVMTCwgYyhpZiAoY2xhc3NpZmljYXRpb24pIHJvd3MsIHBhc3RlKHByZWZpeCwgY29scywgc2VwID0gXCJcIikpKSlcbn1cblxuc2ltUyA8LSBmdW5jdGlvbihuLCBtb2RlbC5mcmVxLCBtb2RlbC5zZXYpXG57XG4gIFxuICAgIG49MTAwMFxuICAgIG1vZGVsLmZyZXEgPSBmcmVxXG4gICAgbW9kZWwuc2V2ID0gc2V2XG4gICAgXG4gICAgIyMgUHJlcGFyZSB0aGUgY2FsbCB0byBzaW11bCgpIGJ5IGJ1aWxkaW5nIHVwICdub2RlcydcbiAgICBsZXZlbC5uYW1lcyA8LSBuYW1lcyhpZiAoaXMubnVsbChtb2RlbC5mcmVxKSkgbW9kZWwuc2V2IGVsc2UgbW9kZWwuZnJlcSlcbiAgICBubGV2ZWxzIDwtIGxlbmd0aChsZXZlbC5uYW1lcylcbiAgICBub2RlcyA8LSBhcy5saXN0KGMocmVwKDEsIG5sZXZlbHMgLSAxKSwgbikpXG4gICAgbmFtZXMobm9kZXMpIDwtIGxldmVsLm5hbWVzXG5cbiAgICAjIyBHZXQgc2FtcGxlXG4gICAgeCA8LSBhZ2dyZWdhdGUoc2ltdWwobm9kZXMgPSBub2RlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5mcmVxID0gbW9kZWwuZnJlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5zZXYgPSBtb2RlbC5zZXYpKVstMV1cblxuICAgICMjIENvbXB1dGUgdGhlIGVtcGlyaWNhbCBjZGYgb2YgdGhlIHNhbXBsZS4gRG9uZSBtYW51YWxseSBpbnN0ZWFkXG4gICAgIyMgb2YgY2FsbGluZyBzdGF0czo6OmVjZGYoKSB0byBrZWVwIGEgY29weSBvZiB0aGUgZW1waXJpY2FsIHBtZlxuICAgICMjIGluIHRoZSBlbnZpcm9ubWVudCB3aXRob3V0IGNvbXB1dGluZyBpdCB0d2ljZS5cbiAgICB4IDwtIHNvcnQoeClcbiAgICB2YWxzIDwtIHVuaXF1ZSh4KVxuICAgIGZzIDwtIHRhYnVsYXRlKG1hdGNoKHgsIHZhbHMpKS9sZW5ndGgoeClcbiAgICBGVU4gPC0gYXBwcm94ZnVuKHZhbHMsIHBtaW4oY3Vtc3VtKGZzKSwgMSksIG1ldGhvZCA9IFwiY29uc3RhbnRcIixcbiAgICAgICAgICAgICAgICAgICAgIHlsZWZ0ID0gMCwgeXJpZ2h0ID0gMSwgZiA9IDAsIHRpZXMgPSBcIm9yZGVyZWRcIilcbiAgICBjbGFzcyhGVU4pIDwtIGMoXCJlY2RmXCIsIFwic3RlcGZ1blwiLCBjbGFzcyhGVU4pKVxuICAgIGFzc2lnbihcImZzXCIsIGZzLCBlbnZpciA9IGVudmlyb25tZW50KEZVTikpXG4gICAgRlVOXG59XG5cbmFnZ3JlZ2F0ZURpc3QgPC1cbiAgICBmdW5jdGlvbihtZXRob2QgPSBjKFwicmVjdXJzaXZlXCIsIFwiY29udm9sdXRpb25cIiwgXCJub3JtYWxcIiwgXCJucG93ZXJcIiwgXCJzaW11bGF0aW9uXCIpLFxuICAgICAgICAgICAgIG1vZGVsLmZyZXEgPSBOVUxMLCBtb2RlbC5zZXYgPSBOVUxMLCBwMCA9IE5VTEwsIHguc2NhbGUgPSAxLFxuICAgICAgICAgICAgIGNvbnZvbHZlID0gMCwgbW9tZW50cywgbmIuc2ltdWwsIC4uLixcbiAgICAgICAgICAgICB0b2wgPSAxZS0wNiwgbWF4aXQgPSA1MDAsIGVjaG8gPSBGQUxTRSlcbntcbiAgICBDYWxsIDwtIG1hdGNoLmNhbGwoKVxuXG4gICAgIyMgVGhlIG1ldGhvZCB1c2VkIGVzc2VudGlhbGx5IHRlbGxzIHdoaWNoIGZ1bmN0aW9uIHNob3VsZCBiZVxuICAgICMjIGNhbGxlZCBmb3IgdGhlIGNhbGN1bGF0aW9uIG9mIHRoZSBhZ2dyZWdhdGUgY2xhaW1zXG4gICAgIyMgZGlzdHJpYnV0aW9uLlxuICAgIG1ldGhvZCA8LSBtYXRjaC5hcmcobWV0aG9kKVxuXG4gICAgaWYgKG1ldGhvZCA9PSBcIm5vcm1hbFwiKVxuICAgIHtcbiAgICAgICAgIyMgQW4gZXJyb3IgbWVzc2FnZSBpcyBpc3N1ZWQgaWYgdGhlIG51bWJlciBvZiBtb21lbnRzIGxpc3RlZFxuICAgICAgICAjIyBpcyBub3QgYXBwcm9wcmlhdGUgZm9yIHRoZSBtZXRob2QuIEhvd2V2ZXIgaXQgaXMgdGhlIHVzZXInc1xuICAgICAgICAjIyByZXNwb25zYWJpbGl0eSB0byBsaXN0IHRoZSBtb21lbnRzIGluIHRoZSBjb3JyZWN0IG9yZGVyXG4gICAgICAgICMjIHNpbmNlIHRoZSB2ZWN0b3IgaXMgbm90IHJlcXVpcmVkIHRvIGJlIG5hbWVkLlxuICAgICAgICBpZiAobWlzc2luZyhtb21lbnRzKSB8fCBsZW5ndGgobW9tZW50cykgPCAyKVxuICAgICAgICAgICAgc3RvcChcIidtb21lbnRzJyBtdXN0IHN1cHBseSB0aGUgbWVhbiBhbmQgdmFyaWFuY2Ugb2YgdGhlIGRpc3RyaWJ1dGlvblwiKVxuICAgICAgICBGVU4gPC0gbm9ybWFsKG1vbWVudHNbMV0sIG1vbWVudHNbMl0pXG4gICAgICAgIGNvbW1lbnQoRlVOKSA8LSBcIk5vcm1hbCBhcHByb3hpbWF0aW9uXCJcbiAgICB9XG5cbiAgICBlbHNlIGlmIChtZXRob2QgPT0gXCJucG93ZXJcIilcbiAgICB7XG4gICAgICAgIGlmIChtaXNzaW5nKG1vbWVudHMpIHx8IGxlbmd0aChtb21lbnRzKSA8IDMpXG4gICAgICAgICAgICBzdG9wKFwiJ21vbWVudHMnIG11c3Qgc3VwcGx5IHRoZSBtZWFuLCB2YXJpYW5jZSBhbmQgc2tld25lc3Mgb2YgdGhlIGRpc3RyaWJ1dGlvblwiKVxuICAgICAgICBGVU4gPC0gbnBvd2VyKG1vbWVudHNbMV0sIG1vbWVudHNbMl0sIG1vbWVudHNbM10pXG4gICAgICAgIGNvbW1lbnQoRlVOKSA8LSBcIk5vcm1hbCBQb3dlciBhcHByb3hpbWF0aW9uXCJcbiAgICB9XG4gICAgZWxzZSBpZiAobWV0aG9kID09IFwic2ltdWxhdGlvblwiKVxuICAgIHtcbiAgICAgICAgaWYgKG1pc3NpbmcobmIuc2ltdWwpKVxuICAgICAgICAgICAgc3RvcChcIiduYi5zaW11bCcgbXVzdCBzdXBwbHkgdGhlIG51bWJlciBvZiBzaW11bGF0aW9uc1wiKVxuICAgICAgICBpZiAoaXMubnVsbChuYW1lcyhtb2RlbC5mcmVxKSkgJiYgaXMubnVsbChuYW1lcyhtb2RlbC5zZXYpKSlcbiAgICAgICAgICAgIHN0b3AoXCJleHByZXNzaW9ucyBpbiAnbW9kZWwuZnJlcScgYW5kICdtb2RlbC5zZXYnIG11c3QgYmUgbmFtZWRcIilcbiAgICAgICAgRlVOIDwtIHNpbVMobmIuc2ltdWwsIG1vZGVsLmZyZXEgPSBtb2RlbC5mcmVxLCBtb2RlbC5zZXYgPSBtb2RlbC5zZXYpXG4gICAgICAgIGNvbW1lbnQoRlVOKSA8LSBcIkFwcHJveGltYXRpb24gYnkgc2ltdWxhdGlvblwiXG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgICMjIFwicmVjdXJzaXZlXCIgYW5kIFwiY29udm9sdXRpb25cIiBjYXNlcy4gQm90aCByZXF1aXJlIGFcbiAgICAgICAgIyMgZGlzY3JldGUgZGlzdHJpYnV0aW9uIG9mIGNsYWltIGFtb3VudHMsIHRoYXQgaXMgYSB2ZWN0b3Igb2ZcbiAgICAgICAgIyMgcHJvYmFiaWxpdGllcyBpbiBhcmd1bWVudCAnbW9kZWwuc2V2Jy5cbiAgICAgICAgaWYgKCFpcy5udW1lcmljKG1vZGVsLnNldikpXG4gICAgICAgICAgICBzdG9wKFwiJ21vZGVsLnNldicgbXVzdCBiZSBhIHZlY3RvciBvZiBwcm9iYWJpbGl0aWVzXCIpXG5cbiAgICAgICAgIyMgUmVjdXJzaXZlIG1ldGhvZCB1c2VzIGEgbW9kZWwgZm9yIHRoZSBmcmVxdWVuY3kgZGlzdHJpYnV0aW9uLlxuICAgICAgICBpZiAobWV0aG9kID09IFwicmVjdXJzaXZlXCIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChpcy5udWxsKG1vZGVsLmZyZXEpIHx8ICFpcy5jaGFyYWN0ZXIobW9kZWwuZnJlcSkpXG4gICAgICAgICAgICAgICAgc3RvcChcImZyZXF1ZW5jeSBkaXN0cmlidXRpb24gbXVzdCBiZSBzdXBwbGllZCBhcyBhIGNoYXJhY3RlciBzdHJpbmdcIilcbiAgICAgICAgICAgIGRpc3QgPC0gbWF0Y2guYXJnKHRvbG93ZXIobW9kZWwuZnJlcSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjKFwicG9pc3NvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImdlb21ldHJpY1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5lZ2F0aXZlIGJpbm9taWFsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYmlub21pYWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsb2dhcml0aG1pY1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInplcm8tdHJ1bmNhdGVkIHBvaXNzb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ6ZXJvLXRydW5jYXRlZCBnZW9tZXRyaWNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ6ZXJvLXRydW5jYXRlZCBuZWdhdGl2ZSBiaW5vbWlhbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInplcm8tdHJ1bmNhdGVkIGJpbm9taWFsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiemVyby1tb2RpZmllZCBsb2dhcml0aG1pY1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInplcm8tbW9kaWZpZWQgcG9pc3NvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInplcm8tbW9kaWZpZWQgZ2VvbWV0cmljXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiemVyby1tb2RpZmllZCBuZWdhdGl2ZSBiaW5vbWlhbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInplcm8tbW9kaWZpZWQgYmlub21pYWxcIikpXG4gICAgICAgICAgICBGVU4gPC0gcGFuamVyKGZ4ID0gbW9kZWwuc2V2LCBkaXN0ID0gZGlzdCwgcDAgPSBwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgeC5zY2FsZSA9IHguc2NhbGUsIC4uLiwgY29udm9sdmUgPSBjb252b2x2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdG9sID0gdG9sLCBtYXhpdCA9IG1heGl0LCBlY2hvID0gZWNobylcbiAgICAgICAgICAgIGNvbW1lbnQoRlVOKSA8LSBcIlJlY3Vyc2l2ZSBtZXRob2QgYXBwcm94aW1hdGlvblwiXG4gICAgICAgIH1cblxuICAgICAgICAjIyBDb252b2x1dGlvbiBtZXRob2QgcmVxdWlyZXMgYSB2ZWN0b3Igb2YgcHJvYmFiaWxpdGVzIGluXG4gICAgICAgICMjIGFyZ3VtZW50ICdtb2RlbC5mcmVxJy5cbiAgICAgICAgZWxzZSBpZiAobWV0aG9kID09IFwiY29udm9sdXRpb25cIilcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFpcy5udW1lcmljKG1vZGVsLmZyZXEpKVxuICAgICAgICAgICAgICAgIHN0b3AoXCInbW9kZWwuZnJlcScgbXVzdCBiZSBhIHZlY3RvciBvZiBwcm9iYWJpbGl0aWVzXCIpXG4gICAgICAgICAgICBGVU4gPC0gZXhhY3QoZnggPSBtb2RlbC5zZXYsIHBuID0gbW9kZWwuZnJlcSwgeC5zY2FsZSA9IHguc2NhbGUpXG4gICAgICAgICAgICBjb21tZW50KEZVTikgPC0gXCJFeGFjdCBjYWxjdWxhdGlvbiAoY29udm9sdXRpb25zKVwiXG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgc3RvcChcImludGVybmFsIGVycm9yXCIpXG4gICAgfVxuXG4gICAgIyMgUmV0dXJuIGN1bXVsYXRpdmUgZGlzdHJpYnV0aW9uIGZ1bmN0aW9uXG4gICAgY2xhc3MoRlVOKSA8LSBjKFwiYWdncmVnYXRlRGlzdFwiLCBjbGFzcyhGVU4pKVxuICAgIGF0dHIoRlVOLCBcImNhbGxcIikgPC0gQ2FsbFxuICAgIEZVTlxuICAgIH1cblxuXG5wbG90LmFnZ3JlZ2F0ZURpc3QgPC0gZnVuY3Rpb24oeCwgeGxpbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5bGFiID0gZXhwcmVzc2lvbihGW1NdKHgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWluID0gXCJBZ2dyZWdhdGUgQ2xhaW0gQW1vdW50IERpc3RyaWJ1dGlvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YiA9IGNvbW1lbnQoeCksIC4uLilcbntcbiAgICAjIyBGdW5jdGlvbiBwbG90KCkgaXMgdXNlZCBmb3IgdGhlIHN0ZXAgY2RmcyBhbmQgZnVuY3Rpb24gY3VydmUoKVxuICAgICMjIGluIHRoZSBjb250aW51b3VzIGNhc2VzLlxuICAgIGlmIChcInN0ZXBmdW5cIiAlaW4lIGNsYXNzKHgpKVxuICAgIHtcbiAgICAgICAgIyMgTWV0aG9kIGZvciBjbGFzcyAnZWNkZicgd2lsbCBtb3N0IHByb2JhYmx5IGJlIHVzZWQuXG4gICAgICAgIE5leHRNZXRob2QobWFpbiA9IG1haW4sIHlsYWIgPSB5bGFiLCAuLi4pXG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgICMjIExpbWl0cyBmb3IgdGhlIHgtYXhpcyBhcmUgc3VwcGxpZWQgaWYgbm9uZSBhcmUgZ2l2ZW5cbiAgICAgICAgIyMgaW4gYXJndW1lbnQuXG4gICAgICAgIGlmIChtaXNzaW5nKHhsaW0pKVxuICAgICAgICB7XG4gICAgICAgICAgICBtZWFuIDwtIGdldChcIm1lYW5cIiwgZW52aXIgPSBlbnZpcm9ubWVudCh4KSlcbiAgICAgICAgICAgIHNkIDwtIHNxcnQoZ2V0KFwidmFyaWFuY2VcIiwgZW52aXIgPSBlbnZpcm9ubWVudCh4KSkpXG4gICAgICAgICAgICB4bGltIDwtIGMobWVhbiAtIDMgKiBzZCwgbWVhbiArIDMgKiBzZClcbiAgICAgICAgfVxuICAgICAgICBjdXJ2ZSh4LCBtYWluID0gbWFpbiwgeWxhYiA9IHlsYWIsIHhsaW0gPSB4bGltLCB5bGltID0gYygwLCAxKSwgLi4uKVxuICAgIH1cbiAgICBtdGV4dChzdWIsIGxpbmUgPSAwLjUpXG59XG5cbnNpbXVsIDwtIGZ1bmN0aW9uKG5vZGVzLCBtb2RlbC5mcmVxID0gTlVMTCwgbW9kZWwuc2V2ID0gTlVMTCwgd2VpZ2h0cyA9IE5VTEwpXG57XG4gICAgIyMgR2V0IGxldmVsIG5hbWVzLiBFYWNoIGNvdWxkIGJlIE5VTEwuXG4gICAgbGV2ZWwubmFtZXMgPC0gbmFtZXMobm9kZXMpXG4gICAgZnJlcS5uYW1lcyA8LSBuYW1lcyhtb2RlbC5mcmVxKVxuICAgIHNldi5uYW1lcyA8LSBuYW1lcyhtb2RlbC5zZXYpXG5cbiAgICAjIyAnbm9kZXMnIG11c3QgYmUgYSBuYW1lZCBsaXN0LiBPbmUgZXhjZXB0aW9uIGlzIGFsbG93ZWQ6IHRoZXJlXG4gICAgIyMgaXMgb25seSBvbmUgbGV2ZWwuIEluIHRoaXMgY2FzZSwgYWRkIGEgcHJlZGV0ZXJtaW5lZCBuYW1lIGlmXG4gICAgIyMgdGhlcmUgaXNuJ3Qgb25lIGFscmVhZHkgYW5kIG1ha2Ugc3VyZSAnbm9kZXMnIGlzIGEgbGlzdC5cbiAgICBpZiAobGVuZ3RoKG5vZGVzKSA9PSAxTClcbiAgICB7XG4gICAgICAgIGlmIChpcy5udWxsKGxldmVsLm5hbWVzKSlcbiAgICAgICAgICAgIG5hbWVzKG5vZGVzKSA8LSBcIlhcIlxuICAgICAgICBub2RlcyA8LSBhcy5saXN0KG5vZGVzKVxuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICBpZiAoIWlzLmxpc3Qobm9kZXMpIHx8IGlzLm51bGwobGV2ZWwubmFtZXMpKVxuICAgICAgICAgICAgc3RvcChcIidub2RlcycgbXVzdCBiZSBhIG5hbWVkIGxpc3RcIilcbiAgICB9XG5cbiAgICAjIyBEZXRlcm1pbmUgaWYgZnJlcXVlbmN5IGFuZCBzZXZlcml0eSBtb2RlbHMgYXJlIHByZXNlbnQuIEtlZXBcbiAgICAjIyBmb3IgZnV0dXJlIHVzZS5cbiAgICBoYXMuZnJlcSA8LSAhYWxsKHNhcHBseShtb2RlbC5mcmVxLCBpcy5udWxsKSlcbiAgICBoYXMuc2V2ICA8LSAhYWxsKHNhcHBseShtb2RlbC5zZXYsIGlzLm51bGwpKVxuXG4gICAgIyMgQ2hlY2sgdGhhdCBhdCBsZWFzdCBvbmUgb2YgJ21vZGVsLmZyZXEnIG9yICdtb2RlbC5zZXYnIGlzXG4gICAgIyMgcHJlc2VudCBhbmQgdGhhdCB0aGUgbGV2ZWwgbmFtZXMgbWF0Y2ggd2l0aCB0aG9zZSBvZiAnbm9kZXMnLlxuICAgICMjIFBlcmhhcHMgaXMgdGhlcmUgYSBmYW5jaWVyIHdheSB0byBkbyBhbGwgdGhlc2UgdGVzdHMsIGJ1dCB0aGVcbiAgICAjIyB2ZXJzaW9uIGJlbG93IGlzIGF0IGxlYXN0IGVhc3kgdG8gZm9sbG93LlxuICAgIGlmIChoYXMuZnJlcSlcbiAgICB7XG4gICAgICAgIGlmIChoYXMuc2V2KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoISAoaWRlbnRpY2FsKGxldmVsLm5hbWVzLCBmcmVxLm5hbWVzKSAmJlxuICAgICAgICAgICAgICAgICAgIGlkZW50aWNhbChsZXZlbC5uYW1lcywgc2V2Lm5hbWVzKSkpXG4gICAgICAgICAgICAgICAgc3RvcChcImxldmVsIG5hbWVzIGRpZmZlcmVudCBpbiAnbm9kZXMnLCAnbW9kZWwuZnJlcScgYW5kICdtb2RlbC5zZXYnXCIpXG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIWlkZW50aWNhbChsZXZlbC5uYW1lcywgZnJlcS5uYW1lcykpXG4gICAgICAgICAgICAgICAgc3RvcChcImxldmVsIG5hbWVzIGRpZmZlcmVudCBpbiAnbm9kZXMnLCAnbW9kZWwuZnJlcScgYW5kICdtb2RlbC5zZXYnXCIpXG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZVxuICAgIHtcbiAgICAgICAgaWYgKGhhcy5zZXYpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghaWRlbnRpY2FsKGxldmVsLm5hbWVzLCBzZXYubmFtZXMpKVxuICAgICAgICAgICAgICAgIHN0b3AoXCJsZXZlbCBuYW1lcyBkaWZmZXJlbnQgaW4gJ25vZGVzJywgJ21vZGVsLmZyZXEnIGFuZCAnbW9kZWwuc2V2J1wiKVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHN0b3AoXCJvbmUgb2YgJ21vZGVsLmZyZXEnIG9yICdtb2RlbC5zZXYnIG11c3QgYmUgbm9uLU5VTExcIilcbiAgICB9XG5cbiAgICAjIyBUaGUgZnVuY3Rpb24gaXMgd3JpdHRlbiBmb3IgbW9kZWxzIHdpdGggYXQgbGVhc3QgdHdvIGxldmVsc1xuICAgICMjIChlbnRpdHkgYW5kIHllYXIpLiBJZiB0aGVyZSBpcyBvbmx5IG9uZSwgYWRkIGEgZHVtbXkgbGV2ZWwgdG9cbiAgICAjIyBhdm9pZCBzY2F0dGVyaW5nIHRoZSBjb2RlIHdpdGggY29uZGl0aW9ucy5cbiAgICBpZiAobGVuZ3RoKG5vZGVzKSA8IDJMKVxuICAgIHtcbiAgICAgICAgbm9kZXMgPC0gYyhub2RlID0gMSwgbm9kZXMpXG4gICAgICAgIG1vZGVsLmZyZXEgPC1cbiAgICAgICAgICAgIGlmIChoYXMuZnJlcSkgYyhleHByZXNzaW9uKG5vZGUgPSBOVUxMKSwgbW9kZWwuZnJlcSkgZWxzZSBOVUxMXG4gICAgICAgIG1vZGVsLnNldiA8LVxuICAgICAgICAgICAgaWYgKGhhcy5zZXYpIGMoZXhwcmVzc2lvbihub2RlID0gTlVMTCksIG1vZGVsLnNldikgZWxzZSBOVUxMXG4gICAgfVxuXG4gICAgIyMgRnJlcXVlbnRseSB1c2VkIHF1YW50aXRpZXNcbiAgICBsZXZlbC5uYW1lcyA8LSBuYW1lcyhub2RlcykgICAgICAgICAjIG5lZWQgdG8gcmVzZXQhXG4gICAgbmxldmVscyA8LSBsZW5ndGgobm9kZXMpICAgICAgICAgICAgIyBudW1iZXIgb2YgbGV2ZWxzXG5cbiAgICAjIyBSZWN5Y2xpbmcgb2YgdGhlIG51bWJlciBvZiBub2RlcyAoaWYgbmVlZGVkKSBtdXN0IGJlIGRvbmVcbiAgICAjIyBcIm1hbnVhbGx5XCIuIFdlIGRvIGl0IGhlcmUgb25jZSBhbmQgZm9yIGFsbCBzaW5jZSBpbiBhbnkgY2FzZVxuICAgICMjIGJlbG93IHdlIHdpbGwgbmVlZCB0byBrbm93IHRoZSB0b3RhbCBudW1iZXIgb2Ygbm9kZXMgaW4gdGhlXG4gICAgIyMgcG9ydGZvbGlvLiBGdXJ0aGVybW9yZSwgdGhlIHJlY3ljbGVkIGxpc3QgJ25vZGVzJyB3aWxsIGJlXG4gICAgIyMgcmV0dXJuZWQgYnkgdGhlIGZ1bmN0aW9uLlxuICAgIGZvciAoaSBpbiAyTDpubGV2ZWxzKSAgICAgICAjIGZpcnN0IG5vZGUgZG9lc24ndCBuZWVkIHJlY3ljbGluZ1xuICAgICAgICBub2Rlc1tbaV1dIDwtIHJlcChub2Rlc1tbaV1dLCBsZW5ndGggPSBzdW0obm9kZXNbW2kgLSAxTF1dKSlcblxuICAgICMjIFNpbXVsYXRpb24gb2YgdGhlIGZyZXF1ZW5jeSBtaXhpbmcgcGFyYW1ldGVycyBmb3IgZWFjaCBsZXZlbFxuICAgICMjIChlLmcuIGNsYXNzLCBjb250cmFjdCkgYW5kLCBhdCB0aGUgbGFzdCBsZXZlbCwgdGhlIGFjdHVhbFxuICAgICMjIGZyZXF1ZW5jaWVzLiBJZiAnbW9kZWwuZnJlcScgaXMgTlVMTCwgdGhpcyBpcyBlcXVpdmFsZW50IHRvXG4gICAgIyMgaGF2aW5nIG9uZSBjbGFpbSBwZXIgbm9kZS5cbiAgICBpZiAoaGFzLmZyZXEpXG4gICAge1xuICAgICAgICAjIyBOb3JtYWxseSwgb25seSB0aGUgaW1tZWRpYXRlbHkgYWJvdmUgbWl4aW5nIHBhcmFtZXRlciB3aWxsXG4gICAgICAgICMjIGJlIHVzZWQgaW4gdGhlIG1vZGVsIGZvciBhIGxldmVsLCBidXQgdGhlIGNvZGUgaGVyZSBhbGxvd3NcbiAgICAgICAgIyMgZm9yIG1vcmUgZ2VuZXJhbCBzY2hlbWVzLiBGb3IgdGhpcyB0byB3b3JrLCBhbGwgbWl4aW5nXG4gICAgICAgICMjIHBhcmFtZXRlcnMgaGF2ZSB0byBiZSBjb3JyZWN0bHkgcmVjeWNsZWQgYXQgZWFjaCBsZXZlbFxuICAgICAgICAjIyB3aGVyZSB0aGV5ICpjb3VsZCogYmUgdXNlZC4gU2luY2UgdGhlIG1vZGVsIGF0IGFueSBsZXZlbFxuICAgICAgICAjIyBjb3VsZCBiZSBOVUxMLCAncGFyYW1zJyB3aWxsIGtlZXAgdHJhY2sgb2YgdGhlIG1peGluZ1xuICAgICAgICAjIyBwYXJhbWV0ZXJzIHRoYXQgd2VyZSBzaW11bGF0ZWQgaW4gcHJldmlvdXMgaXRlcmF0aW9uIG9mIHRoZVxuICAgICAgICAjIyBmb3J0aGNvbWluZyBsb29wLlxuICAgICAgICBwYXJhbXMgPC0gY2hhcmFjdGVyKDApXG5cbiAgICAgICAgZm9yIChpIGluIHNlcV9sZW4obmxldmVscykpXG4gICAgICAgIHtcbiAgICAgICAgICAgICMjIE51bWJlciBvZiBub2RlcyBhdCB0aGUgY3VycmVudCBsZXZlbFxuICAgICAgICAgICAgbi5jdXJyZW50IDwtIG5vZGVzW1tpXV1cblxuICAgICAgICAgICAgIyMgRXh0cmFjdCBzaW11bGF0aW9uIG1vZGVsIGZvciB0aGUgbGV2ZWwuXG4gICAgICAgICAgICBDYWxsIDwtIG1vZGVsLmZyZXFbW2ldXVxuXG4gICAgICAgICAgICAjIyBSZXBlYXQgdGhlIG1peGluZyBwYXJhbWV0ZXJzIG9mIGFsbCBsZXZlbHMgYWJvdmUgdGhlXG4gICAgICAgICAgICAjIyBjdXJyZW50IG9uZSB0aGF0IHdlcmUgc2ltdWxhdGVkIGluIHRoZSBwYXN0LlxuICAgICAgICAgICAgZm9yIChqIGluIHNlcV9hbG9uZyhwYXJhbXMpKVxuICAgICAgICAgICAgICAgIGV2YWwoc3Vic3RpdHV0ZSh4IDwtIHJlcC5pbnQoeCwgbi5jdXJyZW50KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCh4ID0gYXMubmFtZShwYXJhbXNbW2pdXSkpKSlcblxuICAgICAgICAgICAgIyMgU2ltdWxhdGUgZGF0YSBvbmx5IGlmIHRoZXJlIGlzIGEgbW9kZWwgYXQgdGhlIGN1cnJlbnRcbiAgICAgICAgICAgICMjIGxldmVsLlxuICAgICAgICAgICAgaWYgKCFpcy5udWxsKENhbGwpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICMjIEFkZCB0aGUgbnVtYmVyIG9mIHZhcmlhdGVzIHRvIHRoZSBjYWxsLlxuICAgICAgICAgICAgICAgIENhbGwkbiA8LSBzdW0obi5jdXJyZW50KVxuXG4gICAgICAgICAgICAgICAgIyMgU2ltdWxhdGlvbiBvZiB0aGUgbWl4aW5nIHBhcmFtZXRlcnMgb3IgdGhlIGRhdGEuIEluXG4gICAgICAgICAgICAgICAgIyMgdGhlIGxhdHRlciBjYXNlLCBzdG9yZSB0aGUgcmVzdWx0cyBpbiBhIGZpeGVkXG4gICAgICAgICAgICAgICAgIyMgdmFyaWFibGUgbmFtZS5cbiAgICAgICAgICAgICAgICBpZiAoaSA8IG5sZXZlbHMpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBhc3NpZ24obGV2ZWwubmFtZXNbW2ldXSwgZXZhbChDYWxsKSlcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zW2ldIDwtIGxldmVsLm5hbWVzW1tpXV0gIyByZW1lbWJlciB0aGUgcGFyYW1ldGVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgZnJlcXVlbmNpZXMgPC0gZXZhbChDYWxsKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2VcbiAgICAgICAgZnJlcXVlbmNpZXMgPC0gcmVwLmludCgxLCBzdW0obm9kZXNbW25sZXZlbHNdXSkpXG5cbiAgICAjIyBTaW11bGF0aW9uIG9mIHRoZSBjbGFpbSBhbW91bnRzLiBJZiAnbW9kZWwuc2V2JyBpcyBOVUxMLCB0aGlzXG4gICAgIyMgaXMgZXF1aXZhbGVudCB0byBzaW11bGF0aW5nIGZyZXF1ZW5jaWVzIG9ubHkuXG4gICAgaWYgKGhhcy5zZXYpXG4gICAge1xuICAgICAgICAjIyBSZXBlYXQgdGhlIHNhbWUgcHJvY2VkdXJlIGFzIGZvciB0aGUgZnJlcXVlbmN5IG1vZGVsLCB3aXRoXG4gICAgICAgICMjIG9uZSBkaWZmZXJlbmNlOiB3aGVuIHJlYWNoaW5nIHRoZSBsYXN0IGxldmVsIChjbGFpbVxuICAgICAgICAjIyBhbW91bnRzKSwgdGhlIG51bWJlciBvZiB2YXJpYXRlcyB0byBzaW11bGF0ZSBpcyBub3QgZ2l2ZW5cbiAgICAgICAgIyMgYnkgdGhlIG51bWJlciBvZiBub2RlcyBidXQgcmF0aGVyIGJ5IHRoZSBudW1iZXIgb2YgY2xhaW1zXG4gICAgICAgICMjIGFzIGZvdW5kIGluICdmcmVxdWVuY2llcycuXG4gICAgICAgIHBhcmFtcyA8LSBjaGFyYWN0ZXIoMClcblxuICAgICAgICBmb3IgKGkgaW4gc2VxX2xlbihubGV2ZWxzKSlcbiAgICAgICAge1xuICAgICAgICAgICAgbi5jdXJyZW50IDwtIG5vZGVzW1tpXV1cbiAgICAgICAgICAgIENhbGwgPC0gbW9kZWwuc2V2W1tpXV1cblxuICAgICAgICAgICAgZm9yIChqIGluIHNlcV9hbG9uZyhwYXJhbXMpKVxuICAgICAgICAgICAgICAgIGV2YWwoc3Vic3RpdHV0ZSh4IDwtIHJlcC5pbnQoeCwgbi5jdXJyZW50KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCh4ID0gYXMubmFtZShwYXJhbXNbW2pdXSkpKSlcblxuICAgICAgICAgICAgaWYgKCFpcy5udWxsKENhbGwpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICMjIFRoZSByZXN0IG9mIHRoZSBwcm9jZWR1cmUgZGlmZmVycyBkZXBlbmRpbmcgaWYgd2VcbiAgICAgICAgICAgICAgICAjIyBhcmUgc3RpbGwgc2ltdWxhdGluZyBtaXhpbmcgcGFyYW1ldGVycyBvciBjbGFpbVxuICAgICAgICAgICAgICAgICMjIGFtb3VudHMuXG4gICAgICAgICAgICAgICAgaWYgKGkgPCBubGV2ZWxzKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgIyMgU2ltdWxhdGlvbiBvZiBtaXhpbmcgcGFyYW1ldGVycyBpcyBpZGVudGljYWwgdG8gdGhlXG4gICAgICAgICAgICAgICAgICAgICMjIHNpbXVsYXRpb24gb2YgZnJlcXVlbmNpZXMuXG4gICAgICAgICAgICAgICAgICAgIENhbGwkbiA8LSBzdW0obi5jdXJyZW50KVxuICAgICAgICAgICAgICAgICAgICBhc3NpZ24obGV2ZWwubmFtZXNbW2ldXSwgZXZhbChDYWxsKSlcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zW2ldIDwtIGxldmVsLm5hbWVzW1tpXV1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgIyMgRm9yIHRoZSBzaW11bGF0aW9uIG9mIGNsYWltIGFtb3VudHMsIHRoZSBudW1iZXJcbiAgICAgICAgICAgICAgICAgICAgIyMgb2YgdmFyaWF0ZXMgaXMgcmF0aGVyIGdpdmVuIGJ5IHRoZVxuICAgICAgICAgICAgICAgICAgICAjIyAnZnJlcXVlbmNpZXMnIG9iamVjdC4gRnVydGhlcm1vcmUsIHRoZSBtaXhpbmdcbiAgICAgICAgICAgICAgICAgICAgIyMgcGFyYW1ldGVycyBtdXN0IGJlIHJlY3ljbGVkIG9uY2UgbW9yZSB0byBtYXRjaFxuICAgICAgICAgICAgICAgICAgICAjIyB0aGUgdmVjdG9yIG9mIGZyZXF1ZW5jaWVzLlxuICAgICAgICAgICAgICAgICAgICBmb3IgKHAgaW4gaW50ZXJzZWN0KGFsbC52YXJzKENhbGwpLCBwYXJhbXMpKVxuICAgICAgICAgICAgICAgICAgICAgICAgZXZhbChzdWJzdGl0dXRlKHggPC0gcmVwLmludCh4LCBmcmVxdWVuY2llcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCh4ID0gYXMubmFtZShwKSkpKVxuICAgICAgICAgICAgICAgICAgICBDYWxsJG4gPC0gc3VtKGZyZXF1ZW5jaWVzKVxuICAgICAgICAgICAgICAgICAgICBzZXZlcml0aWVzIDwtZXZhbChDYWxsKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlXG4gICAgICAgIHNldmVyaXRpZXMgPC0gcmVwLmludCgxLCBzdW0oZnJlcXVlbmNpZXMpKVxuXG4gICAgIyMgV2UgbXVzdCBub3cgZGlzdHJpYnV0ZSB0aGUgY2xhaW0gYW1vdW50cyBpbiB2ZWN0b3IgJ3NldmVyaXRpZXMnXG4gICAgIyMgdG8gdGhlIGFwcHJvcHJpYXRlIG5vZGVzLiBUaGlzIGlzIGNvbXBsaWNhdGVkIGJ5IHRoZVxuICAgICMjIHBvc3NpYmlsaXR5IHRvIGhhdmUgZGlmZmVyZW50IG51bWJlciBvZiBub2RlcyAoeWVhcnMgb2ZcbiAgICAjIyBvYnNlcnZhdGlvbikgZm9yIGVhY2ggZW50aXR5LiBUaGUgcmVzdWx0IG11c3QgYmUgYSBtYXRyaXhcbiAgICAjIyB3aXRoIHRoZSBudW1iZXIgb2YgY29sdW1ucyBlcXVhbCB0byB0aGUgbWF4aW11bSBudW1iZXIgb2YgbGFzdFxuICAgICMjIGxldmVsIG5vZGVzLlxuICAgICMjXG4gICAgIyMgVGhlIG51bWJlciBvZiBub2RlcyAoeWVhcnMgb2Ygb2JzZXJ2YXRpb24pIHBlciBlbnRpdHkgaXNcbiAgICAjIyBnaXZlbiBieSAnbi5jdXJyZW50JyBzaW5jZSB3ZSByZWFjaGVkIHRoZSBsYXN0IGxldmVsIGluIChlaXRoZXJcbiAgICAjIyBvbmUgb2YpIHRoZSBhYm92ZSBsb29wcy5cbiAgICAjI1xuICAgICMjIEFzc2lnbiBhIHVuaXF1ZSBJRCB0byBlYWNoIG5vZGUsIGxlYXZpbmcgZ2FwcyBmb3Igbm9kZXMgd2l0aG91dFxuICAgICMjIG9ic2VydmF0aW9ucy5cbiAgICBpbmQgPC0gdW5saXN0KG1hcHBseShzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSA9IHNlcShieSA9IG1heChuLmN1cnJlbnQpLCBhbG9uZyA9IG4uY3VycmVudCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gbi5jdXJyZW50KSlcblxuICAgICMjIFJlcGVhdGluZyB0aGUgdmVjdG9yIG9mIElEcyBhY2NvcmRpbmcgdG8gdGhlIGZyZXF1ZW5jaWVzXG4gICAgIyMgZWZmZWN0aXZlbHkgYXNzaWducyBhIG5vZGUgSUQgdG8gZWFjaCBjbGFpbSBhbW91bnQuIFRoZSB2ZWN0b3JcbiAgICAjIyBvZiBjbGFpbSBhbW91bnRzIGlzIHRoZW4gc3BsaXQgYnkgbm9kZSwgeWllbGRpbmcgYSBsaXN0IHdoZXJlXG4gICAgIyMgZWFjaCBlbGVtZW50IGNvcnJlc3BvbmRzIHRvIGEgbm9kZSB3aXRoIGNsYWltcy5cbiAgICBmIDwtIHJlcC5pbnQoaW5kLCBmcmVxdWVuY2llcylcbiAgICBzZXZlcml0aWVzIDwtIHNwbGl0KHNldmVyaXRpZXMsIGYpXG5cbiAgICAjIyBJZGVudGlmeSBub2RlcyB3aXRoIGZyZXF1ZW5jeSBlcXVhbCB0byAwLCB3aGljaCBpcyBkaWZmZXJlbnRcbiAgICAjIyBmcm9tIGhhdmluZyBubyBvYnNlcnZhdGlvbiAoTkEpLlxuICAgIGZyZXEwIDwtIGluZFt3aGljaChmcmVxdWVuY2llcyA9PSAwKV1cblxuICAgICMjIFJlYXJyYW5nZSB0aGUgbGlzdCBvZiBjbGFpbSBhbW91bnRzIGluIGEgbWF0cml4O1xuICAgICMjXG4gICAgIyMgICAgICBudW1iZXIgb2Ygcm93czogbnVtYmVyIG9mIG5vZGVzIGF0IHRoZSBwZW51bHRpbWF0ZSBsZXZlbFxuICAgICMjICAgICAgICAgICAgICAgICAgICAgIChudW1iZXIgb2YgZW50aXRpZXMpXG4gICAgIyMgICBudW1iZXIgb2YgY29sdW1uczogbWF4aW11bSBudW1iZXIgb2Ygbm9kZXMgYXQgdGhlIGxhc3QgbGV2ZWxcbiAgICAjIyAgICAgICAgICAgICAgICAgICAgICAobnVtYmVyIG9mIHllYXJzIG9mIG9ic2VydmF0aW9uKS5cbiAgICAjI1xuICAgICMjIE1vcmVvdmVyLCBhc3NpZ24gYSB2YWx1ZSBvZiAnbnVtZXJpYygwKScgdG8gbm9kZXMgd2l0aCBhXG4gICAgIyMgZnJlcXVlbmN5IG9mIDAuXG4gICAgbnJvdyA8LSBsZW5ndGgobi5jdXJyZW50KSAgICAgICAgICAgIyBudW1iZXIgb2YgZW50aXRpZXNcbiAgICBuY29sIDwtIG1heChuLmN1cnJlbnQpICAgICAgICAgICAgICAjIG51bWJlciBvZiB5ZWFyc1xuICAgIHJlcyA8LSBhcy5saXN0KHJlcC5pbnQoTkEsIG5yb3cgKiBuY29sKSlcbiAgICByZXNbdW5pcXVlKGYpXSA8LSBzZXZlcml0aWVzXG4gICAgcmVzW2ZyZXEwXSA8LSBsYXBwbHkocmVwLmludCgwLCBsZW5ndGgoZnJlcTApKSwgbnVtZXJpYylcbiAgICByZXMgPC0gbWF0cml4KHJlcywgbnJvdywgbmNvbCwgYnlyb3cgPSBUUlVFLFxuICAgICAgICAgICAgICAgICAgZGltbmFtZXMgPSBsaXN0KE5VTEwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzdGUobGV2ZWwubmFtZXNbbmxldmVsc10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxX2xlbihuY29sKSwgc2VwID0gXCIuXCIpKSlcblxuICAgICMjIFJlc2hhcGUgd2VpZ2h0cyBhcyBhIG1hdHJpeCwgaWYgbmVjZXNzYXJ5LlxuICAgIHdlaWdodHMgPC0gaWYgKGlzLm51bGwod2VpZ2h0cykpXG4gICAgICAgIE5VTExcbiAgICBlbHNlXG4gICAge1xuICAgICAgICAjIyBJbnRlZ3JhdGUgTkFzIGludG8gdGhlIHdlaWdodHMgbWF0cml4IGFzIGFwcHJvcHJpYXRlLlxuICAgICAgICB3IDwtIHJlcC5pbnQoTkEsIG5yb3cgKiBuY29sKVxuICAgICAgICB3W2luZF0gPC0gd2VpZ2h0c1xuICAgICAgICBtYXRyaXgodywgbnJvdyA9IG5yb3csIGJ5cm93ID0gVFJVRSwgZGltbmFtZXMgPSBkaW1uYW1lcyhyZXMpKVxuICAgIH1cblxuICAgICMjIEZpbmFsbHksIGNyZWF0ZSBhIG1hdHJpeCB3aGVyZSBlYWNoIHJvdyBjb250YWlucyB0aGUgc2VyaWVzIG9mXG4gICAgIyMgaWRlbnRpZmllcnMgZm9yIGFuIGVudGl0eSBpbiB0aGUgcG9ydGZvbGlvLCBlLmcuIGlmIHRoZSBkYXRhXG4gICAgIyMgaXMgZGVub3RlZCBYX3tpamt0fSwgb25lIGxpbmUgb2YgdGhlIG1hdHJpeCB3aWxsIGNvbnRhaW5cbiAgICAjIyBzdWJzY3JpcHRzIGksIGogYW5kIGsuIEFzIHdlIG1vdmUgZnJvbSByaWdodCB0byBsZWZ0IGluIHRoZVxuICAgICMjIGNvbHVtbnMgb2YgJ20nLCB0aGUgc3ViY3JpcHRzIGFyZSBpbmNyZWFzaW5nbHkgcmVwZWF0ZWQuXG4gICAgbmNvbCA8LSBubGV2ZWxzIC0gMUxcbiAgICBtIDwtIG1hdHJpeCgxLCBucm93LCBuY29sLFxuICAgICAgICAgICAgICAgIGRpbW5hbWVzID0gbGlzdChOVUxMLCBoZWFkKGxldmVsLm5hbWVzLCBuY29sKSkpXG4gICAgZm9yIChpIGluIHNlcV9sZW4obmNvbCAtIDFMKSkgICAgIyBhbGwgYnV0IHRoZSBsYXN0IGNvbHVtblxuICAgIHtcbiAgICAgICAgIyMgVmVjdG9yICd4JyB3aWxsIG9yaWdpbmFsbHkgY29udGFpbiBhbGwgc3Vic2NyaXB0cyBmb3Igb25lXG4gICAgICAgICMjIGxldmVsLiBUaGVzZSBzdWJzY3JpcHRzIGFyZSB0aGVuIHJlcGVhdGVkIGFzIG5lZWRlZCB0byBnaXZlXG4gICAgICAgICMjIHRoZSBkZXNpcmVkIHJlc3VsdC4gVG8gYXZvaWQgYW5vdGhlciBleHBsaWNpdCBsb29wLCBJIHVzZSBhXG4gICAgICAgICMjICdsYXBwbHknIHdpdGggYSBkaXJlY3QgYXNzaWdubWVudCBpbiB0aGUgY3VycmVudFxuICAgICAgICAjIyBmcmFtZS4gU29tZXdoYXQgdW51c3VhbCwgYnV0IHRoaXMgaXMgdGhlIHNpbXBsZXN0IHByb2NlZHVyZVxuICAgICAgICAjIyBJIG1hbmFnZWQgdG8gY29tZSB1cCB3aXRoLlxuICAgICAgICB4IDwtIHVubGlzdChsYXBwbHkobm9kZXNbW2ldXSwgc2VxKSlcbiAgICAgICAgbGFwcGx5KG5vZGVzWyhpICsgMUwpOihubGV2ZWxzIC0gMUwpXSxcbiAgICAgICAgICAgICAgIGZ1bmN0aW9uKHYpIGFzc2lnbihcInhcIiwgcmVwLmludCh4LCB2KSwgZW52aXIgPSBwYXJlbnQuZnJhbWUoMikpKVxuICAgICAgICBtWywgaV0gPC0geFxuICAgIH1cbiAgICBtWywgbmNvbF0gPC0gdW5saXN0KGxhcHBseShub2Rlc1tbbmNvbF1dLCBzZXEpKSAjIGxhc3QgY29sdW1uXG5cbiAgICAjIyBSZXR1cm4gb2JqZWN0IG9mIGNsYXNzICdwb3J0Zm9saW8nXG4gICAgc3RydWN0dXJlKGxpc3QoZGF0YSA9IHJlcyxcbiAgICAgICAgICAgICAgICAgICB3ZWlnaHRzID0gd2VpZ2h0cyxcbiAgICAgICAgICAgICAgICAgICBjbGFzc2lmaWNhdGlvbiA9IG0sXG4gICAgICAgICAgICAgICAgICAgbm9kZXMgPSBub2RlcyxcbiAgICAgICAgICAgICAgICAgICBtb2RlbC5mcmVxID0gbW9kZWwuZnJlcSxcbiAgICAgICAgICAgICAgICAgICBtb2RlbC5zZXYgPSBtb2RlbC5zZXYpLFxuICAgICAgICAgICAgICBjbGFzcyA9IFwicG9ydGZvbGlvXCIpXG59XG5cbmRsb21heCA8LSBmdW5jdGlvbih4LCBzaGFwZT0xLCBzY2FsZT0xLCBsb2c9RkFMU0UpIHtcbiAgaWYgKGxvZz09RkFMU0UpIHJlc3VsdCA8LSBzaGFwZSpzY2FsZV5zaGFwZSAvIChzY2FsZSArIHgpXihzaGFwZSsxKVxuICBpZiAobG9nPT1UUlVFICkgcmVzdWx0IDwtIGxvZyhzaGFwZSkrc2hhcGUqbG9nKHNjYWxlKS0oc2hhcGUrMSkqbG9nKHNjYWxlICsgeClcbiAgcmV0dXJuKHJlc3VsdCkgfVxuXG5ybG9tYXggPC0gZnVuY3Rpb24obiwgc2hhcGU9MSwgc2NhbGU9MSkge1xuICB1IDwtIHJ1bmlmKG4pXG4gIHJlc3VsdCA8LSBzY2FsZSooKDEgLSB1KV4oLTEvc2hhcGUpLTEpXG4gIHJldHVybihyZXN1bHQpIH1cblxuSW5zYW1wbGVUb3duIDwtIHN1YnNldChJbnNhbXBsZSwgVHlwZVRvd249PTEpXG5cbiMgVGhlIG5lZ2F0aXZlIGJpbm9taWFsIGZyZXF1ZW5jeSBtb2RlbDogTlxuTiA8LSBJbnNhbXBsZVRvd24kRnJlcVxuZnJlcV9saWsgPC0gZnVuY3Rpb24ocGFybSkge1xuICByICAgIDwtIHBhcm1bMV1cbiAgYmV0YSA8LSBwYXJtWzJdXG4gIGxpayAgPC0gLXN1bShkbmJpbm9tKE4sIHNpemU9ciwgcHJvYj0xLygxK2JldGEpLCBsb2c9VFJVRSkpXG4gIHJldHVybihsaWspXG59XG5pbml0LnBhcm0uZnJlcSA8LSBjKG1lYW4oTikvKHZhcihOKS9tZWFuKE4pLTEpLCB2YXIoTikvbWVhbihOKS0xKSAjIGluaXRpYWwgZXN0aW1hdGVzIGJ5IG1ldGhvZCBvZiBtb21lbnRzXG5mcmVxX21vZCAgICAgICA8LSBvcHRpbShwYXI9aW5pdC5wYXJtLmZyZXEsIGZuPWZyZXFfbGlrKSAjIE1heGltdW0gbGlrZWxpaG9vZCBlc3RpbWF0aW9uIGZvciB0aGUgZnJlcXVlbmN5IG1vZGVsXG5cbnIuZXN0ICAgIDwtIGZyZXFfbW9kJHBhclsxXVxuYmV0YS5lc3QgPC0gZnJlcV9tb2QkcGFyWzJdXG5cblxuIyBUaGUgUGFyZXRvIHNldmVyaXR5IG1vZGVsOiBYYmFyXG5YYmFyIDwtIEluc2FtcGxlVG93biR5QXZnW3doaWNoKEluc2FtcGxlVG93biRGcmVxPjApXVxuc2V2X2xpayA8LSBmdW5jdGlvbihwYXJtKSB7XG4gIGFscGhhIDwtICBwYXJtWzFdXG4gIHRoZXRhIDwtICBwYXJtWzJdXG4gIGxpayAgIDwtIC1zdW0oZGxvbWF4KFhiYXIsIHNoYXBlPWFscGhhLCBzY2FsZT10aGV0YSwgbG9nPVRSVUUpKVxuICByZXR1cm4obGlrKVxufVxuaW5pdC5wYXJtLnNldiA8LSBjKCAyLygxLW1lYW4oWGJhcileMi92YXIoWGJhcikpICAsIG1lYW4oWGJhcikqKDIvKDEtbWVhbihYYmFyKV4yL3ZhcihYYmFyKSktMSkgKSAjIGluaXRpYWwgZXN0aW1hdGVzIGJ5IG1ldGhvZCBvZiBtb21lbnRzXG5zZXZfbW9kICAgICAgIDwtIG9wdGltKHBhcj1pbml0LnBhcm0uc2V2LCBmbj1zZXZfbGlrLCBtZXRob2Q9XCJMLUJGR1MtQlwiKSAjIE1heGltdW0gbGlrZWxpaG9vZCBlc3RpbWF0aW9uIGZvciB0aGUgc2V2ZXJpdHkgbW9kZWxcbmFscGhhLmVzdCAgICAgPC0gc2V2X21vZCRwYXJbMV1cbnRoZXRhLmVzdCAgICAgPC0gc2V2X21vZCRwYXJbMl0iLCJzYW1wbGUiOiIjIFBhcmFtZXRlciBlc3RpbWF0ZXMgZnJvbSB0aGUgZnJlcXVlbmN5IG1vZGVsOiBhbHBoYS5lc3QsIHRoZXRhLmVzdFxuIyBQYXJhbWV0ZXIgZXN0aW1hdGVzIGZyb20gdGhlIHNldmVyaXR5ICBtb2RlbDogICAgIHIuZXN0LCAgYmV0YS5lc3RcblxuZnJlcSA8LSBleHByZXNzaW9uKGRhdGEgPSAgX19fX19fKHNpemU9X19fXywgcHJvYj0xLygxK19fX19fKSkpICAjIHJhbmRvbSBzYW1wbGVzIGZyb20gdGhlIGZpdHRlZCBmcmVxdWVuY3kgbW9kZWxcbnNldiAgPC0gZXhwcmVzc2lvbihkYXRhID0gIF9fX19fXyhzaGFwZT1fX19fX19fXywgc2NhbGU9X19fX19fXykpICMgcmFuZG9tIHNhbXBsZXMgZnJvbSB0aGUgZml0dGVkIHNldmVyaXR5IG1vZGVsXG5GcyAgIDwtIGFnZ3JlZ2F0ZURpc3QoXCJzaW11bGF0aW9uXCIsIG5iLnNpbXVsID0gMTAwMCxcbiAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5mcmVxID0gX19fXywgbW9kZWwuc2V2ID0gX19fXylcbnBsb3QoRnMpXG5saW5lcyhlY2RmKEluc2FtcGxlVG93biR5KSwgIGNvbD1cImJsdWVcIilcblxubGVnZW5kKFwiYm90dG9tcmlnaHRcIiwgbGVnZW5kID0gYyhcIlNpbXVsYXRpb25cIiwgXCJFbXBpcmljYWxcIiksIGNvbD1jKFwiYmxhY2tcIixcImJsdWVcIiksIGx0eT1jKDEsMiksIHBjaD1jKDEsIDE5KSkiLCJzb2x1dGlvbiI6IiMgUGFyYW1ldGVyIGVzdGltYXRlcyBmcm9tIHRoZSBmcmVxdWVuY3kgbW9kZWw6IGFscGhhLmVzdCwgdGhldGEuZXN0XG4jIFBhcmFtZXRlciBlc3RpbWF0ZXMgZnJvbSB0aGUgc2V2ZXJpdHkgIG1vZGVsOiAgICAgci5lc3QsICBiZXRhLmVzdFxuXG5mcmVxIDwtIGV4cHJlc3Npb24oZGF0YSA9ICBybmJpbm9tKHNpemU9ci5lc3QsIHByb2I9MS8oMStiZXRhLmVzdCkpKSAjIHJhbmRvbSBzYW1wbGVzIGZyb20gdGhlIGZpdHRlZCBmcmVxdWVuY3kgbW9kZWxcbnNldiAgPC0gZXhwcmVzc2lvbihkYXRhID0gIHJsb21heChzaGFwZT1hbHBoYS5lc3QsIHNjYWxlPXRoZXRhLmVzdCkpICMgcmFuZG9tIHNhbXBsZXMgZnJvbSB0aGUgZml0dGVkIHNldmVyaXR5IG1vZGVsXG5GcyAgIDwtIGFnZ3JlZ2F0ZURpc3QoXCJzaW11bGF0aW9uXCIsIG5iLnNpbXVsID0gMTAwMCxcbiAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5mcmVxID0gZnJlcSwgbW9kZWwuc2V2ID0gc2V2KVxucGxvdChGcylcbmxpbmVzKGVjZGYoSW5zYW1wbGVUb3duJHkpLCAgY29sPVwiYmx1ZVwiKVxuXG5sZWdlbmQoXCJib3R0b21yaWdodFwiLCBsZWdlbmQgPSBjKFwiU2ltdWxhdGlvblwiLCBcIkVtcGlyaWNhbFwiKSwgY29sPWMoXCJibGFja1wiLFwiYmx1ZVwiKSwgbHR5PWMoMSwyKSwgcGNoPWMoMSwgMTkpKSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiR29vZCBqb2IhIFRoaXMgaXMgdGhlIHNlY29uZCB0aW1lIHRoYXQgd2UgdXNlZCB0aGUgc2ltdWxhdGlvbiB0ZWNobmlxdWUuIE5vdGUgdGhhdCBpdCBpcyB1c3VhbCB0byBvYnNlcnZlIHRoYXQgYW4gYWN0dWFsIGNsYWltcyBkYXRhc2V0IG1heSBjb21lIHdpdGggdmVyeSBmZXcgcG9zaXRpdmUgY2xhaW1zIGJ1dCBhbHNvIGhlYXZ5IHRhaWwgYmVoYXZpb3IuXCIpIiwiaGludCI6IldlIHNob3VsZCB1c2UgdGhlIGVzdGltYXRlZCBwYXJhbWV0ZXJzIGZyb20gdGhlIGZyZXF1ZW5jeSBhbmQgc2V2ZXJpdHkgZGlzdHJpYnV0aW9ucyBpbiBjYWxjdWxhdGlvbiBvZiB0aGUgYWdncmVnYXRlIGNsYWltIGFtb3VudCBkaXN0cmlidXRpb24uIn0= 5.5 Tweedie Distribution In this section, we learn how to: Construct the Tweedie distribution from a collective risk model Establish the Tweedie distribution as a member of the exponential family of distributions Fit Tweedie distribution as a generalized linear model Video: Tweedie Distribution Overheads: Tweedie Distribution (Click Tab to View) A. Tweedie Distribution B. Tweedie Distribution with Exposure C. Distribution Function for Tweedie Distribution D. Example E. Example - R Code Hide Hide Hide Hide Hide 5.5.1 Exercise. Tweedie Distribution Assignment Text In this assignment, we will fit a Tweedie model for a collective risk model using observed compound losses in LGPIF data with R. Unlike the previous tutorials that required seperate model fitting for the frequency and severity components, use of Tweedie distribution enables us to fit a collective risk model in one step. Instructions For the likelihood of the compound loss, We use dtweedie(), which is one of the built-in functions of R library tweedie . From the fitted Tweedie model via optim(), extract the estimated mu, phi, and p. After estimating the parameters of the Tweedie model, plot the empiricial quantiles against the quantiles from the fitted model. Note that we generate the theoretical quantiles via qtweedie() and the estimated Tweedie parameters. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6Ikluc2FtcGxlIDwtIHJlYWQuY3N2KFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9EYXRhL0luc2FtcGxlLmNzdlwiLCBoZWFkZXI9VCwgbmEuc3RyaW5ncz1jKFwiLlwiKSwgc3RyaW5nc0FzRmFjdG9ycz1GQUxTRSlcbmxpYnJhcnkobG1lNClcblxuc291cmNlKFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5BY3RUZXh0RGV2L0xEQUNvdXJzZTEvbWFpbi9SQ29kZS9Ud2VlZGllU291cmNlQ29kZS5SbWRcIikiLCJzYW1wbGUiOiJJbnNhbXBsZVRvd24gPC0gc3Vic2V0KEluc2FtcGxlLCBUeXBlVG93bj09MSlcblxuIyBUaGUgVHdlZWRpZSBjb21wb3VuZCBsb3NzIG1vZGVsOiBTXG5TIDwtIF9fX19fJHlcbmNvbXBsb3NzX2xpayA8LSBmdW5jdGlvbihwYXJtKSB7XG4gIG11ICAgIDwtIHBhcm1bMV1cbiAgcGhpICAgPC0gcGFybVsyXVxuICBwICAgICA8LSBwYXJtWzNdXG4gIGxpayAgPC0gLXN1bSggIGxvZyhkdHdlZWRpZShTLCBtdT1tdSwgcGhpPXBoaSwgcG93ZXI9XykpIClcbiAgcmV0dXJuKGxpaylcbn1cbmluaXQucGFybS5jb21wbG9zcyA8LSBjKCBtZWFuKFMpLCAzMDAsIDEuNSkgICAgIyBpbml0aWFsIGVzdGltYXRlcyBcbmNvbXBsb3NzX21vZCAgICAgICA8LSBvcHRpbShwYXI9X19fX19fLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZuPV9fX19fXywgbWV0aG9kPVwiTC1CRkdTLUJcIikgIyBNYXhpbXVtIGxpa2VsaWhvb2QgZXN0aW1hdGlvbiBmb3IgdGhlIGNvbXBvdW5kIGxvc3MgbW9kZWxcblxuXG5tdS5lc3QgIDwtIGNvbXBsb3NzX21vZCRwYXJbMV1cbnBoaS5lc3QgPC0gY29tcGxvc3NfbW9kJF9fX1xucC5lc3QgICA8LSBjb21wbG9zc19tb2QkX19fXG5cbnBjdCA8LSBzZXEoMC4wMSwwLjk5LDAuMDEpXG5wbG90KHF0d2VlZGllKHBjdCwgbXU9X19fXywgcGhpPV9fX18sIHBvd2VyPXAuZXN0KSAscXVhbnRpbGUoSW5zYW1wbGVUb3duJHksIHByb2JzPXBjdCksIHhsYWI9XCJUaGVvcmV0aWNhbCBRdWFudGlsZVwiLCB5bGFiPVwiRW1waXJpY2FsIFF1YW50aWxlXCIsIHhsaW09YygwLDUwMDAwKSwgeWxpbT1jKDAsNTAwMDApKVxuYWJsaW5lKDAsMSkiLCJzb2x1dGlvbiI6Ikluc2FtcGxlVG93biA8LSBzdWJzZXQoSW5zYW1wbGUsIFR5cGVUb3duPT0xKVxuXG4jIFRoZSBUd2VlZGllIGNvbXBvdW5kIGxvc3MgbW9kZWw6IFNcblMgPC0gSW5zYW1wbGVUb3duJHlcbmNvbXBsb3NzX2xpayA8LSBmdW5jdGlvbihwYXJtKSB7XG4gIG11ICAgIDwtIHBhcm1bMV1cbiAgcGhpICAgPC0gcGFybVsyXVxuICBwICAgICA8LSBwYXJtWzNdXG4gIGxpayAgPC0gLXN1bSggIGxvZyhkdHdlZWRpZShTLCBtdT1tdSwgcGhpPXBoaSwgcG93ZXI9cCkpIClcbiAgcmV0dXJuKGxpaylcbn1cbmluaXQucGFybS5jb21wbG9zcyA8LSBjKCBtZWFuKFMpLCAzMDAsIDEuNSkgICAgIyBpbml0aWFsIGVzdGltYXRlcyBcbmNvbXBsb3NzX21vZCAgICAgICA8LSBvcHRpbShwYXI9aW5pdC5wYXJtLmNvbXBsb3NzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZuPWNvbXBsb3NzX2xpaywgbWV0aG9kPVwiQ0dcIikgIyBNYXhpbXVtIGxpa2VsaWhvb2QgZXN0aW1hdGlvbiBmb3IgdGhlIGNvbXBvdW5kIGxvc3MgbW9kZWxcblxuXG5tdS5lc3QgIDwtIGNvbXBsb3NzX21vZCRwYXJbMV1cbnBoaS5lc3QgPC0gY29tcGxvc3NfbW9kJHBhclsyXVxucC5lc3QgICA8LSBjb21wbG9zc19tb2QkcGFyWzNdXG5cbnBjdCA8LSBzZXEoMC4wMSwwLjk5LDAuMDEpXG5wbG90KHF0d2VlZGllKHBjdCwgbXU9bXUuZXN0LCBwaGk9cGhpLmVzdCwgcG93ZXI9cC5lc3QpICxxdWFudGlsZShJbnNhbXBsZVRvd24keSwgcHJvYnM9cGN0KSwgeGxhYj1cIlRoZW9yZXRpY2FsIFF1YW50aWxlXCIsIHlsYWI9XCJFbXBpcmljYWwgUXVhbnRpbGVcIiwgeGxpbT1jKDAsNTAwMDApLCB5bGltPWMoMCw1MDAwMCkpXG5hYmxpbmUoMCwxKSIsInNjdCI6InN1Y2Nlc3NfbXNnKFwiV2hpbGUgVHdlZWRpZSBkaXN0cmlidXRpb24gZW5hYmxlcyB1cyB0byBmaXQgYSBjb21wb3VuZCBsb3NzIGRpc3RyaWJ1dGlvbiBpbiBvbmUgc3RlcCwgYWN0dWFsIGNsYWltcyBkYXRhc2V0IG1pZ2h0IG5vdCBmaXQgaW50byB0aGUgZGlzdHJpYnV0aW9uIGVzcGVjaWFsbHkgd2hlbiB3ZSBvYnNlcnZlIGhlYXZ5LXRhaWwgYmVoYXZpb3IuXCIpIiwiaGludCI6IkZvciBUd2VlZGllIGRpc3RyaWJ1dGlvbiwgd2UgZXN0aW1hdGUgdGhyZWUgcGFyYW1ldGVycyAobXUsIHBoaSwgcCkgdGhhdCBleHBsYWluIHRoZSBvdmVyYWwgbWVhbiwgZGlzcGVyc2lvbiwgYW5kIHNoYXBlIG9mIHRoZSBkaXN0cmlidXRpb24uIn0= 5.6 Effects of Coverage Modifications In this section, we learn how to: Examine the impact of aggregate deductible on the aggregate loss Examine the effect of per-occurrence deductible on frequency and severity components in the aggregate loss Video: Effects of Coverage Modifications Overheads: Effects of Coverage Modifications (Click Tab to View) A. Aggregate Deductible B. Per-occurrence Deductible C. Per-occurrence Deductible and Frequency D. Example E. Per-occurrence Deductible Hide Hide Hide Hide Hide "]]
